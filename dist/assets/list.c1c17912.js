import{e as A}from"./remesh-logger.c94c594f.js";import{o as F}from"./vendor.526a8a9f.js";const U=(m,e)=>{const d=m.state({name:`${e.name}.KeyListState`,default:[]}),c=m.state({name:`${e.name}.ItemState`});m.command$({name:`${e.name}.addItemCommand$`,inspectable:!1,impl:()=>{var n;return F(((n=e.default)!=null?n:[]).map(t=>f(A(t))))}});const u=m.query({name:`${e.name}.ItemListQuery`,impl:({get:n})=>n(d()).map(t=>n(c(t)))}),y=m.event({name:`${e.name}.ListChangedEvent`}),I=m.event({name:`${e.name}.ItemAddedEvent`}),i=m.event({name:`${e.name}.FailedToAddItemEvent`}),L=m.event({name:`${e.name}.ItemUpdatedEvent`}),$=m.event({name:`${e.name}.FailedToUpdateItemEvent`}),E=m.event({name:`${e.name}.ItemDeletedEvent`}),v=m.command({name:`${e.name}.setList`,impl:({get:n},t)=>{const a=t.map(e.key),s=n(u());return[t.map((r,l)=>c(a[l]).new(r)),d().new(a),y({previous:s,current:t})]}}),f=m.command({name:`${e.name}.addItem`,impl:({get:n},t)=>{const a=n(d()),s=n(u()),r=e.key(t);return a.includes(r)?i({reason:"item already exists"}):[v(s.concat(t)),I({item:t})]}}),o=m.command({name:`${e.name}.deleteItem`,impl:({get:n},t)=>{const s=n(u()).filter(l=>e.key(l)!==t),r=n(c(t));return[v(s),E({item:r})]}}),Q=m.command({name:`${e.name}.updateItem`,impl:({get:n},t)=>{const a=e.key(t);if(!n(d()).includes(a))return $({item:t,reason:"item does not exist"});const l=n(u()).map(k=>e.key(k)===a?t:k),p=n(c(a));return[v(l),L({previous:p,current:t})]}});return{command:{setList:v,addItem:f,deleteItem:o,updateItem:Q},query:{KeyListQuery:d.Query,ItemQuery:c.Query,ItemListQuery:u},event:{ListChangedEvent:y,ItemAddedEvent:I,FailedToAddItemEvent:i,ItemUpdatedEvent:L,FailedToUpdateItemEvent:$,ItemDeletedEvent:E}}};export{U as L};
//# sourceMappingURL=list.c1c17912.js.map
