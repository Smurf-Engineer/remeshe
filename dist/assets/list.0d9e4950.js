import{e as A}from"./remesh-logger.d0a302f9.js";import{o as F}from"./vendor.c1cd45af.js";const U=(m,e)=>{const r=m.state({name:`${e.name}.KeyListState`,default:[]}),c=m.state({name:`${e.name}.ItemState`});m.command$({name:`${e.name}.addItemCommand$`,inspectable:!1,impl:()=>{var n;return F(((n=e.default)!=null?n:[]).map(t=>f(A(t))))}});const l=m.query({name:`${e.name}.itemList`,impl:({get:n})=>n(r()).map(t=>n(c(t)))}),i=m.event({name:`${e.name}.ListChangedEvent`}),y=m.event({name:`${e.name}.ItemAddedEvent`}),I=m.event({name:`${e.name}.FailedToAddItemEvent`}),L=m.event({name:`${e.name}.ItemUpdatedEvent`}),$=m.event({name:`${e.name}.FailedToUpdateItemEvent`}),E=m.event({name:`${e.name}.ItemDeletedEvent`}),v=m.command({name:`${e.name}.setList`,impl:({get:n},t)=>{const a=t.map(e.key),s=n(l());return[t.map((d,u)=>c(a[u]).new(d)),r().new(a),i({previous:s,current:t})]}}),f=m.command({name:`${e.name}.addItem`,impl:({get:n},t)=>{const a=n(r()),s=n(l()),d=e.key(t);return a.includes(d)?I({reason:"item already exists"}):[v(s.concat(t)),y({item:t})]}}),o=m.command({name:`${e.name}.deleteItem`,impl:({get:n},t)=>{const s=n(l()).filter(u=>e.key(u)!==t),d=n(c(t));return[v(s),E({item:d})]}}),p=m.command({name:`${e.name}.updateItem`,impl:({get:n},t)=>{const a=e.key(t);if(!n(r()).includes(a))return $({item:t,reason:"item does not exist"});const u=n(l()).map(k=>e.key(k)===a?t:k),q=n(c(a));return[v(u),L({previous:q,current:t})]}});return{command:{setList:v,addItem:f,deleteItem:o,updateItem:p},query:{keyList:r.query,item:c.query,itemList:l},event:{ListChangedEvent:i,ItemAddedEvent:y,FailedToAddItemEvent:I,ItemUpdatedEvent:L,FailedToUpdateItemEvent:$,ItemDeletedEvent:E}}};export{U as L};
//# sourceMappingURL=list.0d9e4950.js.map
