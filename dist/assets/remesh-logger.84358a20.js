var lt=Object.defineProperty,ft=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var Ae=(t,o,r)=>o in t?lt(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,D=(t,o)=>{for(var r in o||(o={}))je.call(o,r)&&Ae(t,r,o[r]);if(J)for(var r of J(o))Ue.call(o,r)&&Ae(t,r,o[r]);return t},C=(t,o)=>ft(t,gt(o));var Ve=(t,o)=>{var r={};for(var s in t)je.call(t,s)&&o.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&J)for(var s of J(t))o.indexOf(s)<0&&Ue.call(t,s)&&(r[s]=t[s]);return r};import{s as ze,f as St,g as yt,h as vt,i as We,j as Ke,O as te,k as bt,e as wt,S as ht,l as K,r as Q,R as Rt,n as Et}from"./vendor.20a99481.js";const Ht=t=>t;let Dt=0;function $t(t){var s;const o=Dt++,r=d=>({type:"RemeshEventPayload",arg:d,Event:r});return r.type="RemeshEvent",r.eventId=o,r.eventName=t.name,r.owner=z(),r.inspectable="inspectable"in t&&(s=t.inspectable)!=null?s:!0,"impl"in t&&(r.impl=t.impl),r}const Ct=t=>X({name:t.name,impl:()=>t.default,inspectable:t.inspectable,compare:t.compare}),Qt=t=>X({name:t.name,defer:!0,impl:o=>{throw new Error(`RemeshDeferState: use ${t.name} before setting state`)},inspectable:t.inspectable,compare:t.compare});let Nt=0;const Fe=(t,o)=>We(t)&&We(o)?Ke(t,o):Array.isArray(t)&&Array.isArray(o)?Ke(t,o):t===o,X=t=>{var d,p,S;const o=Nt++;let r=null;const s=b=>{if(b===void 0&&r)return r;const w={type:"RemeshStateItem",arg:b,State:s,new:g=>({type:"RemeshStateSetterPayload",stateItem:w,newState:g})};return b===void 0&&(r=w),w};return s.type="RemeshState",s.stateId=o,s.stateName=t.name,s.impl=t.impl,s.compare=(d=t.compare)!=null?d:Fe,s.owner=z(),s.inspectable=(p=t.inspectable)!=null?p:!0,s.defer=(S=t.defer)!=null?S:!1,s.Query=ne({name:`${t.name}.Query`,inspectable:!1,impl:({get:b},w)=>b(s(w))}),s};let xt=0;const ne=t=>{var d,p;const o=xt++;let r=null;const s=S=>{if(S===void 0&&r)return r;const b={type:"RemeshQueryPayload",Query:s,arg:S};return S===void 0&&(r=b),b};return s.type="RemeshQuery",s.queryId=o,s.queryName=t.name,s.prepare=t.prepare,s.impl=t.impl,s.compare=(d=t.compare)!=null?d:Fe,s.owner=z(),s.inspectable=(p=t.inspectable)!=null?p:!0,s.scheduler=t.scheduler,s};let Mt=0;const Le=t=>{var s;const o=Mt++,r=d=>({type:"RemeshCommandPayload",arg:d,Command:r});return r.type="RemeshCommand",r.commandId=o,r.commandName=t.name,r.impl=t.impl,r.owner=z(),r.inspectable=(s=t.inspectable)!=null?s:!0,r};let It=0;const re=t=>{var s;const o=It++,r=d=>({type:"RemeshCommand$Payload",arg:d,Command$:r});return r.type="RemeshCommand$",r.command$Id=o,r.command$Name=t.name,r.impl=t.impl,r.owner=z(),r.inspectable=(s=t.inspectable)!=null?s:!0,r},Te=t=>re({name:t.name,inspectable:t.inspectable,impl:(r,s)=>{if(!t.mode||t.mode==="switch")return s.pipe(ze(d=>t.impl(r,d)));if(t.mode==="merge")return s.pipe(St(d=>t.impl(r,d)));if(t.mode==="concat")return s.pipe(yt(d=>t.impl(r,d)));if(t.mode==="exhaust")return s.pipe(vt(d=>t.impl(r,d)));throw new Error(`RemeshCommandAsync: invalid mode: ${t.mode}`)}});let kt=0;const At=t=>{const o=r=>({type:"RemeshExternPayload",Extern:o,value:r});return o.externId=kt++,o.externName=t.name,o.default=t.default,o};let jt=0;const oe=t=>{var s;let o=null;const r=d=>{if(d===void 0&&o)return o;const p={type:"RemeshDomainPayload",Domain:r,arg:d};return d===void 0&&(o=p),p};return r.type="RemeshDomain",r.domainId=jt++,r.domainName=t.name,r.impl=t.impl,r.inspectable=(s=t.inspectable)!=null?s:!0,r},z=oe({name:"DefaultDomain",impl:()=>({})}),N={DomainCreated:"Domain::Created",DomainDestroyed:"Domain::Destroyed",DomainRestored:"Domain::Restored",StateCreated:"State::Created",StateUpdated:"State::Updated",StateDestroyed:"State::Destroyed",StateRestored:"State::Restored",QueryCreated:"Query::Created",QueryUpdated:"Query::Updated",QueryDestroyed:"Query::Destroyed",QueryRestored:"Query::Restored",EventEmitted:"Event::Emitted",CommandReceived:"Command::Received",Command$Received:"Command$::Received"},A=oe({name:"RemeshInspector",impl:t=>{const o=t.event({name:"RemeshDomainStorageEvent"}),r=t.event({name:"RemeshStateStorageEvent"}),s=t.event({name:"RemeshQueryStorageEvent"}),d=t.event({name:"RemeshEventEmitted"}),p=t.event({name:"RemeshCommandReceived"}),S=t.event({name:"RemeshCommand$Received"});return{event:{RemeshDomainStorageEvent:o,RemeshStateStorageEvent:r,RemeshQueryStorageEvent:s,RemeshEventEmittedEvent:d,RemeshCommandReceivedEvent:p,RemeshCommand$ReceivedEvent:S}}}}),V=t=>t.owner?t.owner.Domain.inspectable&&t.inspectable:t.inspectable,Ut=t=>{var o;return((o=t.inspectors)!=null?o:[]).filter(r=>!!r).map(r=>{const p=t,{inspectors:s}=p,d=Ve(p,["inspectors"]);return r(d)})},Vt=t=>{let o=null;const r=()=>(o||(o=Ut(t)),o);return{destroyInspectors:()=>{if(o){for(const a of o)a.destroy();o=null}},inspectDomainStorage:(a,m)=>{if(V(m.Domain))for(const l of r()){const x=l.getDomain(A()).event.RemeshDomainStorageEvent({type:a,storage:m});l.emitEvent(x)}},inspectStateStorage:(a,m)=>{if(V(m.State))for(const l of r()){const x=l.getDomain(A()).event.RemeshStateStorageEvent({type:a,storage:m});l.emitEvent(x)}},inspectQueryStorage:(a,m)=>{if(V(m.Query))for(const l of r()){const x=l.getDomain(A()).event.RemeshQueryStorageEvent({type:a,storage:m});l.emitEvent(x)}},inspectEventEmitted:(a,m)=>{if(V(m.Event))for(const l of r()){const x=l.getDomain(A()).event.RemeshEventEmittedEvent({type:a,payload:m});l.emitEvent(x)}},inspectCommandReceived:(a,m)=>{if(V(m.Command))for(const l of r()){const x=l.getDomain(A()).event.RemeshCommandReceivedEvent({type:a,payload:m});l.emitEvent(x)}},inspectCommand$Received:(a,m)=>{if(V(m.Command$))for(const l of r()){const x=l.getDomain(A()).event.RemeshCommand$ReceivedEvent({type:a,payload:m});l.emitEvent(x)}}}},ee=new WeakMap,Wt=t=>{if(ee.has(t))return ee.get(t);let o=null;const r=new te(s=>{if(o){s.next(o),s.complete();return}s.next({type:"pending"}),t.then(d=>{const p={type:"resolved",value:d};o=p,s.next(p),s.complete()},d=>{const p={type:"rejected",error:d};o=p,s.next(p),s.complete()})});return ee.set(t,r),r},W=new WeakMap,H=function(t){return W.has(t)||(W.set(t,{type:"pending"}),t.then(o=>{W.set(t,{type:"resolved",value:o})},o=>{o instanceof Error?W.set(t,{type:"rejected",error:o}):W.set(t,{type:"rejected",error:new Error(o)})})),W.get(t)},j=Symbol("RemeshValuePlaceholder");let _=0;const Kt=t=>{const o=D({},t),r=Vt(o),s=new Set,d=new Map,p=new Set,S=new WeakMap,b=e=>{var n;for(const c of(n=o.externs)!=null?n:[])if(c.Extern===e)return c.value;return e.default},w=e=>{const n=S.get(e);if(n)return n;const c=b(e),i={id:_++,type:"RemeshExternStorage",Extern:e,currentValue:c};return S.set(e,i),i},g=e=>w(e).currentValue,a=new WeakMap,m=e=>{var f;const n=a.get(e);if(n)return n;const c=e.State.stateName,i=(f=JSON.stringify(e.arg))!=null?f:"",u=`State/${e.State.stateId}/${c}:${i}`;return a.set(e,u),u},l=e=>{var f;const n=a.get(e);if(n)return n;const c=e.Query.queryName,i=(f=JSON.stringify(e.arg))!=null?f:"",u=`Query/${e.Query.queryId}/${c}:${i}`;return a.set(e,u),u},k=e=>{var f;const n=a.get(e);if(n)return n;const c=e.Domain.domainName,i=(f=JSON.stringify(e.arg))!=null?f:"",u=`Domain/${e.Domain.domainId}/${c}:${i}`;return a.set(e,u),u},x=e=>e.type==="RemeshStateItem"?m(e):e.type==="RemeshQueryPayload"?l(e):k(e),Ye=e=>{if(e.currentState===j)throw new Error(`State ${e.key} is not found`);return e.currentState},se=new WeakMap,Ge=e=>{const n=$(e.State.owner),c=m(e),i=e.State.defer?j:e.State.impl(e.arg),u={id:_++,type:"RemeshStateStorage",State:e.State,arg:e.arg,key:c,currentState:i,downstreamSet:new Set};return n.stateMap.set(c,u),se.set(e,u),r.inspectStateStorage(N.StateCreated,u),u},ae=e=>{const n=$(e.State.owner);n.stateMap.has(e.key)||(n.stateMap.set(e.key,e),r.inspectStateStorage(N.StateRestored,e))},F=e=>{const n=$(e.State.owner),c=m(e),i=n.stateMap.get(c);if(i)return i;const u=se.get(e);return u?(ae(u),u):Ge(e)},ce=new WeakMap,Ze=e=>{const n=$(e.owner),c=new K,i=new te(h=>{const M=c.subscribe(h);return f.refCount+=1,()=>{M.unsubscribe(),f.refCount-=1,p.add(f),L()}}),u=ce.get(e),f=Object.assign(u!=null?u:{},{type:"RemeshEventStorage",Event:e,subject:c,observable:i,refCount:0});return n.eventMap.set(e,f),ce.set(e,f),f},Y=e=>{const c=$(e.owner).eventMap.get(e);return c||Ze(e)},me=new WeakMap,ie=e=>{const n=new K,c=new te(i=>{const u=n.subscribe(i),f=e();return f.refCount+=1,()=>{u.unsubscribe(),f.refCount-=1,p.add(f),L()}});return{subject:n,observable:c}},ue=(e,n,c)=>{if(!e.prepare)return;const i=e.prepare(n,c);if(!!i){if(Array.isArray(i)){for(const u of i)q(u);return}q(i)}},de=e=>{if(!e.Query.scheduler)return;const n=new K;e.schedulerSubject=n;const c={get:R.get,get unwrap(){return R.unwrap.bind(c)},fromEvent:R.fromEvent,fromQuery:R.fromQuery};e.Query.scheduler(c,n.asObservable()).subscribe(()=>{$e(e),O()})},Oe=e=>{const n=$(e.Query.owner),c=l(e),{subject:i,observable:u}=ie(()=>h),f=new Set,h={id:_++,type:"RemeshQueryStorage",Query:e.Query,arg:e.arg,currentValue:j,key:c,upstreamSet:f,downstreamSet:new Set,subject:i,observable:u,refCount:0},{Query:M}=e;de(h);const v={get:E=>{if(h.upstreamSet!==f)return R.get(E);if(E.type==="RemeshStateItem"){const I=F(E);return h.upstreamSet.add(I),I.downstreamSet.add(h),R.get(E)}if(E.type==="RemeshQueryPayload"){const I=U(E);return h.upstreamSet.add(I),I.downstreamSet.add(h),R.get(E)}return R.get(E)},get unwrap(){return R.unwrap.bind(v)}};ue(M,v,e.arg);const y=M.impl(v,e.arg);return y instanceof Promise&&H(y),h.currentValue=y,n.queryMap.set(c,h),me.set(e,h),r.inspectQueryStorage(N.QueryCreated,h),h},pe=e=>{const n=$(e.Query.owner);if(n.queryMap.has(e.key))return;const{subject:c,observable:i}=ie(()=>e);e.subject=c,e.observable=i,n.queryMap.set(e.key,e),de(e);for(const u of e.upstreamSet)if(u.downstreamSet.add(e),u.type==="RemeshQueryStorage")pe(u);else if(u.type==="RemeshStateStorage")ae(u);else throw new Error(`Unknown upstream: ${u}`);r.inspectQueryStorage(N.QueryRestored,e),Z(e)},U=e=>{const n=$(e.Query.owner),c=l(e),i=n.queryMap.get(c);if(i)return i;const u=me.get(e);return u?(pe(u),u):Oe(e)},le=new WeakMap,qe=e=>{const n=$(e.owner),c=new K,i=c.asObservable(),u={id:_++,type:"RemeshCommand$Storage",Command$:e,subject:c,observable:i};return n.command$Map.set(e,u),le.set(e,u),u},fe=e=>{const n=$(e.owner),c=n.command$Map.get(e);if(c)return c;const i=le.get(e);if(i){const u=new K,f=u.asObservable();return i.subject=u,i.observable=f,i.subscription=void 0,n.command$Map.set(e,i),i}return qe(e)},ge=new WeakMap,Pe=e=>{const n=k(e);let c=!1;const i=new Set,u=new Set,f={state:v=>{if("default"in v){const E=Ct(v);return E.owner=e,E.Query.owner=e,E}if(!("impl"in v)){const E=Qt(v);return E.owner=e,E.Query.owner=e,E}const y=X(v);return y.owner=e,y.Query.owner=e,y},query:v=>{const y=ne(v);return y.owner=e,y},event:v=>{const y=$t(v);return y.owner=e,y},command:v=>{const y=Le(v);return y.owner=e,y},command$:v=>{const y=re(v);return y.owner=e,u.add(y),c&&T(y),y},commandAsync:v=>{const y=Te(v);return y.owner=e,u.add(y),c&&T(y),y},getDomain:v=>{const y=$(v);return i.add(y),y.domain},getExtern:v=>g(v)},h=e.Domain.impl(f,e.arg);c=!0;const M={id:_++,type:"RemeshDomainStorage",Domain:e.Domain,arg:e.arg,domain:h,domainContext:f,domainPayload:e,key:n,command$Set:u,upstreamSet:i,downstreamSet:new Set,upstreamSubscriptionSet:new Set,domainSubscriptionSet:new Set,stateMap:new Map,queryMap:new Map,eventMap:new Map,command$Map:new Map,refCount:0,running:!1};d.set(n,M),ge.set(e,M),r.inspectDomainStorage(N.DomainCreated,M);for(const v of i)v.downstreamSet.add(M);return M},$=e=>{const n=k(e),c=d.get(n);if(c)return c;const i=ge.get(e);if(i){i.running=!1,d.set(i.key,i);for(const u of i.upstreamSet)u.downstreamSet.add(i);return r.inspectDomainStorage(N.DomainRestored,i),i}return Pe(e)},Se=e=>{var c;const n=$(e.Query.owner);if(!!n.queryMap.has(e.key)){n.queryMap.delete(e.key),r.inspectQueryStorage(N.QueryDestroyed,e);for(const i of e.upstreamSet)if(i.downstreamSet.delete(e),i.type==="RemeshQueryStorage")ye(i);else if(i.type==="RemeshStateStorage")be(i);else throw new Error(`Unknown upstream in clearQueryStorageIfNeeded(..): ${i}`);(c=e.schedulerSubject)==null||c.complete(),e.subject.complete()}},ye=e=>{e.refCount===0&&e.downstreamSet.size===0&&Se(e)},ve=e=>{const n=$(e.State.owner);!n.stateMap.has(e.key)||(r.inspectStateStorage(N.StateDestroyed,e),n.stateMap.delete(e.key),e.downstreamSet.clear())},be=e=>{e.downstreamSet.size===0&&ve(e)},we=e=>{const n=$(e.Event.owner);e.subject.complete(),n.eventMap.delete(e.Event)},et=e=>{e.refCount===0&&we(e)},tt=e=>{var c;const n=$(e.Command$.owner);e.subject.complete(),(c=e.subscription)==null||c.unsubscribe(),e.subscription=void 0,n.command$Map.delete(e.Command$)},he=e=>{r.inspectDomainStorage(N.DomainDestroyed,e),_e(e.domainSubscriptionSet),_e(e.upstreamSubscriptionSet);for(const n of e.eventMap.values())we(n);for(const n of e.queryMap.values())Se(n);for(const n of e.stateMap.values())ve(n);for(const n of e.command$Map.values())tt(n);e.upstreamSubscriptionSet.clear(),e.domainSubscriptionSet.clear(),e.downstreamSet.clear(),e.stateMap.clear(),e.queryMap.clear(),e.eventMap.clear(),e.running=!1,d.delete(e.key);for(const n of e.upstreamSet)n.downstreamSet.delete(e),Re(n)},Re=e=>{e.refCount===0&&e.downstreamSet.size===0&&e.domainSubscriptionSet.size===0&&he(e)},nt=e=>{const n=F(e);return Ye(n)},Ee=e=>{const n=U(e),c=n.currentValue;if(c===j)throw new Error(`Query ${n.key} is not ready yet.`);return c},G=new WeakMap,De=e=>{const n=U(e);if(G.has(n))return G.get(n);const i=$(e.Query.owner).domainContext,u=R.get(e),f=H(u),h=i.state({name:`${e.Query.queryName}.UnwrappedState`,inspectable:!1,default:f}),M=i.query({name:`${e.Query.queryName}.UnwrappedQuery`,inspectable:!1,impl:({get:E})=>E(h())}),v=i.command({name:`${e.Query.queryName}.updateUnwrappedState`,inspectable:!1,impl:(E,I)=>h().new(I)});i.command$({name:`${e.Query.queryName}.UnwrappedCommand$`,inspectable:!1,impl:({fromQuery:E,get:I})=>E(e).pipe(bt(I(e)),ze(Wt),wt(v))});const y=M();return G.set(n,y),y},R={get:e=>{if(e.type==="RemeshStateItem")return nt(e);if(e.type==="RemeshQueryPayload")return Ee(e);throw new Error(`Unexpected input in ctx.get(..): ${e}`)},unwrap(e){const n=De(e);return this.get(n)},fromEvent:e=>Y(e).observable,fromQuery:e=>U(e).observable},Z=e=>{if(e.schedulerSubject)if(e.currentValue!==j)e.schedulerSubject.next(e.currentValue);else throw new Error(`Query ${e.key} is not ready yet.`);else $e(e)},$e=e=>{const{Query:n}=e;for(const f of e.upstreamSet)f.downstreamSet.delete(e),f.downstreamSet.size===0&&p.add(f);const c=new Set;e.upstreamSet=c;const i={get:f=>{if(e.upstreamSet!==c)return R.get(f);if(f.type==="RemeshStateItem"){const h=F(f);return e.upstreamSet.add(h),h.downstreamSet.add(e),R.get(f)}if(f.type==="RemeshQueryPayload"){const h=U(f);return e.upstreamSet.add(h),h.downstreamSet.add(e),R.get(f)}return R.get(f)},get unwrap(){return R.unwrap.bind(i)}};ue(n,i,e.arg);const u=n.impl(i,e.arg);if(!(e.currentValue!==j&&n.compare(e.currentValue,u))){e.currentValue=u,u instanceof Promise&&H(u),s.add(e),r.inspectQueryStorage(N.QueryUpdated,e);for(const f of[...e.downstreamSet])Z(f)}},L=()=>{if(p.size===0)return;const e=[...p];p.clear();for(const n of e)n.type==="RemeshDomainStorage"?Re(n):n.type==="RemeshEventStorage"?et(n):n.type==="RemeshQueryStorage"?ye(n):n.type==="RemeshStateStorage"&&be(n);L()},Ce=()=>{if(s.size===0)return;const e=[...s];s.clear();for(const n of e)s.has(n)||n.subject.next(n.currentValue);Ce()},O=()=>{Ce()},q=e=>{const n=F(e.stateItem);if(!(n.currentState!==j&&e.stateItem.State.compare(n.currentState,e.newState))){n.currentState=e.newState,r.inspectStateStorage(N.StateUpdated,n);for(const c of[...n.downstreamSet])Z(c)}},Qe=e=>{const{Event:n,arg:c}=e,i=Y(n);if(r.inspectEventEmitted(N.EventEmitted,e),n.impl){const u={get:R.get,get unwrap(){return R.unwrap.bind(u)}},f=n.impl(u,c);i.subject.next(f)}else i.subject.next(c)},Ne=e=>{r.inspectCommandReceived(N.CommandReceived,e);const{Command:n,arg:c}=e,i={get:R.get,get unwrap(){return R.unwrap.bind(i)}},u=n.impl(i,c);P(u)},xe=(e,n)=>{e.add(n),n.add(()=>{e.delete(n)})},T=e=>{const n=fe(e);if(n.subscription)return;const c={get:R.get,get unwrap(){return R.unwrap.bind(c)},fromEvent:R.fromEvent,fromQuery:R.fromQuery},u=e.impl(c,n.observable).subscribe(f=>{P(f),O()});n.subscription=u},P=e=>{if(e!==null){if(Array.isArray(e)){for(const n of e)P(n);return}if(e.type==="RemeshCommandPayload"){Ne(e);return}else if(e.type==="RemeshEventPayload"){Qe(e);return}else if(e.type==="RemeshStateSetterPayload"){q(e);return}else if(e.type==="RemeshCommand$Payload"){Me(e);return}throw new Error(`Unknown command output of ${e}`)}},Me=e=>{r.inspectCommand$Received(N.Command$Received,e);const{Command$:n,arg:c}=e,i=fe(n);T(n),i.subject.next(c)},rt=(e,n)=>{xe(e.domainSubscriptionSet,n),n.add(()=>{p.add(e),L()})},ot=(e,n)=>{const c=U(e);return c.observable.subscribe(n)},st=(e,n)=>Y(e).observable.subscribe(n),at=e=>{const n={};for(const c in e.command){const i=e.command[c];n[c]=u=>ke(i(u))}return n},ct=e=>{const n=$(e);if(n.domainOutput)return n.domainOutput;const c=n.domain,i=at(c),u=C(D({},c),{command:i});return n.domainOutput=u,u},mt=e=>{for(const n of e)T(n)},it=e=>{if(!e.running){e.running=!0;for(const n of e.upstreamSet){const c=Ie(n.domainPayload);xe(e.upstreamSubscriptionSet,c)}mt(e.command$Set)}},Ie=e=>{const n=$(e),c=new ht;return rt(n,c),it(n),c},ut=()=>{r.destroyInspectors();for(const e of d.values())he(e);d.clear(),s.clear()},dt=e=>{Qe(e)},ke=e=>{e.type==="RemeshCommandPayload"?(Ne(e),O()):e.type==="RemeshCommand$Payload"&&Me(e)},pt=e=>R.unwrap(e);return{name:o.name,getDomain:ct,query:Ee,unwrap:pt,getUnwrappedQueryPayload:De,emitEvent:dt,sendCommand:ke,destroy:ut,subscribeQuery:ot,subscribeEvent:st,subscribeDomain:Ie,getKey:x}},_e=t=>{for(const o of t)o.unsubscribe()},Je={domain:oe,extern:At,store:Kt,state:X,query:ne,command:Le,command$:re,commandAsync:Te},He=Q.exports.createContext(null),_t=()=>{const t=Q.exports.useContext(He);if(t===null)throw new Error("You may forgot to add <RemeshRoot />");return t},B=()=>_t().remeshStore,Xt=t=>{const o=Q.exports.useMemo(()=>({remeshStore:t.store}),[t.store]);return Rt.createElement(He.Provider,{value:o},t.children)},Xe=function(t){const o=B(),r=Q.exports.useRef(null),s=Q.exports.useCallback(w=>(r.current=w,()=>{r.current=null}),[]),d=Q.exports.useCallback(()=>o.query(t),[o,t]),p=Et.exports.useSyncExternalStore(s,d),S=Q.exports.useRef(null),b=o.getKey(t);return Q.exports.useEffect(()=>()=>{var w;(w=S.current)==null||w.unsubscribe(),S.current=null},[o,b]),Q.exports.useEffect(()=>{S.current===null&&(S.current=o.subscribeQuery(t,()=>{var w;(w=r.current)==null||w.call(r)}))},[o,t]),p},Bt=function(t){const r=B().getUnwrappedQueryPayload(t);return Xe(r)},Yt=function(t){const o=Xe(t),r=H(o);if(r.type==="pending")throw o;if(r.type==="rejected")throw r.error;return r.value},Gt=function(t,o){const r=B(),s=Q.exports.useRef(o);Q.exports.useEffect(()=>{s.current=o}),Q.exports.useEffect(()=>{const d=r.subscribeEvent(t,p=>{s.current(p)});return()=>{d.unsubscribe()}},[t,r])},Zt=function(t){const o=B(),r=Q.exports.useRef(null),s=o.getDomain(t),d=o.getKey(t);return Q.exports.useEffect(()=>()=>{var p;(p=r.current)==null||p.unsubscribe(),r.current=null},[o,d]),Q.exports.useEffect(()=>{r.current===null&&(r.current=o.subscribeDomain(t))},[o,t]),s},zt=t=>{const o=t.getHours().toString().padStart(2,"0"),r=t.getMinutes().toString().padStart(2,"0"),s=t.getSeconds().toString().padStart(2,"0"),d=t.getMilliseconds().toString().padStart(3,"0");return`${o}:${r}:${s}.${d}`},Ft=()=>{const t=new Date;return zt(t)},Be=t=>{const o=D({include:["state","domain","event","command","command$"]},t);return{onActive:(s,d)=>{var p;(p=o.exclude)!=null&&p.includes(s)||(o.include?o.include.includes(s)&&d():d())}}},Lt=()=>{if(typeof window!="undefined")return window.__REDUX_DEVTOOLS_EXTENSION__},Ot=t=>{const o=Lt();if(!!o)return r=>{var g;const s=Be(t),d=o.connect({name:r==null?void 0:r.name,features:{pause:!1,lock:!1,persist:!1,export:!1,import:!1,jump:!1,skip:!1,reorder:!1,dispatch:!1,test:!1}}),p=(a,m)=>{d.send(m,null)},S=Je.store({name:`RemeshReduxDevtools(${(g=r==null?void 0:r.name)!=null?g:""})`}),b=S.getDomain(A()),w=a=>{const m={domainId:a.Domain.domainId,domainName:a.Domain.domainName};return a.arg!==void 0?C(D({},m),{domainArg:a.arg}):m};return s.onActive("domain",()=>{S.subscribeEvent(b.event.RemeshDomainStorageEvent,a=>{const m=a.storage.Domain,l={type:`${a.type}::${m.domainName}`,domainId:m.domainId,domainName:m.domainName};a.storage.arg!==void 0?p(l.type,C(D({},l),{domainArg:a.storage.arg})):p(l.type,l)})}),s.onActive("state",()=>{S.subscribeEvent(b.event.RemeshStateStorageEvent,a=>{const m=a.storage.State,l={type:`${a.type}::${m.stateName}`,owner:w(m.owner),stateId:m.stateId,stateName:m.stateName,stateValue:a.storage.currentState};a.storage.arg!==void 0?p(l.type,C(D({},l),{stateArg:a.storage.arg})):p(l.type,l)})}),s.onActive("query",()=>{S.subscribeEvent(b.event.RemeshQueryStorageEvent,a=>{const m=a.storage.Query,l={type:`${a.type}::${m.queryName}`,owner:w(m.owner),queryId:m.queryId,queryName:m.queryName};a.storage.arg!==void 0?p(l.type,C(D({},l),{queryArg:a.storage.arg})):p(l.type,l)})}),s.onActive("command",()=>{S.subscribeEvent(b.event.RemeshCommandReceivedEvent,a=>{const m=a.payload.Command,l={type:`${a.type}::${m.commandName}`,owner:w(m.owner),commandId:m.commandId,commandName:m.commandName};a.payload.arg!==void 0?p(l.type,C(D({},l),{commandArg:a.payload.arg})):p(l.type,l)})}),s.onActive("command$",()=>{S.subscribeEvent(b.event.RemeshCommand$ReceivedEvent,a=>{const m=a.payload.Command$,l={type:`${a.type}::${m.command$Name}`,owner:w(m.owner),command$Id:m.command$Id,command$Name:m.command$Name};a.payload.arg!==void 0?p(l.type,C(D({},l),{command$Arg:a.payload.arg})):p(l.type,l)})}),s.onActive("event",()=>{S.subscribeEvent(b.event.RemeshEventEmittedEvent,a=>{const m=a.payload.Event,l={type:`${a.type}::${m.eventName}`,owner:w(m.owner),eventId:m.eventId,eventName:m.eventName};a.payload.arg!==void 0?p(l.type,C(D({},l),{eventArg:a.payload.arg})):p(l.type,l)})}),S}},qt=t=>o=>{var w;const r=D({collapsed:!0},t),s=Be(r),d=(g,a)=>{if(r.collapsed){const m=g.split("::");console.groupCollapsed(`%c${m[0]}%c::%c${m[1]}%c::%c${m[2]}%c @ ${Ft()}`,"color:#03A9F4; font-weight: bold","color:#9E9E9E; font-weight: bold","color:#4CAF50; font-weight: bold","color:#9E9E9E; font-weight: bold","color:#AA07DE; font-weight: bold","color:#9E9E9E; font-weight: lighter")}console.log(a),r.collapsed&&console.groupEnd()},p=Je.store(C(D({},o),{name:`RemeshLogger(${(w=o==null?void 0:o.name)!=null?w:""})`})),S=p.getDomain(A()),b=g=>{const a={domainId:g.Domain.domainId,domainName:g.Domain.domainName};return g.arg!==void 0?C(D({},a),{domainArg:g.arg}):a};return s.onActive("domain",()=>{p.subscribeEvent(S.event.RemeshDomainStorageEvent,g=>{const a=g.storage.Domain,m={type:`${g.type}::${a.domainName}`,domainId:a.domainId,domainName:a.domainName};g.storage.arg!==void 0?d(m.type,C(D({},m),{domainArg:g.storage.arg})):d(m.type,m)})}),s.onActive("state",()=>{p.subscribeEvent(S.event.RemeshStateStorageEvent,g=>{const a=g.storage.State,m={type:`${g.type}::${a.stateName}`,owner:b(a.owner),stateId:a.stateId,stateName:a.stateName,stateValue:g.storage.currentState};g.storage.arg!==void 0?d(m.type,C(D({},m),{stateArg:g.storage.arg})):d(m.type,m)})}),s.onActive("query",()=>{p.subscribeEvent(S.event.RemeshQueryStorageEvent,g=>{const a=g.storage.Query,m={type:`${g.type}::${a.queryName}`,owner:b(a.owner),queryId:a.queryId,queryName:a.queryName,queryValue:g.storage.currentValue};g.storage.arg!==void 0?d(m.type,C(D({},m),{queryArg:g.storage.arg})):d(m.type,m)})}),s.onActive("command",()=>{p.subscribeEvent(S.event.RemeshCommandReceivedEvent,g=>{const a=g.payload.Command,m={type:`${g.type}::${a.commandName}`,owner:b(a.owner),commandId:a.commandId,commandName:a.commandName};g.payload.arg!==void 0?d(m.type,C(D({},m),{commandArg:g.payload.arg})):d(m.type,m)})}),s.onActive("command$",()=>{p.subscribeEvent(S.event.RemeshCommand$ReceivedEvent,g=>{const a=g.payload.Command$,m={type:`${g.type}::${a.command$Name}`,owner:b(a.owner),command$Id:a.command$Id,command$Name:a.command$Name};g.payload.arg!==void 0?d(m.type,C(D({},m),{command$Arg:g.payload.arg})):d(m.type,m)})}),s.onActive("event",()=>{p.subscribeEvent(S.event.RemeshEventEmittedEvent,g=>{const a=g.payload.Event,m={type:`${g.type}::${a.eventName}`,owner:b(a.owner),eventId:a.eventId,eventName:a.eventName};g.payload.arg!==void 0?d(m.type,C(D({},m),{eventArg:g.payload.arg})):d(m.type,m)})}),p};export{Je as R,Xe as a,Ot as b,qt as c,Xt as d,Ht as e,Gt as f,Bt as g,Yt as h,Zt as u};
//# sourceMappingURL=remesh-logger.84358a20.js.map
