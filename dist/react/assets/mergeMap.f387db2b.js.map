{"version":3,"file":"mergeMap.f387db2b.js","sources":["../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js"],"sourcesContent":["import { innerFrom } from '../observable/innerFrom';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalFinalizer) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(createOperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        if (innerSubScheduler) {\n                            executeSchedule(subscriber, innerSubScheduler, function () { return doInnerSub(bufferedValue); });\n                        }\n                        else {\n                            doInnerSub(bufferedValue);\n                        }\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(createOperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalFinalizer === null || additionalFinalizer === void 0 ? void 0 : additionalFinalizer();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map"],"names":["mergeInternals","source","subscriber","project","concurrent","onBeforeNext","expand","innerSubScheduler","additionalFinalizer","buffer","active","index","isComplete","checkComplete","outerNext","value","doInnerSub","innerComplete","innerFrom","createOperatorSubscriber","innerValue","_loop_1","bufferedValue","executeSchedule","err","mergeMap","resultSelector","isFunction","a","i","map","b","ii","operate"],"mappings":"kFAGO,SAASA,EAAeC,EAAQC,EAAYC,EAASC,EAAYC,EAAcC,EAAQC,EAAmBC,EAAqB,CAClI,IAAIC,EAAS,CAAA,EACTC,EAAS,EACTC,EAAQ,EACRC,EAAa,GACbC,EAAgB,UAAY,CACxBD,GAAc,CAACH,EAAO,QAAU,CAACC,GACjCR,EAAW,SAAQ,CAE/B,EACQY,EAAY,SAAUC,EAAO,CAAE,OAAQL,EAASN,EAAaY,EAAWD,CAAK,EAAIN,EAAO,KAAKM,CAAK,CAAG,EACrGC,EAAa,SAAUD,EAAO,CAC9BT,GAAUJ,EAAW,KAAKa,CAAK,EAC/BL,IACA,IAAIO,EAAgB,GACpBC,EAAUf,EAAQY,EAAOJ,GAAO,CAAC,EAAE,UAAUQ,EAAyBjB,EAAY,SAAUkB,EAAY,CACpGf,GAAiB,MAA2CA,EAAae,CAAU,EAC/Ed,EACAQ,EAAUM,CAAU,EAGpBlB,EAAW,KAAKkB,CAAU,CAE1C,EAAW,UAAY,CACXH,EAAgB,EACnB,EAAE,OAAW,UAAY,CACtB,GAAIA,EACA,GAAI,CACAP,IAUA,QATIW,EAAU,UAAY,CACtB,IAAIC,EAAgBb,EAAO,QACvBF,EACAgB,EAAgBrB,EAAYK,EAAmB,UAAY,CAAE,OAAOS,EAAWM,CAAa,CAAE,CAAE,EAGhGN,EAAWM,CAAa,CAEpD,EAC2Bb,EAAO,QAAUC,EAASN,GAC7BiB,IAEJR,GACH,OACMW,EAAP,CACItB,EAAW,MAAMsB,CAAG,CACvB,CAER,CAAA,CAAC,CACV,EACI,OAAAvB,EAAO,UAAUkB,EAAyBjB,EAAYY,EAAW,UAAY,CACzEF,EAAa,GACbC,GACH,CAAA,CAAC,EACK,UAAY,CACfL,GAAwB,MAAkDA,GAClF,CACA,CCtDO,SAASiB,EAAStB,EAASuB,EAAgBtB,EAAY,CAE1D,OADIA,IAAe,SAAUA,EAAa,KACtCuB,EAAWD,CAAc,EAClBD,EAAS,SAAUG,EAAGC,EAAG,CAAE,OAAOC,EAAI,SAAUC,EAAGC,EAAI,CAAE,OAAON,EAAeE,EAAGG,EAAGF,EAAGG,CAAE,EAAI,EAAEd,EAAUf,EAAQyB,EAAGC,CAAC,CAAC,CAAC,CAAI,EAAEzB,CAAU,GAE1I,OAAOsB,GAAmB,WAC/BtB,EAAasB,GAEVO,EAAQ,SAAUhC,EAAQC,EAAY,CAAE,OAAOF,EAAeC,EAAQC,EAAYC,EAASC,CAAU,CAAI,CAAA,EACpH"}