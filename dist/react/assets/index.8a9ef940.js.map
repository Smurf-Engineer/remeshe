{"version":3,"file":"index.8a9ef940.js","sources":["../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/tap.js","../../../projects/domains/src/todo-mvc/uuid.ts","../../../projects/domains/src/todo-mvc/todo-repo.ts","../../../projects/domains/src/todo-mvc/index.ts","../../../projects/react-demos/src/todo-mvc/hooks.ts","../../../projects/react-demos/src/todo-mvc/TodoItem.tsx","../../../projects/react-demos/src/todo-mvc/TodoList.tsx","../../../projects/react-demos/src/todo-mvc/todoRepo.ts","../../../projects/react-demos/src/todo-mvc/index.tsx"],"sourcesContent":["import { isFunction } from '../util/isFunction';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { identity } from '../util/identity';\nexport function tap(observerOrNext, error, complete) {\n    var tapObserver = isFunction(observerOrNext) || error || complete\n        ?\n            { next: observerOrNext, error: error, complete: complete }\n        : observerOrNext;\n    return tapObserver\n        ? operate(function (source, subscriber) {\n            var _a;\n            (_a = tapObserver.subscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n            var isUnsub = true;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                var _a;\n                (_a = tapObserver.next) === null || _a === void 0 ? void 0 : _a.call(tapObserver, value);\n                subscriber.next(value);\n            }, function () {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.complete) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                subscriber.complete();\n            }, function (err) {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.error) === null || _a === void 0 ? void 0 : _a.call(tapObserver, err);\n                subscriber.error(err);\n            }, function () {\n                var _a, _b;\n                if (isUnsub) {\n                    (_a = tapObserver.unsubscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                }\n                (_b = tapObserver.finalize) === null || _b === void 0 ? void 0 : _b.call(tapObserver);\n            }));\n        })\n        :\n            identity;\n}\n//# sourceMappingURL=tap.js.map","export const uuid = () =>\r\n  'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n    var r = (Math.random() * 16) | 0,\r\n      v = c == 'x' ? r : (r & 0x3) | 0x8\r\n    return v.toString(16)\r\n  })\r\n","import { Remesh } from 'remesh'\r\nimport type { Todo } from '.'\r\n\r\ntype TodoRepo = {\r\n  getTodoList: () => Promise<Todo[]>\r\n  addTodo: (todo: Todo) => void\r\n  removeTodoByIds: (ids: Todo['id'][]) => void\r\n  updateTodo: (updateTodo: Todo) => void\r\n  toggleCompletedByIds: (ids: Todo['id'][], completed: boolean) => void\r\n}\r\n\r\nexport const TodoRepoExtern = Remesh.extern<TodoRepo>({\r\n  name: 'TodoRepoExtern',\r\n  default: {\r\n    async getTodoList() {\r\n      throw new Error('Not implemented')\r\n    },\r\n    async addTodo() {\r\n      throw new Error('Not implemented')\r\n    },\r\n    async removeTodoByIds() {\r\n      throw new Error('Not implemented')\r\n    },\r\n    async updateTodo() {\r\n      throw new Error('Not implemented')\r\n    },\r\n\r\n    async toggleCompletedByIds() {\r\n      throw new Error('Not implemented')\r\n    },\r\n  },\r\n})\r\n","import { Remesh } from 'remesh'\r\nimport { from, map, merge, tap } from 'rxjs'\r\nimport { uuid } from './uuid'\r\nimport { TodoRepoExtern } from './todo-repo'\r\n\r\nexport type Todo = {\r\n  id: string\r\n  name: string\r\n  completed: boolean\r\n}\r\n\r\nexport const TodoDomain = Remesh.domain({\r\n  name: 'TodoDomain',\r\n  impl: (domain) => {\r\n    const repo = domain.getExtern(TodoRepoExtern)\r\n\r\n    const TodoListState = domain.state<Todo[]>({\r\n      name: 'TodoListState',\r\n      default: [],\r\n    })\r\n\r\n    const TodoListQuery = domain.query({\r\n      name: 'TodoListQuery',\r\n      impl({ get }, status?: 'completed' | 'active') {\r\n        const todoList = get(TodoListState())\r\n        if (status === 'active') {\r\n          return todoList.filter((todo) => !todo.completed)\r\n        } else if (status === 'completed') {\r\n          return todoList.filter((todo) => todo.completed)\r\n        } else {\r\n          return todoList\r\n        }\r\n      },\r\n    })\r\n\r\n    const HasCompletedQuery = domain.query({\r\n      name: 'HasCompletedQuery',\r\n      impl({ get }) {\r\n        return get(TodoListQuery('completed')).length > 0\r\n      },\r\n    })\r\n\r\n    const ActiveTodoCountQuery = domain.query({\r\n      name: 'ActiveTodoCountQuery',\r\n      impl({ get }) {\r\n        return get(TodoListQuery('active')).length\r\n      },\r\n    })\r\n\r\n    const AllCompletedQuery = domain.query({\r\n      name: 'AllCompletedQuery',\r\n      impl({ get }) {\r\n        return get(ActiveTodoCountQuery()) === 0 && get(TodoListQuery()).length > 0\r\n      },\r\n    })\r\n\r\n    const TodoAddedEvent = domain.event<Todo>({\r\n      name: 'TodoAddedEvent',\r\n    })\r\n\r\n    const SetTodoListCommand = domain.command({\r\n      name: 'SetTodoListCommand',\r\n      impl(_, todoList: Todo[]) {\r\n        return TodoListState().new(todoList)\r\n      },\r\n    })\r\n\r\n    const AddTodoFailedEvent = domain.event<string>({\r\n      name: 'AddTodoFailedEvent',\r\n    })\r\n\r\n    const AddTodoCommand = domain.command({\r\n      name: 'AddTodoCommand',\r\n      impl({ get }, todoName: string) {\r\n        if (todoName.trim() === '') {\r\n          return [AddTodoFailedEvent('Cannot be empty, please enter the TODO name')]\r\n        }\r\n\r\n        const todoList = get(TodoListState())\r\n        const newTodo = {\r\n          id: uuid(),\r\n          name: todoName,\r\n          completed: false,\r\n        }\r\n\r\n        return [TodoListState().new([...todoList, newTodo]), TodoAddedEvent(newTodo)]\r\n      },\r\n    })\r\n\r\n    const RemoveTodoEvent = domain.event<Todo['id'][]>({\r\n      name: 'RemoveTodoEvent',\r\n    })\r\n\r\n    const RemoveTodoCommand = domain.command({\r\n      name: 'RemoveTodoCommand',\r\n      impl({ get }, id: Todo['id']) {\r\n        const todoList = get(TodoListState())\r\n        const newTodoList = todoList.filter((todo) => todo.id !== id)\r\n\r\n        return [TodoListState().new(newTodoList), RemoveTodoEvent([id])]\r\n      },\r\n    })\r\n\r\n    const TodoUpdatedEvent = domain.event<Todo>({\r\n      name: 'TodoUpdatedEvent',\r\n    })\r\n\r\n    const UpdateTodoCommand = domain.command({\r\n      name: 'UpdateTodoCommand',\r\n      impl({ get }, payload: { id: Todo['id'] } & Partial<Todo>) {\r\n        const todoList = get(TodoListState())\r\n\r\n        if (payload.name && payload.name.trim() === '') {\r\n          return RemoveTodoCommand(payload.id)\r\n        }\r\n\r\n        const newTodoList = todoList.map((todo) => {\r\n          if (todo.id === payload.id) {\r\n            return {\r\n              ...todo,\r\n              ...payload,\r\n              id: todo.id,\r\n            }\r\n          } else {\r\n            return todo\r\n          }\r\n        })\r\n\r\n        const targetTodo = newTodoList.find((todo) => todo.id === payload.id)\r\n\r\n        if (!targetTodo) {\r\n          return null\r\n        }\r\n\r\n        return [TodoListState().new(newTodoList), TodoUpdatedEvent(targetTodo)]\r\n      },\r\n    })\r\n\r\n    const TodoCompletedChangedEvent = domain.event<{ ids: Todo['id'][]; completed: boolean }>({\r\n      name: 'TodoCompletedChangedEvent',\r\n    })\r\n\r\n    const ToggleTodoCompletedCommand = domain.command({\r\n      name: 'ToggleTodoCompletedCommand',\r\n      impl({ get }, targetTodoId: Todo['id']) {\r\n        const todoList = get(TodoListState())\r\n\r\n        const newTodoList = todoList.map((todo) => {\r\n          if (todo.id === targetTodoId) {\r\n            return {\r\n              ...todo,\r\n              completed: !todo.completed,\r\n            }\r\n          }\r\n          return todo\r\n        })\r\n\r\n        const targetTodo = newTodoList.find((todo) => todo.id === targetTodoId)\r\n\r\n        if (!targetTodo) {\r\n          return null\r\n        }\r\n\r\n        const eventData = {\r\n          ids: [targetTodoId],\r\n          completed: targetTodo?.completed,\r\n        }\r\n\r\n        return [TodoListState().new(newTodoList), TodoCompletedChangedEvent(eventData)]\r\n      },\r\n    })\r\n\r\n    const ToggleAllTodoCompletedCommand = domain.command({\r\n      name: 'ToggleAllTodoCompletedCommand',\r\n      impl({ get }, completed: boolean) {\r\n        const todoList = get(TodoListState())\r\n\r\n        if (todoList.length === 0) {\r\n          return null\r\n        }\r\n\r\n        const newTodoList = todoList.map((todo) => {\r\n          return { ...todo, completed }\r\n        })\r\n\r\n        return [\r\n          TodoListState().new(newTodoList),\r\n          TodoCompletedChangedEvent({\r\n            ids: newTodoList.map((todo) => todo.id),\r\n            completed,\r\n          }),\r\n        ]\r\n      },\r\n    })\r\n\r\n    const ClearCompletedCommand = domain.command({\r\n      name: 'ClearCompletedCommand',\r\n      impl({ get }) {\r\n        const todoList = get(TodoListState())\r\n        const newTodoList = todoList.filter((todo) => !todo.completed)\r\n        const removedTodoIdList = todoList.filter((todo) => todo.completed).map((todo) => todo.id)\r\n\r\n        return [TodoListState().new(newTodoList), RemoveTodoEvent(removedTodoIdList)]\r\n      },\r\n    })\r\n\r\n    domain.effect({\r\n      name: 'FromRepoToStateEffect',\r\n      impl() {\r\n        return from(repo.getTodoList()).pipe(map((todos) => SetTodoListCommand(todos)))\r\n      },\r\n    })\r\n\r\n    domain.effect({\r\n      name: 'FromStateToRepoEffect',\r\n      impl: ({ fromEvent }) => {\r\n        const addTodo$ = fromEvent(TodoAddedEvent).pipe(tap((todo) => repo.addTodo(todo)))\r\n\r\n        const removeTodo$ = fromEvent(RemoveTodoEvent).pipe(tap((ids) => repo.removeTodoByIds(ids)))\r\n\r\n        const updateTodo$ = fromEvent(TodoUpdatedEvent).pipe(tap((todo) => repo.updateTodo(todo)))\r\n\r\n        const toggleTodoCompleted$ = fromEvent(TodoCompletedChangedEvent).pipe(\r\n          tap((eventData) => repo.toggleCompletedByIds(eventData.ids, eventData.completed)),\r\n        )\r\n\r\n        return merge(addTodo$, removeTodo$, updateTodo$, toggleTodoCompleted$).pipe(map(() => null))\r\n      },\r\n    })\r\n\r\n    return {\r\n      query: {\r\n        TodoListQuery,\r\n        ActiveTodoCountQuery,\r\n        HasCompletedQuery,\r\n        AllCompletedQuery,\r\n      },\r\n      command: {\r\n        AddTodoCommand,\r\n        RemoveTodoCommand,\r\n        ToggleTodoCompletedCommand,\r\n        ToggleAllTodoCompletedCommand,\r\n        UpdateTodoCommand,\r\n        ClearCompletedCommand,\r\n      },\r\n      event: { AddTodoFailedEvent },\r\n    }\r\n  },\r\n})\r\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\r\n\r\nexport function useInputHandler(defaultValue: string) {\r\n  const [value, setValue] = useState(defaultValue)\r\n\r\n  const onChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setValue(event.target.value)\r\n  }, [])\r\n\r\n  return [value, onChange, setValue] as const\r\n}\r\n\r\nexport function useKeyPressHandler(key: string, callback: (event: React.KeyboardEvent<HTMLInputElement>) => void) {\r\n  const callbackRef = useRef(callback)\r\n\r\n  const handleKeyPress = useCallback(\r\n    (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n      if (event.key.toLocaleLowerCase() === key.toLocaleLowerCase()) {\r\n        event.preventDefault()\r\n        callbackRef.current(event)\r\n      }\r\n    },\r\n    [key],\r\n  )\r\n\r\n  useEffect(() => {\r\n    callbackRef.current = callback\r\n  })\r\n\r\n  return handleKeyPress\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { useRemeshDomain, useRemeshSend } from 'remesh-react'\r\n\r\nimport { Todo, TodoDomain } from 'remesh-domains-for-demos/dist/todo-mvc'\r\nimport { useInputHandler, useKeyPressHandler } from './hooks'\r\n\r\nexport function TodoItem({ todo }: { todo: Todo }) {\r\n  const send = useRemeshSend()\r\n  const domain = useRemeshDomain(TodoDomain())\r\n\r\n  const [editing, setEditing] = useState(false)\r\n\r\n  const ref = useRef<HTMLInputElement>(null)\r\n\r\n  const [todoName, handleTodoNameChange] = useInputHandler(todo.name)\r\n\r\n  const handlePressEnter = useKeyPressHandler('Enter', () => {\r\n    send(domain.command.UpdateTodoCommand({ ...todo, name: todoName }))\r\n    setEditing(false)\r\n  })\r\n\r\n  const handleEnableEdit = () => {\r\n    setEditing(true)\r\n  }\r\n\r\n  const handleSave = () => {\r\n    send(domain.command.ToggleTodoCompletedCommand(todo.id))\r\n  }\r\n\r\n  const handleDelete = () => {\r\n    send(domain.command.RemoveTodoCommand(todo.id))\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (editing) {\r\n      ref.current?.focus()\r\n    }\r\n  }, [editing])\r\n\r\n  return (\r\n    <li onDoubleClick={handleEnableEdit} className={`${editing ? 'editing' : ''} ${todo.completed ? 'completed' : ''}`}>\r\n      <div className=\"view\">\r\n        <input type=\"checkbox\" className=\"toggle\" checked={todo.completed} onChange={handleSave} />\r\n        <label>{todo.name}</label>\r\n        <button className=\"destroy\" onClick={handleDelete} />\r\n      </div>\r\n      {editing && (\r\n        <input\r\n          ref={ref}\r\n          className=\"edit\"\r\n          value={todoName}\r\n          onChange={handleTodoNameChange}\r\n          onKeyPress={handlePressEnter}\r\n          onBlur={() => {\r\n            setEditing(false)\r\n          }}\r\n        />\r\n      )}\r\n    </li>\r\n  )\r\n}\r\n","import { useRemeshDomain, useRemeshEvent, useRemeshQuery, useRemeshSend } from 'remesh-react'\r\nimport { NavLink, useParams } from 'react-router-dom'\r\n\r\nimport { TodoDomain } from 'remesh-domains-for-demos/dist/todo-mvc'\r\nimport { useInputHandler, useKeyPressHandler } from './hooks'\r\nimport { TodoItem } from './TodoItem'\r\n\r\ntype FilterType = 'completed' | 'active' | undefined\r\n\r\nexport const TodoList = () => {\r\n  const send = useRemeshSend()\r\n  const { filter } = useParams()\r\n\r\n  const domain = useRemeshDomain(TodoDomain())\r\n\r\n  const todoList = useRemeshQuery(domain.query.TodoListQuery(filter as FilterType))\r\n  const activeTodoCount = useRemeshQuery(domain.query.ActiveTodoCountQuery())\r\n  const hasCompleted = useRemeshQuery(domain.query.HasCompletedQuery())\r\n  const allCompleted = useRemeshQuery(domain.query.AllCompletedQuery())\r\n\r\n  const [newTodo, handleTodoNameInput, setNewTodo] = useInputHandler('')\r\n\r\n  const handlePressEnter = useKeyPressHandler('Enter', () => {\r\n    send(domain.command.AddTodoCommand(newTodo))\r\n    setNewTodo('')\r\n  })\r\n\r\n  const handleToggleAll = () => {\r\n    send(domain.command.ToggleAllTodoCompletedCommand(!allCompleted))\r\n  }\r\n\r\n  const handleClearCompleted = () => {\r\n    send(domain.command.ClearCompletedCommand())\r\n  }\r\n\r\n  useRemeshEvent(domain.event.AddTodoFailedEvent, (message) => {\r\n    alert(message)\r\n  })\r\n\r\n  console.log('render list')\r\n\r\n  return (\r\n    <div className=\"todoapp\">\r\n      <header className=\"header\">\r\n        <h1>todos</h1>\r\n        <input\r\n          className=\"new-todo\"\r\n          placeholder=\"What needs to be done?\"\r\n          value={newTodo}\r\n          onChange={handleTodoNameInput}\r\n          onKeyDown={handlePressEnter}\r\n        />\r\n      </header>\r\n\r\n      <section className=\"main\">\r\n        <input\r\n          id=\"toggle-all\"\r\n          type=\"checkbox\"\r\n          className=\"toggle-all\"\r\n          checked={allCompleted}\r\n          onChange={handleToggleAll}\r\n        />\r\n        <label htmlFor=\"toggle-all\" />\r\n        <ul className=\"todo-list\">\r\n          {todoList.map((todo) => (\r\n            <TodoItem key={todo.id} todo={todo} />\r\n          ))}\r\n        </ul>\r\n      </section>\r\n\r\n      <footer className=\"footer\">\r\n        <span className=\"todo-count\">\r\n          <strong>{activeTodoCount}</strong> items left\r\n        </span>\r\n        <ul className=\"filters\">\r\n          <li>\r\n            <NavLink to=\"/\" className={(navData) => (navData.isActive ? 'selected' : '')}>\r\n              All\r\n            </NavLink>\r\n          </li>\r\n          <li>\r\n            <NavLink to=\"/active\" className={(navData) => (navData.isActive ? 'selected' : '')}>\r\n              Active\r\n            </NavLink>\r\n          </li>\r\n          <li>\r\n            <NavLink to=\"/completed\" className={(navData) => (navData.isActive ? 'selected' : '')}>\r\n              Completed\r\n            </NavLink>\r\n          </li>\r\n        </ul>\r\n        {hasCompleted && (\r\n          <button className=\"clear-completed\" onClick={handleClearCompleted}>\r\n            Clear completed\r\n          </button>\r\n        )}\r\n      </footer>\r\n    </div>\r\n  )\r\n}\r\n","import localforage from 'localforage'\r\nimport type { Todo } from 'remesh-domains-for-demos/dist/todo-mvc'\r\nimport { TodoRepoExtern } from 'remesh-domains-for-demos/dist/todo-mvc/todo-repo'\r\n\r\nconst storageKey = 'todo-mvc-data'\r\nconst getTodoList = () => {\r\n  return localforage.getItem<Todo[]>(storageKey).then((value) => value ?? [])\r\n}\r\n\r\nexport const TodoRepoExternImpl = TodoRepoExtern.impl({\r\n  async getTodoList() {\r\n    return getTodoList()\r\n  },\r\n  async addTodo(todo: Todo) {\r\n    let data = await getTodoList()\r\n    await localforage.setItem(storageKey, data.concat(todo))\r\n  },\r\n  async removeTodoByIds(ids) {\r\n    let data = await getTodoList()\r\n    await localforage.setItem(\r\n      storageKey,\r\n      data.filter((item) => !ids.includes(item.id)),\r\n    )\r\n  },\r\n  async updateTodo(updateTodo) {\r\n    let data = await getTodoList()\r\n    await localforage.setItem(\r\n      storageKey,\r\n      data.map((todo) => (todo.id === updateTodo.id ? { ...todo, ...updateTodo } : todo)),\r\n    )\r\n  },\r\n\r\n  async toggleCompletedByIds(ids, completed) {\r\n    let data = await getTodoList()\r\n    await localforage.setItem(\r\n      storageKey,\r\n      data.map((todo) => (ids.includes(todo.id) ? { ...todo, completed } : todo)),\r\n    )\r\n  },\r\n})\r\n","import React, { StrictMode } from 'react'\r\nimport * as ReactDOMClient from 'react-dom/client'\r\n\r\nimport { Remesh } from 'remesh'\r\nimport { HashRouter, Routes, Route } from 'react-router-dom'\r\n\r\nimport { RemeshRoot } from 'remesh-react'\r\nimport { RemeshReduxDevtools } from 'remesh-redux-devtools'\r\nimport { RemeshLogger } from 'remesh-logger'\r\n\r\nimport { TodoList } from './TodoList'\r\nimport { TodoRepoExternImpl } from './todoRepo'\r\n\r\nconst container = document.getElementById('root')\r\n\r\nif (container) {\r\n  const root = ReactDOMClient.createRoot(container)\r\n  const store = Remesh.store({\r\n    externs: [TodoRepoExternImpl],\r\n    inspectors: [RemeshReduxDevtools(), RemeshLogger()],\r\n  })\r\n\r\n  root.render(\r\n    <StrictMode>\r\n      <RemeshRoot store={store}>\r\n        <HashRouter basename=\"/\">\r\n          <Routes>\r\n            <Route path=\"/\" element={<TodoList />} />\r\n            <Route path=\"/:filter\" element={<TodoList />} />\r\n          </Routes>\r\n        </HashRouter>\r\n      </RemeshRoot>\r\n    </StrictMode>,\r\n  )\r\n}\r\n"],"names":["tap","observerOrNext","error","complete","tapObserver","isFunction","operate","source","subscriber","_a","isUnsub","createOperatorSubscriber","value","err","_b","identity","uuid","c","r","v","TodoRepoExtern","Remesh","TodoDomain","domain","repo","TodoListState","TodoListQuery","get","status","todoList","todo","HasCompletedQuery","ActiveTodoCountQuery","AllCompletedQuery","TodoAddedEvent","SetTodoListCommand","_","AddTodoFailedEvent","AddTodoCommand","todoName","newTodo","RemoveTodoEvent","RemoveTodoCommand","id","newTodoList","TodoUpdatedEvent","UpdateTodoCommand","payload","targetTodo","TodoCompletedChangedEvent","ToggleTodoCompletedCommand","targetTodoId","eventData","ToggleAllTodoCompletedCommand","completed","ClearCompletedCommand","removedTodoIdList","from","map","todos","fromEvent","addTodo$","removeTodo$","ids","updateTodo$","toggleTodoCompleted$","merge","useInputHandler","defaultValue","setValue","useState","onChange","useCallback","event","useKeyPressHandler","key","callback","callbackRef","useRef","handleKeyPress","useEffect","TodoItem","send","useRemeshSend","useRemeshDomain","editing","setEditing","ref","handleTodoNameChange","name","handlePressEnter","command","handleEnableEdit","handleSave","handleDelete","current","focus","_jsxs","_jsx","TodoList","filter","useParams","useRemeshQuery","query","activeTodoCount","hasCompleted","allCompleted","handleTodoNameInput","setNewTodo","handleToggleAll","handleClearCompleted","message","alert","console","log","NavLink","navData","isActive","storageKey","getTodoList","localforage","TodoRepoExternImpl","data","item","updateTodo","container","document","getElementById","root","ReactDOMClient","store","externs","inspectors","RemeshReduxDevtools","RemeshLogger","render","StrictMode","RemeshRoot","HashRouter","Routes","Route"],"mappings":"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"}