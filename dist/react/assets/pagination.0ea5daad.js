var R=Object.defineProperty,C=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var $=(e,t,s)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,E=(e,t)=>{for(var s in t||(t={}))O.call(t,s)&&$(e,s,t[s]);if(q)for(var s of q(t))W.call(t,s)&&$(e,s,t[s]);return e},x=(e,t)=>C(e,T(t));import{f as I,u as D,b as z,R as Y}from"./remesh-logger.2c0a612e.js";import{s as B}from"./switchMap.4481dadd.js";import{m as G}from"./merge.38fc1122.js";import{b as U}from"./mergeAll.37e67598.js";import{o as H,c as F,i as P,m as J}from"./map.105726f2.js";import{j as w,a as l,F as K}from"./jsx-runtime.a8396eb8.js";function Z(e,t){return I(t)?U(e,t,1):U(e,1)}function N(e,t){return t?function(s){return s.pipe(N(function(r,c){return P(e(r,c)).pipe(J(function(o,a){return t(r,o,c,a)}))}))}:H(function(s,r){var c=0,o=null,a=!1;s.subscribe(F(r,function(v){o||(o=F(r,void 0,function(){o=null,a&&r.complete()}),P(e(v,c++)).subscribe(o))},function(){a=!0,!o&&r.complete()}))})}const f={default:()=>({type:"default"}),loading:e=>({type:"loading",promise:e}),success:e=>({type:"success",promise:Promise.resolve(e),value:e}),failed:e=>({type:"failed",promise:Promise.reject(e),error:e}),isDefault:e=>e.type==="default",isLoading:e=>e.type==="loading",isSuccess:e=>e.type==="success",isFailed:e=>e.type==="failed",assertDefault:e=>{if(e.type!=="default")throw new Error(`Expected async data in default phase, but got '${e.type}'`)},assertLoading:e=>{if(e.type!=="loading")throw new Error(`Expected async data in loading phase, but got '${e.type}'`)},assertSuccess:e=>{if(e.type!=="success")throw new Error(`Expected async data in success phase, but got '${e.type}'`)},assertFailed:e=>{if(e.type!=="failed")throw new Error(`Expected async data in failed phase, but got '${e.type}'`)}},ee=(e,t)=>{const s="default"in t&&t.default?t.default:f.default(),r=e.state({name:`${t.name}.AsyncState`,default:s}),c=e.query({name:`${t.name}.isType`,inspectable:!1,impl:({get:u},i)=>u(r()).type===i}),o=e.query({name:`${t.name}.isDefault`,impl:({get:u})=>u(c("default"))}),a=e.query({name:`${t.name}.isLoading`,impl:({get:u})=>u(c("loading"))}),v=e.query({name:`${t.name}.isSuccess`,impl:({get:u})=>u(c("success"))}),j=e.query({name:`${t.name}.isFailed`,impl:({get:u})=>u(c("failed"))}),n=e.event({name:`${t.name}.LoadingEvent`}),p=e.event({name:`${t.name}.SuccessEvent`}),m=e.event({name:`${t.name}.FailedEvent`}),d=(u,i)=>{var g,b,_;if(i.type==="loading")return[r().new(i),n(),(g=t.command)==null?void 0:g.call(t,u,i)];if(i.type==="success")return[r().new(i),p(i.value),(b=t.command)==null?void 0:b.call(t,u,i)];if(i.type==="failed")return[r().new(i),m(i.error),(_=t.command)==null?void 0:_.call(t,u,i)];throw new Error(`Unknown async data: ${i}`)},k=e.command$({name:`${t.name}.load`,impl:({get:u,peek:i},g)=>{const b={get:u,peek:i},_=h=>{const S=t.query(b,h),X=S.then(y=>{const L=f.success(y);return d(b,L)},y=>{const L=f.failed(y instanceof Error?y:new Error(`${y}`));return d(b,L)}),A=d(b,f.loading(S));return G(A,X)};if(!t.mode||t.mode==="switch")return g.pipe(B(h=>_(h)));if(t.mode==="concat")return g.pipe(Z(h=>_(h)));if(t.mode==="merge")return g.pipe(U(h=>_(h)));if(t.mode==="exhaust")return g.pipe(N(h=>_(h)));throw new Error(`RemeshAsyncModule: invalid mode: ${t.mode}`)}});return{query:{asyncState:r.query,isDefault:o,isLoading:a,isSuccess:v,isFailed:j},command:{load:k},event:{LoadingEvent:n,SuccessEvent:p,FailedEvent:m}}},te=e=>new Promise(t=>setTimeout(t,e)),se=[{login:"mojombo",id:1,node_id:"MDQ6VXNlcjE=",avatar_url:"https://avatars.githubusercontent.com/u/1?v=4",gravatar_id:"",url:"https://api.github.com/users/mojombo",html_url:"https://github.com/mojombo",followers_url:"https://api.github.com/users/mojombo/followers",following_url:"https://api.github.com/users/mojombo/following{/other_user}",gists_url:"https://api.github.com/users/mojombo/gists{/gist_id}",starred_url:"https://api.github.com/users/mojombo/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/mojombo/subscriptions",organizations_url:"https://api.github.com/users/mojombo/orgs",repos_url:"https://api.github.com/users/mojombo/repos",events_url:"https://api.github.com/users/mojombo/events{/privacy}",received_events_url:"https://api.github.com/users/mojombo/received_events",type:"User",site_admin:!1},{login:"defunkt",id:2,node_id:"MDQ6VXNlcjI=",avatar_url:"https://avatars.githubusercontent.com/u/2?v=4",gravatar_id:"",url:"https://api.github.com/users/defunkt",html_url:"https://github.com/defunkt",followers_url:"https://api.github.com/users/defunkt/followers",following_url:"https://api.github.com/users/defunkt/following{/other_user}",gists_url:"https://api.github.com/users/defunkt/gists{/gist_id}",starred_url:"https://api.github.com/users/defunkt/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/defunkt/subscriptions",organizations_url:"https://api.github.com/users/defunkt/orgs",repos_url:"https://api.github.com/users/defunkt/repos",events_url:"https://api.github.com/users/defunkt/events{/privacy}",received_events_url:"https://api.github.com/users/defunkt/received_events",type:"User",site_admin:!1},{login:"pjhyett",id:3,node_id:"MDQ6VXNlcjM=",avatar_url:"https://avatars.githubusercontent.com/u/3?v=4",gravatar_id:"",url:"https://api.github.com/users/pjhyett",html_url:"https://github.com/pjhyett",followers_url:"https://api.github.com/users/pjhyett/followers",following_url:"https://api.github.com/users/pjhyett/following{/other_user}",gists_url:"https://api.github.com/users/pjhyett/gists{/gist_id}",starred_url:"https://api.github.com/users/pjhyett/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/pjhyett/subscriptions",organizations_url:"https://api.github.com/users/pjhyett/orgs",repos_url:"https://api.github.com/users/pjhyett/repos",events_url:"https://api.github.com/users/pjhyett/events{/privacy}",received_events_url:"https://api.github.com/users/pjhyett/received_events",type:"User",site_admin:!1},{login:"wycats",id:4,node_id:"MDQ6VXNlcjQ=",avatar_url:"https://avatars.githubusercontent.com/u/4?v=4",gravatar_id:"",url:"https://api.github.com/users/wycats",html_url:"https://github.com/wycats",followers_url:"https://api.github.com/users/wycats/followers",following_url:"https://api.github.com/users/wycats/following{/other_user}",gists_url:"https://api.github.com/users/wycats/gists{/gist_id}",starred_url:"https://api.github.com/users/wycats/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/wycats/subscriptions",organizations_url:"https://api.github.com/users/wycats/orgs",repos_url:"https://api.github.com/users/wycats/repos",events_url:"https://api.github.com/users/wycats/events{/privacy}",received_events_url:"https://api.github.com/users/wycats/received_events",type:"User",site_admin:!1},{login:"ezmobius",id:5,node_id:"MDQ6VXNlcjU=",avatar_url:"https://avatars.githubusercontent.com/u/5?v=4",gravatar_id:"",url:"https://api.github.com/users/ezmobius",html_url:"https://github.com/ezmobius",followers_url:"https://api.github.com/users/ezmobius/followers",following_url:"https://api.github.com/users/ezmobius/following{/other_user}",gists_url:"https://api.github.com/users/ezmobius/gists{/gist_id}",starred_url:"https://api.github.com/users/ezmobius/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/ezmobius/subscriptions",organizations_url:"https://api.github.com/users/ezmobius/orgs",repos_url:"https://api.github.com/users/ezmobius/repos",events_url:"https://api.github.com/users/ezmobius/events{/privacy}",received_events_url:"https://api.github.com/users/ezmobius/received_events",type:"User",site_admin:!1},{login:"ivey",id:6,node_id:"MDQ6VXNlcjY=",avatar_url:"https://avatars.githubusercontent.com/u/6?v=4",gravatar_id:"",url:"https://api.github.com/users/ivey",html_url:"https://github.com/ivey",followers_url:"https://api.github.com/users/ivey/followers",following_url:"https://api.github.com/users/ivey/following{/other_user}",gists_url:"https://api.github.com/users/ivey/gists{/gist_id}",starred_url:"https://api.github.com/users/ivey/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/ivey/subscriptions",organizations_url:"https://api.github.com/users/ivey/orgs",repos_url:"https://api.github.com/users/ivey/repos",events_url:"https://api.github.com/users/ivey/events{/privacy}",received_events_url:"https://api.github.com/users/ivey/received_events",type:"User",site_admin:!1},{login:"evanphx",id:7,node_id:"MDQ6VXNlcjc=",avatar_url:"https://avatars.githubusercontent.com/u/7?v=4",gravatar_id:"",url:"https://api.github.com/users/evanphx",html_url:"https://github.com/evanphx",followers_url:"https://api.github.com/users/evanphx/followers",following_url:"https://api.github.com/users/evanphx/following{/other_user}",gists_url:"https://api.github.com/users/evanphx/gists{/gist_id}",starred_url:"https://api.github.com/users/evanphx/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/evanphx/subscriptions",organizations_url:"https://api.github.com/users/evanphx/orgs",repos_url:"https://api.github.com/users/evanphx/repos",events_url:"https://api.github.com/users/evanphx/events{/privacy}",received_events_url:"https://api.github.com/users/evanphx/received_events",type:"User",site_admin:!1},{login:"vanpelt",id:17,node_id:"MDQ6VXNlcjE3",avatar_url:"https://avatars.githubusercontent.com/u/17?v=4",gravatar_id:"",url:"https://api.github.com/users/vanpelt",html_url:"https://github.com/vanpelt",followers_url:"https://api.github.com/users/vanpelt/followers",following_url:"https://api.github.com/users/vanpelt/following{/other_user}",gists_url:"https://api.github.com/users/vanpelt/gists{/gist_id}",starred_url:"https://api.github.com/users/vanpelt/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/vanpelt/subscriptions",organizations_url:"https://api.github.com/users/vanpelt/orgs",repos_url:"https://api.github.com/users/vanpelt/repos",events_url:"https://api.github.com/users/vanpelt/events{/privacy}",received_events_url:"https://api.github.com/users/vanpelt/received_events",type:"User",site_admin:!1},{login:"wayneeseguin",id:18,node_id:"MDQ6VXNlcjE4",avatar_url:"https://avatars.githubusercontent.com/u/18?v=4",gravatar_id:"",url:"https://api.github.com/users/wayneeseguin",html_url:"https://github.com/wayneeseguin",followers_url:"https://api.github.com/users/wayneeseguin/followers",following_url:"https://api.github.com/users/wayneeseguin/following{/other_user}",gists_url:"https://api.github.com/users/wayneeseguin/gists{/gist_id}",starred_url:"https://api.github.com/users/wayneeseguin/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/wayneeseguin/subscriptions",organizations_url:"https://api.github.com/users/wayneeseguin/orgs",repos_url:"https://api.github.com/users/wayneeseguin/repos",events_url:"https://api.github.com/users/wayneeseguin/events{/privacy}",received_events_url:"https://api.github.com/users/wayneeseguin/received_events",type:"User",site_admin:!1},{login:"brynary",id:19,node_id:"MDQ6VXNlcjE5",avatar_url:"https://avatars.githubusercontent.com/u/19?v=4",gravatar_id:"",url:"https://api.github.com/users/brynary",html_url:"https://github.com/brynary",followers_url:"https://api.github.com/users/brynary/followers",following_url:"https://api.github.com/users/brynary/following{/other_user}",gists_url:"https://api.github.com/users/brynary/gists{/gist_id}",starred_url:"https://api.github.com/users/brynary/starred{/owner}{/repo}",subscriptions_url:"https://api.github.com/users/brynary/subscriptions",organizations_url:"https://api.github.com/users/brynary/orgs",repos_url:"https://api.github.com/users/brynary/repos",events_url:"https://api.github.com/users/brynary/events{/privacy}",received_events_url:"https://api.github.com/users/brynary/received_events",type:"User",site_admin:!1}];let re=1e6;const Q=async e=>(await te(500),se.map(t=>x(E({},t),{id:re++})));let V=!1;const ie=async e=>{if(V)return Q();try{const t=await fetch(`https://api.github.com/users?since=${e.offset}&per_page=${e.pageSize}`);if(!t.ok)throw new Error(t.statusText);return await t.json()}catch{return V=!0,Q()}},M=Y.domain({name:"pagination",impl:e=>{const t={offset:0,pageSize:10},s=e.state({name:"Pagination",default:t}),r=e.state({name:"UserListState",default:[]}),c=e.query({name:"isEmptyUserList",impl:({get:n})=>n(r()).length===0}),o=e.query({name:"NextPaginationQuery",impl:({get:n})=>{const p=n(s()),m=n(r());if(m.length===0)return p;const d=m[m.length-1];return x(E({},p),{offset:d.id+1})}}),a=ee(e,{name:"userFetcher",query:async({},n)=>await ie(n),command:({get:n},p)=>{if(!f.isSuccess(p))return null;const m=n(o()),d=n(r());return[s().new(m),r().new(d.concat(p.value))]}});e.ignite(()=>a.command.load(t));const v=e.command({name:"loadMore",impl:({get:n})=>{const p=n(o());return a.command.load(p)}}),j=e.command({name:"reset",impl:({})=>[s().new(t),r().new([]),v()]});return{query:{userList:r.query,isEmptyUserList:c,isLoading:a.query.isLoading,asyncState:a.query.asyncState},command:{loadMore:v,reset:j},event:{LoadingUsersEvent:a.event.LoadingEvent,SuccessToLoadUsersEvent:a.event.SuccessEvent,FailedToLoadUsersEvent:a.event.FailedEvent}}}});var ge=()=>{const e=D(M()),t=z(e.query.isEmptyUserList());return w("div",{children:[l("h2",{children:"Pagination"}),t?"loading...":l(ue,{})]})};const ue=()=>{const e=D(M()),t=z(e.query.isLoading());return w(K,{children:[l("div",{children:l("button",{onClick:()=>{e.command.reset()},children:"reset"})}),l(ae,{}),w("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:[!t&&l("button",{onClick:()=>{e.command.loadMore()},children:"load more"}),t&&"loading..."]})]})},ae=()=>{const e=D(M()),t=z(e.query.userList());return l("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:t.map(s=>w("div",{style:{width:100,margin:10},children:[l("img",{style:{width:100,height:100},src:s.avatar_url,loading:"lazy"}),l("p",{children:l("a",{href:s.html_url,children:s.login})})]},s.id))})};export{ge as default};
//# sourceMappingURL=pagination.0ea5daad.js.map
