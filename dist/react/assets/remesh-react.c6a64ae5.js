import{r as E,a as N,j as tr,F as ye}from"./jsx-runtime.cdcfec5f.js";var We=function(r,t,o,s){var a=o?o.call(s,r,t):void 0;if(a!==void 0)return!!a;if(r===t)return!0;if(typeof r!="object"||!r||typeof t!="object"||!t)return!1;var c=Object.keys(r),d=Object.keys(t);if(c.length!==d.length)return!1;for(var p=Object.prototype.hasOwnProperty.bind(t),l=0;l<c.length;l++){var y=c[l];if(!p(y))return!1;var v=r[y],S=t[y];if(a=o?o.call(s,v,S,y):void 0,a===!1||a===void 0&&v!==S)return!1}return!0};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function $e(e){return Object.prototype.toString.call(e)==="[object Object]"}function Fe(e){var r,t;return $e(e)===!1?!1:(r=e.constructor,r===void 0?!0:(t=r.prototype,!($e(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}let rr=0;function Xe(e){var o;const r=rr++,t=s=>({type:"RemeshEventAction",arg:s,Event:t});return t.type="RemeshEvent",t.eventId=r,t.eventName=e.name,t.owner=ee(),t.inspectable="inspectable"in e&&(o=e.inspectable)!=null?o:!0,t.toSubscribeOnlyEvent=()=>Be(t),"impl"in e&&(t.impl=e.impl),t}const Ne=new WeakMap,Ze=new WeakMap,Be=e=>{const r=Ne.get(e);if(r)return r;const t={type:"RemeshSubscribeOnlyEvent",eventId:e.eventId,eventName:e.eventName};return Ne.set(e,t),Ze.set(t,e),t},ze=e=>{const r=Ze.get(e);if(r)return r;throw new Error(`SubscribeOnlyEvent ${e.eventName} does not have an associated Event`)},le=Symbol("DefaultStateValue");let nr=0;const Ae=(e,r)=>Fe(e)&&Fe(r)||Array.isArray(e)&&Array.isArray(r)?We(e,r):e===r,qe=e=>{var s,a;const r=nr++;let t=null;const o=()=>{if(t)return t;const c={type:"RemeshStateItem",State:o,new:d=>({type:"RemeshStateItemUpdatePayload",value:d,stateItem:c})};return t=c,c};return o.type="RemeshState",o.stateId=r,o.stateName=e.name,"default"in e?o.default=e.default:e.defer&&(o.default=le),o.compare=(s=e.compare)!=null?s:Ae,o.owner=ee(),o.inspectable=(a=e.inspectable)!=null?a:!0,o};let or=0;const et=e=>{var s,a;const r=or++;let t=null;const o=c=>{if(c===void 0&&t)return t;const d={type:"RemeshQueryAction",Query:o,arg:c};return c===void 0&&(t=d),d};return o.type="RemeshQuery",o.queryId=r,o.queryName=e.name,o.impl=e.impl,o.compare=(s=e.compare)!=null?s:Ae,o.owner=ee(),o.inspectable=(a=e.inspectable)!=null?a:!0,o.onError=e.onError,o};let sr=0;const P={before:new WeakMap,after:new WeakMap},Ke=(e,r)=>P[r].get(e),tt=e=>{var o;const r=sr++,t=s=>({type:"RemeshCommandAction",arg:s,Command:t});return t.type="RemeshCommand",t.commandId=r,t.commandName=e.name,t.impl=e.impl,t.owner=ee(),t.inspectable=(o=e.inspectable)!=null?o:!0,t.before=s=>{if(P.before.has(t))return P.before.get(t).add(s);const a=new Set;return P.before.set(t,a),a.add(s),a},t.after=s=>{if(P.after.has(t))return P.after.get(t).add(s);const a=new Set;return P.after.set(t,a),a.add(s),a},t};let ar=0;const ir=e=>{const r={type:"RemeshExtern",externId:ar++,default:e.default,impl:t=>({type:"RemeshExternImpl",Extern:r,value:t})};return r},rt=e=>{const r={};if(e.event){const t={};for(const o in e.event){const s=e.event[o];s.type==="RemeshSubscribeOnlyEvent"?t[o]=s:t[o]=Be(s)}r.event=t}return e.query&&(r.query=e.query),e.command&&(r.command=e.command),r},cr=e=>rt(e);let ur=0;const ve=e=>{var o;let r=null;const t=s=>{if(s===void 0&&r)return r;const a={type:"RemeshDomainAction",Domain:t,arg:s};return s===void 0&&(r=a),a};return t.type="RemeshDomain",t.domainId=ur++,t.domainName=e.name,t.impl=e.impl,t.inspectable=(o=e.inspectable)!=null?o:!0,t},ee=ve({name:"DefaultDomain",impl:()=>({})});var de=function(e,r){return de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},de(e,r)};function z(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");de(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}function fr(e,r,t,o){function s(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function d(y){try{l(o.next(y))}catch(v){c(v)}}function p(y){try{l(o.throw(y))}catch(v){c(v)}}function l(y){y.done?a(y.value):s(y.value).then(d,p)}l((o=o.apply(e,r||[])).next())})}function nt(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,s,a,c;return c={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(l){return function(y){return p([l,y])}}function p(l){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,s&&(a=l[0]&2?s.return:l[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,l[1])).done)return a;switch(s=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(y){l=[6,y],s=0}finally{o=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function j(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],o=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),s,a=[],c;try{for(;(r===void 0||r-- >0)&&!(s=o.next()).done;)a.push(s.value)}catch(d){c={error:d}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(c)throw c.error}}return a}function q(e,r,t){if(t||arguments.length===2)for(var o=0,s=r.length,a;o<s;o++)(a||!(o in r))&&(a||(a=Array.prototype.slice.call(r,0,o)),a[o]=r[o]);return e.concat(a||Array.prototype.slice.call(r))}function U(e){return this instanceof U?(this.v=e,this):new U(e)}function lr(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=t.apply(e,r||[]),s,a=[];return s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s;function c(S){o[S]&&(s[S]=function(x){return new Promise(function(M,C){a.push([S,x,M,C])>1||d(S,x)})})}function d(S,x){try{p(o[S](x))}catch(M){v(a[0][3],M)}}function p(S){S.value instanceof U?Promise.resolve(S.value.v).then(l,y):v(a[0][2],S)}function l(S){d("next",S)}function y(S){d("throw",S)}function v(S,x){S(x),a.shift(),a.length&&d(a[0][0],a[0][1])}}function dr(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],t;return r?r.call(e):(e=typeof j=="function"?j(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(a){t[a]=e[a]&&function(c){return new Promise(function(d,p){c=e[a](c),s(d,p,c.done,c.value)})}}function s(a,c,d,p){Promise.resolve(p).then(function(l){a({value:l,done:d})},c)}}function R(e){return typeof e=="function"}function ot(e){var r=function(o){Error.call(o),o.stack=new Error().stack},t=e(r);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ce=ot(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(o,s){return s+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function me(e,r){if(e){var t=e.indexOf(r);0<=t&&e.splice(t,1)}}var K=function(){function e(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var r,t,o,s,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var d=j(c),p=d.next();!p.done;p=d.next()){var l=p.value;l.remove(this)}}catch(C){r={error:C}}finally{try{p&&!p.done&&(t=d.return)&&t.call(d)}finally{if(r)throw r.error}}else c.remove(this);var y=this.initialTeardown;if(R(y))try{y()}catch(C){a=C instanceof ce?C.errors:[C]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var S=j(v),x=S.next();!x.done;x=S.next()){var M=x.value;try{Ye(M)}catch(C){a=a!=null?a:[],C instanceof ce?a=q(q([],A(a)),A(C.errors)):a.push(C)}}}catch(C){o={error:C}}finally{try{x&&!x.done&&(s=S.return)&&s.call(S)}finally{if(o)throw o.error}}}if(a)throw new ce(a)}},e.prototype.add=function(r){var t;if(r&&r!==this)if(this.closed)Ye(r);else{if(r instanceof e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(r)}},e.prototype._hasParent=function(r){var t=this._parentage;return t===r||Array.isArray(t)&&t.includes(r)},e.prototype._addParent=function(r){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(r),t):t?[t,r]:r},e.prototype._removeParent=function(r){var t=this._parentage;t===r?this._parentage=null:Array.isArray(t)&&me(t,r)},e.prototype.remove=function(r){var t=this._finalizers;t&&me(t,r),r instanceof e&&r._removeParent(this)},e.EMPTY=function(){var r=new e;return r.closed=!0,r}(),e}(),st=K.EMPTY;function at(e){return e instanceof K||e&&"closed"in e&&R(e.remove)&&R(e.add)&&R(e.unsubscribe)}function Ye(e){R(e)?e():e.unsubscribe()}var te={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pe={setTimeout:function(e,r){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var s=pe.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,q([e,r],A(t))):setTimeout.apply(void 0,q([e,r],A(t)))},clearTimeout:function(e){var r=pe.delegate;return((r==null?void 0:r.clearTimeout)||clearTimeout)(e)},delegate:void 0};function it(e){pe.setTimeout(function(){var r=te.onUnhandledError;if(r)r(e);else throw e})}function He(){}var J=null;function Z(e){if(te.useDeprecatedSynchronousErrorHandling){var r=!J;if(r&&(J={errorThrown:!1,error:null}),e(),r){var t=J,o=t.errorThrown,s=t.error;if(J=null,o)throw s}}else e()}var Se=function(e){z(r,e);function r(t){var o=e.call(this)||this;return o.isStopped=!1,t?(o.destination=t,at(t)&&t.add(o)):o.destination=yr,o}return r.create=function(t,o,s){return new he(t,o,s)},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(K),mr=Function.prototype.bind;function ue(e,r){return mr.call(e,r)}var pr=function(){function e(r){this.partialObserver=r}return e.prototype.next=function(r){var t=this.partialObserver;if(t.next)try{t.next(r)}catch(o){X(o)}},e.prototype.error=function(r){var t=this.partialObserver;if(t.error)try{t.error(r)}catch(o){X(o)}else X(r)},e.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(t){X(t)}},e}(),he=function(e){z(r,e);function r(t,o,s){var a=e.call(this)||this,c;if(R(t)||!t)c={next:t!=null?t:void 0,error:o!=null?o:void 0,complete:s!=null?s:void 0};else{var d;a&&te.useDeprecatedNextContext?(d=Object.create(t),d.unsubscribe=function(){return a.unsubscribe()},c={next:t.next&&ue(t.next,d),error:t.error&&ue(t.error,d),complete:t.complete&&ue(t.complete,d)}):c=t}return a.destination=new pr(c),a}return r}(Se);function X(e){it(e)}function hr(e){throw e}var yr={closed:!0,next:He,error:hr,complete:He},be=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function vr(e){return e}function Sr(e){return e.length===0?vr:e.length===1?e[0]:function(t){return e.reduce(function(o,s){return s(o)},t)}}var I=function(){function e(r){r&&(this._subscribe=r)}return e.prototype.lift=function(r){var t=new e;return t.source=this,t.operator=r,t},e.prototype.subscribe=function(r,t,o){var s=this,a=gr(r)?r:new he(r,t,o);return Z(function(){var c=s,d=c.operator,p=c.source;a.add(d?d.call(a,p):p?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(t){r.error(t)}},e.prototype.forEach=function(r,t){var o=this;return t=Ge(t),new t(function(s,a){var c=new he({next:function(d){try{r(d)}catch(p){a(p),c.unsubscribe()}},error:a,complete:s});o.subscribe(c)})},e.prototype._subscribe=function(r){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(r)},e.prototype[be]=function(){return this},e.prototype.pipe=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return Sr(r)(this)},e.prototype.toPromise=function(r){var t=this;return r=Ge(r),new r(function(o,s){var a;t.subscribe(function(c){return a=c},function(c){return s(c)},function(){return o(a)})})},e.create=function(r){return new e(r)},e}();function Ge(e){var r;return(r=e!=null?e:te.Promise)!==null&&r!==void 0?r:Promise}function br(e){return e&&R(e.next)&&R(e.error)&&R(e.complete)}function gr(e){return e&&e instanceof Se||br(e)&&at(e)}function wr(e){return R(e==null?void 0:e.lift)}function ge(e){return function(r){if(wr(r))return r.lift(function(t){try{return e(t,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function ct(e,r,t,o,s){return new Er(e,r,t,o,s)}var Er=function(e){z(r,e);function r(t,o,s,a,c,d){var p=e.call(this,t)||this;return p.onFinalize=c,p.shouldUnsubscribe=d,p._next=o?function(l){try{o(l)}catch(y){t.error(y)}}:e.prototype._next,p._error=a?function(l){try{a(l)}catch(y){t.error(y)}finally{this.unsubscribe()}}:e.prototype._error,p._complete=s?function(){try{s()}catch(l){t.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,p}return r.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var o=this.closed;e.prototype.unsubscribe.call(this),!o&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},r}(Se),Rr=ot(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),B=function(e){z(r,e);function r(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.prototype.lift=function(t){var o=new Je(this,this);return o.operator=t,o},r.prototype._throwIfClosed=function(){if(this.closed)throw new Rr},r.prototype.next=function(t){var o=this;Z(function(){var s,a;if(o._throwIfClosed(),!o.isStopped){o.currentObservers||(o.currentObservers=Array.from(o.observers));try{for(var c=j(o.currentObservers),d=c.next();!d.done;d=c.next()){var p=d.value;p.next(t)}}catch(l){s={error:l}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}}})},r.prototype.error=function(t){var o=this;Z(function(){if(o._throwIfClosed(),!o.isStopped){o.hasError=o.isStopped=!0,o.thrownError=t;for(var s=o.observers;s.length;)s.shift().error(t)}})},r.prototype.complete=function(){var t=this;Z(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var o=t.observers;o.length;)o.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},r.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},r.prototype._innerSubscribe=function(t){var o=this,s=this,a=s.hasError,c=s.isStopped,d=s.observers;return a||c?st:(this.currentObservers=null,d.push(t),new K(function(){o.currentObservers=null,me(d,t)}))},r.prototype._checkFinalizedStatuses=function(t){var o=this,s=o.hasError,a=o.thrownError,c=o.isStopped;s?t.error(a):c&&t.complete()},r.prototype.asObservable=function(){var t=new I;return t.source=this,t},r.create=function(t,o){return new Je(t,o)},r}(I),Je=function(e){z(r,e);function r(t,o){var s=e.call(this)||this;return s.destination=t,s.source=o,s}return r.prototype.next=function(t){var o,s;(s=(o=this.destination)===null||o===void 0?void 0:o.next)===null||s===void 0||s.call(o,t)},r.prototype.error=function(t){var o,s;(s=(o=this.destination)===null||o===void 0?void 0:o.error)===null||s===void 0||s.call(o,t)},r.prototype.complete=function(){var t,o;(o=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||o===void 0||o.call(t)},r.prototype._subscribe=function(t){var o,s;return(s=(o=this.source)===null||o===void 0?void 0:o.subscribe(t))!==null&&s!==void 0?s:st},r}(B),ut=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function ft(e){return R(e==null?void 0:e.then)}function lt(e){return R(e[be])}function dt(e){return Symbol.asyncIterator&&R(e==null?void 0:e[Symbol.asyncIterator])}function mt(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function xr(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var pt=xr();function ht(e){return R(e==null?void 0:e[pt])}function yt(e){return lr(this,arguments,function(){var t,o,s,a;return nt(this,function(c){switch(c.label){case 0:t=e.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,U(t.read())];case 3:return o=c.sent(),s=o.value,a=o.done,a?[4,U(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,U(s)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function vt(e){return R(e==null?void 0:e.getReader)}function we(e){if(e instanceof I)return e;if(e!=null){if(lt(e))return Cr(e);if(ut(e))return Dr(e);if(ft(e))return Or(e);if(dt(e))return St(e);if(ht(e))return Ir(e);if(vt(e))return kr(e)}throw mt(e)}function Cr(e){return new I(function(r){var t=e[be]();if(R(t.subscribe))return t.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Dr(e){return new I(function(r){for(var t=0;t<e.length&&!r.closed;t++)r.next(e[t]);r.complete()})}function Or(e){return new I(function(r){e.then(function(t){r.closed||(r.next(t),r.complete())},function(t){return r.error(t)}).then(null,it)})}function Ir(e){return new I(function(r){var t,o;try{for(var s=j(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(r.next(c),r.closed)return}}catch(d){t={error:d}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}r.complete()})}function St(e){return new I(function(r){Qr(e,r).catch(function(t){return r.error(t)})})}function kr(e){return St(yt(e))}function Qr(e,r){var t,o,s,a;return fr(this,void 0,void 0,function(){var c,d;return nt(this,function(p){switch(p.label){case 0:p.trys.push([0,5,6,11]),t=dr(e),p.label=1;case 1:return[4,t.next()];case 2:if(o=p.sent(),!!o.done)return[3,4];if(c=o.value,r.next(c),r.closed)return[2];p.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return d=p.sent(),s={error:d},[3,11];case 6:return p.trys.push([6,,9,10]),o&&!o.done&&(a=t.return)?[4,a.call(t)]:[3,8];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function _(e,r,t,o,s){o===void 0&&(o=0),s===void 0&&(s=!1);var a=r.schedule(function(){t(),s?e.add(this.schedule(null,o)):this.unsubscribe()},o);if(e.add(a),!s)return a}function bt(e,r){return r===void 0&&(r=0),ge(function(t,o){t.subscribe(ct(o,function(s){return _(o,e,function(){return o.next(s)},r)},function(){return _(o,e,function(){return o.complete()},r)},function(s){return _(o,e,function(){return o.error(s)},r)}))})}function gt(e,r){return r===void 0&&(r=0),ge(function(t,o){o.add(e.schedule(function(){return t.subscribe(o)},r))})}function Mr(e,r){return we(e).pipe(gt(r),bt(r))}function Pr(e,r){return we(e).pipe(gt(r),bt(r))}function _r(e,r){return new I(function(t){var o=0;return r.schedule(function(){o===e.length?t.complete():(t.next(e[o++]),t.closed||this.schedule())})})}function Ur(e,r){return new I(function(t){var o;return _(t,r,function(){o=e[pt](),_(t,r,function(){var s,a,c;try{s=o.next(),a=s.value,c=s.done}catch(d){t.error(d);return}c?t.complete():t.next(a)},0,!0)}),function(){return R(o==null?void 0:o.return)&&o.return()}})}function wt(e,r){if(!e)throw new Error("Iterable cannot be null");return new I(function(t){_(t,r,function(){var o=e[Symbol.asyncIterator]();_(t,r,function(){o.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function jr(e,r){return wt(yt(e),r)}function Tr(e,r){if(e!=null){if(lt(e))return Mr(e,r);if(ut(e))return _r(e,r);if(ft(e))return Pr(e,r);if(dt(e))return wt(e,r);if(ht(e))return Ur(e,r);if(vt(e))return jr(e,r)}throw mt(e)}function Vr(e,r){return r?Tr(e,r):we(e)}function Lr(e,r){return ge(function(t,o){var s=0;t.subscribe(ct(o,function(a){o.next(e.call(r,a,s++))}))})}const O={DomainCreated:"Domain::Created",DomainDiscarded:"Domain::Discarded",DomainReused:"Domain::Reused",StateCreated:"State::Created",StateUpdated:"State::Updated",StateDiscarded:"State::Discarded",StateReused:"State::Reused",QueryCreated:"Query::Created",QueryUpdated:"Query::Updated",QueryDiscarded:"Query::Discarded",QueryReused:"Query::Reused",EventEmitted:"Event::Emitted",CommandReceived:"Command::Received"},W=ve({name:"RemeshInspectorDomain",impl:e=>{const r=e.event({name:"RemeshDomainStorageEvent"}),t=e.command({name:"RemeshDomainStorageCommand",impl:({},v)=>r(v)}),o=e.event({name:"RemeshStateStorageEvent"}),s=e.command({name:"RemeshStateStorageCommand",impl:({},v)=>o(v)}),a=e.event({name:"RemeshQueryStorageEvent"}),c=e.command({name:"RemeshQueryStorageCommand",impl:({},v)=>a(v)}),d=e.event({name:"RemeshEventEmittedEvent"}),p=e.command({name:"RemeshEventEmittedCommand",impl:({},v)=>d(v)}),l=e.event({name:"RemeshCommandReceivedEvent"}),y=e.command({name:"RemeshCommandReceivedCommand",impl:({},v)=>l(v)});return{command:{RemeshDomainStorageCommand:t,RemeshStateStorageCommand:s,RemeshQueryStorageCommand:c,RemeshEventEmittedCommand:p,RemeshCommandReceivedCommand:y},event:{RemeshDomainStorageEvent:r,RemeshStateStorageEvent:o,RemeshQueryStorageEvent:a,RemeshEventEmittedEvent:d,RemeshCommandReceivedEvent:l}}}}),$=e=>e.owner?e.owner.Domain.inspectable&&e.inspectable:e.inspectable,Wr=e=>{var r;return((r=e.inspectors)!=null?r:[]).filter(t=>!!t).map(t=>{const{inspectors:o,...s}=e;return t(s)})},$r=e=>{let r=null;const t=()=>(r||(r=Wr(e)),r);return{destroyInspectors:()=>{if(r){for(const l of r)l.discard();r=null}},inspectDomainStorage:(l,y)=>{if($(y.Domain))for(const v of t()){const S=v.getDomain(W());v.send(S.command.RemeshDomainStorageCommand({type:l,storage:y}))}},inspectStateStorage:(l,y)=>{if($(y.State))for(const v of t()){const S=v.getDomain(W());v.send(S.command.RemeshStateStorageCommand({type:l,storage:y}))}},inspectQueryStorage:(l,y)=>{if($(y.Query))for(const v of t()){const S=v.getDomain(W());v.send(S.command.RemeshQueryStorageCommand({type:l,storage:y}))}},inspectEventEmitted:(l,y)=>{if($(y.Event))for(const v of t()){const S=v.getDomain(W());v.send(S.command.RemeshEventEmittedCommand({type:l,action:y}))}},inspectCommandReceived:(l,y)=>{if($(y.Command))for(const v of t()){const S=v.getDomain(W());v.send(S.command.RemeshCommandReceivedCommand({type:l,action:y}))}}}};let F=0;const Et=e=>{const r={...e},t=$r(r),o=new Set,s=new Set,a=new Set,c=new Map,d=new WeakMap,p=n=>{var i;for(const u of(i=r.externs)!=null?i:[])if(u.Extern===n)return u.value;return n.default},l=n=>{const i=d.get(n);if(i)return i;const u=p(n),f={id:F++,type:"RemeshExternStorage",Extern:n,currentValue:u};return d.set(n,f),f},y=n=>l(n).currentValue,v=new WeakMap,S=n=>{var g;const i=v.get(n);if(i)return i;const u=n.Query.queryName,f=(g=JSON.stringify(n.arg))!=null?g:"",h=`Query/${n.Query.queryId}/${u}:${f}`;return v.set(n,h),h},x=n=>{var g;const i=v.get(n);if(i)return i;const u=n.Domain.domainName,f=(g=JSON.stringify(n.arg))!=null?g:"",h=`Domain/${n.Domain.domainId}/${u}:${f}`;return v.set(n,h),h},M=n=>n.type==="RemeshQueryAction"?S(n):x(n),C=new WeakMap,Ee=n=>typeof n.default=="function"?n.default():n.default,Dt=n=>{const i=w(n.State.owner),u=Ee(n.State),f={id:F++,type:"RemeshStateStorage",State:n.State,stateItem:n,currentState:u,downstreamSet:new Set};return i.stateMap.set(n,f),C.set(n,f),t.inspectStateStorage(O.StateCreated,f),f},Re=n=>{const i=w(n.State.owner);i.stateMap.has(n.stateItem)||(n.currentState=Ee(n.State),i.stateMap.set(n.stateItem,n),t.inspectStateStorage(O.StateReused,n))},Y=n=>{const u=w(n.State.owner).stateMap.get(n);if(u)return u;const f=C.get(n);return f?(Re(f),f):Dt(n)},xe=new WeakMap,Ot=n=>{const i=w(n.owner),u={get:D.get},f=new B,h=f.pipe(Lr(b=>n.impl?n.impl(u,b):b)),g=xe.get(n),m=Object.assign(g!=null?g:{},{id:F++,type:"RemeshEventStorage",Event:n,subject:f,observable:h,refCount:0});return i.eventMap.set(n,m),xe.set(n,m),m},H=n=>{var f;return(f=w(n.owner).eventMap.get(n))!=null?f:Ot(n)},Ce=new WeakMap,It=n=>{const i=w(n.Query.owner),u=S(n),f=new B,h=f.asObservable(),g=new Set,m={id:F++,type:"RemeshQueryStorage",Query:n.Query,arg:n.arg,key:u,upstreamSet:g,downstreamSet:new Set,subject:f,observable:h,refCount:0,status:"default",wipUpstreamSet:new Set},{Query:b}=n,qt={get:Q=>{if(m.upstreamSet!==g)return D.get(Q);if(Q.type==="RemeshStateItem"){const L=Y(Q);return m.upstreamSet.add(L),L.downstreamSet.add(m),D.get(Q)}if(Q.type==="RemeshQueryAction"){const L=V(Q);return m.upstreamSet.add(L),L.downstreamSet.add(m),D.get(Q)}return D.get(Q)}},er=b.impl(qt,n.arg);return m.currentValue=er,i.queryMap.set(u,m),Ce.set(n,m),t.inspectQueryStorage(O.QueryCreated,m),m},De=n=>{const i=w(n.Query.owner);if(i.queryMap.has(n.key))return;const u=new B,f=u.asObservable();n.status="default",n.subject=u,n.observable=f,i.queryMap.set(n.key,n);for(const h of n.upstreamSet)if(h.downstreamSet.add(n),h.type==="RemeshQueryStorage")De(h);else if(h.type==="RemeshStateStorage")Re(h);else throw new Error(`Unknown upstream: ${h}`);Me(n),t.inspectQueryStorage(O.QueryReused,n)},V=n=>{const i=w(n.Query.owner),u=S(n),f=i.queryMap.get(u);if(f)return f;const h=Ce.get(n);return h?(De(h),h):It(n)},Oe=new WeakMap,kt=n=>{const i=x(n),u=new Set,f={state:m=>{const b=qe(m);return b.owner=n,b},query:m=>{const b=et(m);return b.owner=n,b},event:m=>{const b=Xe(m);return b.owner=n,b},command:m=>{const b=tt(m);return b.owner=n,b},effect:m=>{h.ignited||h.effectList.push(m)},preload:m=>{h.ignited||h.preloadOptionsList.push(m)},getDomain:m=>{const b=w(m);return u.add(b),b.downstreamSet.add(h),h.ignited&&ie(m),b.domain},getExtern:m=>y(m)},h={id:F++,type:"RemeshDomainStorage",Domain:n.Domain,get domain(){return g},arg:n.arg,domainContext:f,domainAction:n,key:i,upstreamSet:u,downstreamSet:new Set,effectList:[],stateMap:new Map,entityMap:new Map,queryMap:new Map,eventMap:new Map,effectMap:new Map,commandMap:new Map,preloadOptionsList:[],preloadedState:{},refCount:0,ignited:!1,hasBeenPreloaded:!1,isDiscarding:!1},g=rt(n.Domain.impl(f,n.arg));return c.set(i,h),Oe.set(n,h),t.inspectDomainStorage(O.DomainCreated,h),Qt(h),h},Qt=n=>{if(!(e!=null&&e.preloadedState))return;const i={get:D.get};for(const u of n.preloadOptionsList)if(Object.prototype.hasOwnProperty.call(e.preloadedState,u.key)){const f=e.preloadedState[u.key];k(u.command(i,f))}},w=n=>{const i=x(n),u=c.get(i);if(u)return u;const f=Oe.get(n);if(f){f.ignited=!1,f.isDiscarding=!1,c.set(f.key,f);for(const h of f.upstreamSet)h.downstreamSet.add(f);return t.inspectDomainStorage(O.DomainReused,f),f}return kt(n)},Ie=n=>{const i=w(n.Query.owner);if(!!i.queryMap.has(n.key)){i.queryMap.delete(n.key),n.subject.complete(),t.inspectQueryStorage(O.QueryDiscarded,n);for(const u of n.upstreamSet)!u.downstreamSet.has(n)||(u.downstreamSet.delete(n),u.type==="RemeshQueryStorage"&&ne(u));G(i)}},Mt=n=>!(n.refCount>0||n.downstreamSet.size!==0),ne=n=>{Mt(n)&&Ie(n)},Pt=n=>{const i=w(n.State.owner);!i.stateMap.has(n.stateItem)||(i.stateMap.delete(n.stateItem),n.downstreamSet.clear(),t.inspectStateStorage(O.StateDiscarded,n))},ke=n=>{const i=w(n.Event.owner);n.subject.complete(),i.eventMap.delete(n.Event),G(i)},_t=n=>!(n.refCount>0),Ut=n=>{_t(n)&&ke(n)},oe=n=>{if(!n.isDiscarding){n.isDiscarding=!0,n.ignited=!1;for(const i of n.effectMap.values())i.unsubscribe();for(const i of n.eventMap.values())ke(i);for(const i of n.queryMap.values())Ie(i);for(const i of n.stateMap.values())Pt(i);n.downstreamSet.clear(),n.stateMap.clear(),n.queryMap.clear(),n.eventMap.clear(),n.effectMap.clear(),c.delete(n.key),t.inspectDomainStorage(O.DomainDiscarded,n);for(const i of n.upstreamSet)!i.downstreamSet.has(n)||(i.downstreamSet.delete(n),G(i))}},jt=n=>{if(n.refCount>0||n.isDiscarding||n.downstreamSet.size!==0)return!1;for(const i of n.queryMap.values())if(i.refCount>0)return!1;for(const i of n.eventMap.values())if(i.refCount>0)return!1;return!0},G=n=>{jt(n)&&oe(n)},Tt=n=>{const i=Y(n);if(i.currentState===le)throw new Error(`Unexpected reading domain.state before initializing: ${i.State.stateName}`);return i.currentState},Qe=n=>{const i=V(n);return se(i),i.currentValue},D={get:n=>{if(n.type==="RemeshStateItem")return Tt(n);if(n.type==="RemeshQueryAction")return Qe(n);throw new Error(`Unexpected input in ctx.get(..): ${n}`)},fromEvent:n=>{if(n.type==="RemeshEvent")return H(n).observable;if(n.type==="RemeshSubscribeOnlyEvent"){const i=ze(n);return H(i).observable}throw new Error(`Unexpected input in fromEvent(..): ${n}`)},fromQuery:n=>V(n).observable},se=n=>{if(n.status!=="wip")return;if(n.wipUpstreamSet.size!==0){let u=!1;for(const f of n.wipUpstreamSet)if(f.type==="RemeshStateStorage")u=!0;else if(f.type==="RemeshQueryStorage")f.status==="wip"&&se(f),f.status==="updated"&&(u=!0);else throw new Error(`Unexpected upstream: ${f}`);if(n.wipUpstreamSet.clear(),!u){n.status="default";return}}Me(n)?n.status="updated":n.status="default"},Me=n=>{const{Query:i}=n;for(const m of n.upstreamSet)!m.downstreamSet.has(n)||(m.downstreamSet.delete(n),m.downstreamSet.size===0&&m.type!=="RemeshStateStorage"&&a.add(m));const u=new Set;n.upstreamSet=u;const f={get:m=>{if(n.upstreamSet!==u)return D.get(m);if(m.type==="RemeshStateItem"){const b=Y(m);return n.upstreamSet.add(b),b.downstreamSet.add(n),D.get(m)}if(m.type==="RemeshQueryAction"){const b=V(m);return n.upstreamSet.add(b),b.downstreamSet.add(n),D.get(m)}return D.get(m)}};let h;if(!i.onError)h=i.impl(f,n.arg);else try{h=i.impl(f,n.arg)}catch(m){const b=m instanceof Error?m:new Error(`${m}`);h=i.onError(b,n.currentValue)}return i.compare(n.currentValue,h)?!1:(n.currentValue=h,o.add(n),t.inspectQueryStorage(O.QueryUpdated,n),!0)},Pe=()=>{if(a.size===0)return;const n=[...a];a.clear();for(const i of n)ne(i);Pe()},_e=()=>{if(o.size===0)return;const n=[...o];o.clear();for(const i of n)o.has(i)||(i.type==="RemeshQueryStorage"?i.subject.next(i.currentValue):i.type==="RemeshEventAction"&&Lt(i));_e()},Ue=n=>{if(n.status="wip",n.downstreamSet.size>0)for(const i of n.downstreamSet)i.wipUpstreamSet.has(n)||(i.wipUpstreamSet.add(n),Ue(i));else s.add(n)},je=()=>{if(s.size===0)return;const n=[...s];s.clear();for(const i of n)se(i);je()},Te=()=>{je(),Pe(),_e()},Vt=(n,i)=>{const u=Y(n);if(!(u.currentState!==le&&n.State.compare(u.currentState,i))){u.currentState=i,t.inspectStateStorage(O.StateUpdated,u);for(const f of u.downstreamSet)f.wipUpstreamSet.add(u),Ue(f)}},Lt=n=>{const{Event:i,arg:u}=n,f=H(i);t.inspectEventEmitted(O.EventEmitted,n),f.subject.next(u)},ae={get:D.get},Wt=n=>{t.inspectCommandReceived(O.CommandReceived,n);const{Command:i,arg:u}=n,f=i.impl,h=Ke(i,"before");if(h)for(const m of h)k(m(ae,u));k(f(ae,u));const g=Ke(i,"after");if(g)for(const m of g)k(m(ae,u))},k=n=>{if(!!n)if(Array.isArray(n))for(const i of n)k(i);else n.type==="RemeshCommandAction"?Wt(n):n.type==="RemeshStateItemUpdatePayload"?Vt(n.stateItem,n.value):n.type==="RemeshEventAction"&&o.add(n)},$t=n=>{const i=w(n),u=new K(()=>{i.refCount-=1,i.refCount===0&&G(i)});return i.refCount+=1,u},Ft=(n,i)=>{const u=V(n),f=new I(h=>{const g=u.subject.subscribe(h);return u.refCount+=1,()=>{u.refCount-=1,g.unsubscribe(),u.refCount===0&&ne(u)}});return f.subscribe(i)},Ve=(n,i)=>{if(n.type==="RemeshEvent"){const u=H(n);return new I(g=>{const m=u.observable.subscribe(g);return u.refCount+=1,()=>{u.refCount-=1,m.unsubscribe(),u.refCount===0&&Ut(u)}}).subscribe(i)}else if(n.type==="RemeshSubscribeOnlyEvent"){const u=ze(n);return Ve(u,i)}throw new Error(`Unknown event type of ${n}`)},Nt=n=>w(n).domain,zt={get:D.get,fromEvent:D.fromEvent,fromQuery:D.fromQuery},Kt=n=>{k(n),Te()},ie=n=>{const i=w(n);if(!i.ignited){i.ignited=!0;for(const u of i.upstreamSet)ie(u.domainAction);for(const u of i.effectList){const f=u.impl(zt);if(f===null)continue;const h=Vr(f).subscribe(Kt);i.effectMap.set(u,h)}}},Yt=n=>{const i=w(n);oe(i)},Ht=()=>{t.destroyInspectors();for(const n of c.values())oe(n);c.clear(),o.clear()},Le=n=>{const i=w(n);if(i.ignited)throw new Error(`Domain ${n.Domain.domainName} was ignited before preloading`);if(i.preloadedPromise)return i.preloadedPromise;const u=Xt(n);return i.preloadedPromise=u,u},Gt={get:D.get},Jt={get:D.get},Xt=async n=>{const i=w(n);i.hasBeenPreloaded||(i.hasBeenPreloaded=!0,await Promise.all(Array.from(i.upstreamSet).map(u=>Le(u.domainAction))),await Promise.all(i.preloadOptionsList.map(async u=>{const f=await u.query(Jt);if(Object.prototype.hasOwnProperty.call(i.preloadedState,u.key))throw new Error(`Duplicate key ${u.key}`);i.preloadedState[u.key]=f;const h=u.command(Gt,f);k(h)})))},Zt=()=>{const n={};for(const i of c.values())Object.assign(n,i.preloadedState);return n},Bt=n=>w(n).preloadedState,At=n=>{k(n),Te()};return{name:r.name,getDomain:Nt,igniteDomain:ie,discardDomain:Yt,query:Qe,send:At,discard:Ht,preload:Le,getPreloadedState:Zt,getDomainPreloadedState:Bt,subscribeDomain:$t,subscribeQuery:Ft,subscribeEvent:Ve,getKey:M}},tn={domain:ve,extern:ir,store:Et,state:qe,query:et,command:tt,event:Xe,module:cr};var Rt={exports:{}},xt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T=E.exports;function Fr(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Nr=typeof Object.is=="function"?Object.is:Fr,zr=T.useState,Kr=T.useEffect,Yr=T.useLayoutEffect,Hr=T.useDebugValue;function Gr(e,r){var t=r(),o=zr({inst:{value:t,getSnapshot:r}}),s=o[0].inst,a=o[1];return Yr(function(){s.value=t,s.getSnapshot=r,fe(s)&&a({inst:s})},[e,t,r]),Kr(function(){return fe(s)&&a({inst:s}),e(function(){fe(s)&&a({inst:s})})},[e]),Hr(t),t}function fe(e){var r=e.getSnapshot;e=e.value;try{var t=r();return!Nr(e,t)}catch{return!0}}function Jr(e,r){return r()}var Xr=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?Jr:Gr;xt.useSyncExternalStore=T.useSyncExternalStore!==void 0?T.useSyncExternalStore:Xr;Rt.exports=xt;const Ct=E.exports.createContext(null),Zr=()=>{const e=E.exports.useContext(Ct);if(e===null)throw new Error("You may forget to add <RemeshRoot />");return e},re=()=>Zr().remeshStore,rn=e=>{const r=E.exports.useRef(e.store);r.current||(r.current=Et("options"in e?e.options:{}));const t=r.current,o=E.exports.useMemo(()=>({remeshStore:t}),[t]);return N(Ct.Provider,{value:o,children:e.children})},nn=function(e){const r=re(),t=E.exports.useRef(null),o=E.exports.useCallback(p=>(t.current=p,()=>{t.current=null}),[]),s=E.exports.useCallback(()=>r.query(e),[r,e]),a=Rt.exports.useSyncExternalStore(o,s,s),c=E.exports.useRef(null),d=r.getKey(e);return E.exports.useEffect(()=>()=>{var p;(p=c.current)==null||p.unsubscribe(),c.current=null},[r,d]),E.exports.useEffect(()=>{c.current===null&&(c.current=r.subscribeQuery(e,()=>{var p;(p=t.current)==null||p.call(t)}))},[r,e]),a},on=function(e,r){const t=re(),o=E.exports.useRef(r);E.exports.useEffect(()=>{o.current=r}),E.exports.useEffect(()=>{const s=t.subscribeEvent(e,a=>{o.current(a)});return()=>{s.unsubscribe()}},[e,t])},sn=function(){return re().send},Br=function(e){const r=re(),t=r.getDomain(e);E.exports.useEffect(()=>{r.igniteDomain(e)},[r,e]);const o=r.getKey(e),s=E.exports.useRef(null);return E.exports.useEffect(()=>()=>{var a;(a=s.current)==null||a.unsubscribe(),s.current=null},[r,o]),E.exports.useEffect(()=>{s.current===null&&(s.current=r.subscribeDomain(e))},[r,e]),t},Ar=e=>(Br(e.domain),N(ye,{})),qr=e=>N(ye,{children:e.domains.map((r,t)=>N(Ar,{domain:r},t))}),an=e=>tr(ye,{children:[N(qr,{domains:e.domains}),e.children]});export{I as O,tn as R,K as S,q as _,A as a,Br as b,ct as c,nn as d,rn as e,W as f,we as g,Vr as h,vr as i,R as j,_ as k,on as l,Lr as m,He as n,ge as o,z as p,me as q,ve as r,an as s,sn as u};
//# sourceMappingURL=remesh-react.c6a64ae5.js.map
