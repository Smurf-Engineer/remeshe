{"version":3,"file":"index.97b311bf.js","sources":["../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/dateTimestampProvider.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/Action.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/intervalProvider.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncAction.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/Scheduler.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncScheduler.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/scheduler/async.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/util/isDate.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/concatAll.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/observable/concat.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/observable/timer.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/take.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/ignoreElements.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/mapTo.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/delayWhen.js","../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/delay.js","../../../projects/react-demos/src/chess/context/game.ts","../../../projects/react-demos/src/chess/components/Board.tsx","../../../projects/domains/src/chess/index.ts","../../../projects/react-demos/src/chess/components/Chess.tsx","../../../projects/react-demos/src/chess/components/Marker.tsx","../../../projects/react-demos/src/chess/ChessGame.tsx","../../../projects/react-demos/src/chess/index.tsx"],"sourcesContent":["export var dateTimestampProvider = {\n    now: function () {\n        return (dateTimestampProvider.delegate || Date).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=dateTimestampProvider.js.map","import { __extends } from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = (function (_super) {\n    __extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var intervalProvider = {\n    setInterval: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = intervalProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setInterval) {\n            return delegate.setInterval.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setInterval.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearInterval: function (handle) {\n        var delegate = intervalProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearInterval) || clearInterval)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=intervalProvider.js.map","import { __extends } from \"tslib\";\nimport { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nvar AsyncAction = (function (_super) {\n    __extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, _id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (_scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        intervalProvider.clearInterval(id);\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, _delay) {\n        var errored = false;\n        var errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            var _a = this, id = _a.id, scheduler = _a.scheduler;\n            var actions = scheduler.actions;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            _super.prototype.unsubscribe.call(this);\n        }\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map","import { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar Scheduler = (function () {\n    function Scheduler(schedulerActionCtor, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        this.schedulerActionCtor = schedulerActionCtor;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) { delay = 0; }\n        return new this.schedulerActionCtor(this, work).schedule(state, delay);\n    };\n    Scheduler.now = dateTimestampProvider.now;\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map","import { __extends } from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = (function (_super) {\n    __extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        var _this = _super.call(this, SchedulerAction, now) || this;\n        _this.actions = [];\n        _this._active = false;\n        _this._scheduled = undefined;\n        return _this;\n    }\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this._active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this._active = true;\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions.shift()));\n        this._active = false;\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var asyncScheduler = new AsyncScheduler(AsyncAction);\nexport var async = asyncScheduler;\n//# sourceMappingURL=async.js.map","export function isValidDate(value) {\n    return value instanceof Date && !isNaN(value);\n}\n//# sourceMappingURL=isDate.js.map","import { mergeAll } from './mergeAll';\nexport function concatAll() {\n    return mergeAll(1);\n}\n//# sourceMappingURL=concatAll.js.map","import { concatAll } from '../operators/concatAll';\nimport { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function concat() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return concatAll()(from(args, popScheduler(args)));\n}\n//# sourceMappingURL=concat.js.map","import { Observable } from '../Observable';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\nexport function timer(dueTime, intervalOrScheduler, scheduler) {\n    if (dueTime === void 0) { dueTime = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var intervalDuration = -1;\n    if (intervalOrScheduler != null) {\n        if (isScheduler(intervalOrScheduler)) {\n            scheduler = intervalOrScheduler;\n        }\n        else {\n            intervalDuration = intervalOrScheduler;\n        }\n    }\n    return new Observable(function (subscriber) {\n        var due = isValidDate(dueTime) ? +dueTime - scheduler.now() : dueTime;\n        if (due < 0) {\n            due = 0;\n        }\n        var n = 0;\n        return scheduler.schedule(function () {\n            if (!subscriber.closed) {\n                subscriber.next(n++);\n                if (0 <= intervalDuration) {\n                    this.schedule(undefined, intervalDuration);\n                }\n                else {\n                    subscriber.complete();\n                }\n            }\n        }, due);\n    });\n}\n//# sourceMappingURL=timer.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nexport function ignoreElements() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, noop));\n    });\n}\n//# sourceMappingURL=ignoreElements.js.map","import { map } from './map';\nexport function mapTo(value) {\n    return map(function () { return value; });\n}\n//# sourceMappingURL=mapTo.js.map","import { concat } from '../observable/concat';\nimport { take } from './take';\nimport { ignoreElements } from './ignoreElements';\nimport { mapTo } from './mapTo';\nimport { mergeMap } from './mergeMap';\nexport function delayWhen(delayDurationSelector, subscriptionDelay) {\n    if (subscriptionDelay) {\n        return function (source) {\n            return concat(subscriptionDelay.pipe(take(1), ignoreElements()), source.pipe(delayWhen(delayDurationSelector)));\n        };\n    }\n    return mergeMap(function (value, index) { return delayDurationSelector(value, index).pipe(take(1), mapTo(value)); });\n}\n//# sourceMappingURL=delayWhen.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { delayWhen } from './delayWhen';\nimport { timer } from '../observable/timer';\nexport function delay(due, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration = timer(due, scheduler);\n    return delayWhen(function () { return duration; });\n}\n//# sourceMappingURL=delay.js.map","import React from 'react'\n\ntype GameConfigContextValue = {\n  left: number\n  top: number\n  gridSize: number\n  chessSize: number\n}\n\nexport const GameConfigContext = React.createContext<GameConfigContextValue>({\n  left: 0,\n  top: 0,\n  gridSize: 60,\n  chessSize: 40,\n})\n","import React, { useContext } from 'react'\nimport { GameConfigContext } from '../context/game'\n\n// 棋盘画线辅助计算\nconst createPathArr = (config: { left: number; top: number; gridSize: number }) => {\n  const { left: baseLeft, top: baseTop, gridSize } = config\n\n  const left = baseLeft + gridSize / 2\n  const top = baseTop + gridSize / 2\n\n  // 生成线的路径\n  const line = (x1: number, y1: number, x2: number, y2: number) => {\n    return `M${left + x1 * gridSize},${top + y1 * gridSize} L${left + x2 * gridSize},${top + y2 * gridSize}`\n  }\n\n  // 生成十字花\n  const star = (x: number, y: number) => {\n    const arr = []\n    const distance = 1 / 10\n    const length = 1 / 4\n\n    let startX, startY, endX, endY\n\n    // 左边画一半\n    if (x != 0) {\n      startX = x - distance\n      startY = y - distance - length\n      endX = x - distance - length\n      endY = y - distance\n\n      arr.push(line(startX, startY, startX, endY))\n      arr.push(line(startX, endY, endX, endY))\n\n      startY = y + distance + length\n      endY = y + distance\n\n      arr.push(line(startX, startY, startX, endY))\n      arr.push(line(startX, endY, endX, endY))\n    }\n\n    // 右边画一半\n    if (x != 8) {\n      startX = x + distance\n      startY = y - distance - length\n      endX = x + distance + length\n      endY = y - distance\n\n      arr.push(line(startX, startY, startX, endY))\n      arr.push(line(startX, endY, endX, endY))\n\n      startY = y + distance + length\n      endY = y + distance\n\n      arr.push(line(startX, startY, startX, endY))\n      arr.push(line(startX, endY, endX, endY))\n    }\n\n    return arr\n  }\n\n  const arr: string[] = [\n    // 炮位\n    [1, 2],\n    [7, 2],\n    [1, 7],\n    [7, 7],\n    // 兵位\n    [0, 3],\n    [2, 3],\n    [4, 3],\n    [6, 3],\n    [8, 3],\n    [0, 6],\n    [2, 6],\n    [4, 6],\n    [6, 6],\n    [8, 6],\n  ]\n    .map(([x, y]) => star(x, y))\n    .reduce((acc, cur) => acc.concat(cur), [])\n    // 横线\n    .concat(new Array(8).fill(0).map((_, i) => line(0, i + 1, 8, i + 1)))\n    // 竖线，被楚河汉界分成两段\n    .concat(new Array(7).fill(0).map((_, i) => line(i + 1, 0, i + 1, 4)))\n    .concat(new Array(7).fill(0).map((_, i) => line(i + 1, 5, i + 1, 9)))\n    // 九宫格的线\n    .concat([line(3, 0, 5, 2), line(5, 0, 3, 2), line(3, 7, 5, 9), line(3, 9, 5, 7)])\n\n  return arr\n}\n\nexport const BoardRender = () => {\n  const config = useContext(GameConfigContext)\n\n  const { left: baseLeft, top: baseTop, gridSize, chessSize } = config\n\n  const left = baseLeft + gridSize / 2\n  const top = baseTop + gridSize / 2\n  const width = gridSize * 8\n  const height = gridSize * 9\n\n  const pathArr = createPathArr(config)\n\n  const svgStyle: React.SVGAttributes<SVGSVGElement>['style'] = {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    width: width + chessSize,\n    height: height + chessSize,\n  }\n\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" style={svgStyle}>\n      <g>\n        <rect x={left} y={top} width={width} height={height} fill=\"none\" stroke=\"#000000\" strokeWidth=\"3\"></rect>\n        {pathArr.map((path, i) => (\n          <path key={i} fill=\"none\" stroke=\"#000000\" d={path}></path>\n        ))}\n      </g>\n    </svg>\n  )\n}\n","import { Remesh } from 'remesh'\nimport { delay, filter, map } from 'rxjs/operators'\n\nexport enum ChessValue {\n  General = 100,\n  Chariot = 50,\n  Cannon = 30,\n  Horse = 29,\n  Elephant = 16,\n  Guard = 10,\n  Soldier = 1,\n}\n\nexport enum ChessColor {\n  Red = 1,\n  Black = -1,\n}\n\nexport type Position = {\n  x: number\n  y: number\n}\n\nexport type Chess = {\n  color: ChessColor // 棋子什么颜色\n  value: ChessValue // 是哪种棋子\n  selected?: boolean // 是否被选中\n  marked?: boolean // 是否被标记为可攻击\n  position: Position // 当前位置\n}\n\nexport type Marker = Position\n\nexport type Game = {\n  currentPlayer: ChessColor\n  selectedChess?: Chess\n  situation: Chess[]\n  markers: Marker[]\n}\n\nexport type GameStatus = 'red-win' | 'black-win' | 'playing'\n\n/**\n * 帮助函数\n */\n/**\n * 判断两个位置是否相同\n * @param pos1 第一个位置\n * @param pos2 第二个位置\n * @returns boolean，是否相同\n */\nconst isSamePosition = (pos1: Position, pos2: Position) => {\n  return pos1.x === pos2.x && pos1.y === pos2.y\n}\n\n/**\n * 将的位置是否合法\n * @param color 颜色\n * @param position 位置\n */\nconst isGeneralValid = (color: ChessColor, { x, y }: Position) => {\n  switch (color) {\n    case ChessColor.Black:\n      return !(x < 3 || x > 5 || (y > 2 && y < 7))\n    case ChessColor.Red:\n      return !(x < 3 || x > 5 || (y > 2 && y < 7))\n  }\n}\n\n/**\n * 士的位置是否合法\n * @param color 颜色\n * @param position 位置\n */\nconst isGuardValid = (color: ChessColor, { x, y }: Position) => {\n  switch (color) {\n    case ChessColor.Black:\n      return [\n        [3, 0],\n        [3, 2],\n        [5, 0],\n        [5, 2],\n        [4, 1],\n      ].find(([x1, y1]) => x1 === x && y1 === y)\n    case ChessColor.Red:\n      return [\n        [3, 7],\n        [3, 9],\n        [5, 7],\n        [5, 9],\n        [4, 8],\n      ].find(([x1, y1]) => x1 === x && y1 === y)\n  }\n}\n\n/**\n * 象的位置是否合法\n * @param color 颜色\n * @param position 位置\n */\nconst isElephantValid = (color: ChessColor, { x, y }: Position) => {\n  switch (color) {\n    case ChessColor.Black:\n      return [\n        [0, 2],\n        [2, 0],\n        [2, 4],\n        [4, 2],\n        [6, 0],\n        [6, 4],\n        [8, 2],\n      ].find(([x1, y1]) => x1 === x && y1 === y)\n    case ChessColor.Red:\n      return [\n        [0, 7],\n        [2, 5],\n        [2, 9],\n        [4, 7],\n        [6, 5],\n        [6, 9],\n        [8, 7],\n      ].find(([x1, y1]) => x1 === x && y1 === y)\n  }\n}\n\n/**\n * 兵的位置是否合法\n * @param color 颜色\n * @param position 位置\n */\nconst isSoldierValid = (color: ChessColor, { x, y }: Position) => {\n  switch (color) {\n    case ChessColor.Black:\n      return !(y < 3 || (y < 5 && x % 2 === 1))\n    case ChessColor.Red:\n      return !(y > 6 || (y > 4 && x % 2 === 1))\n  }\n}\n\nconst canCannonAttack =\n  (game: Game) =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    // 不在一条直线上，不能走\n    if (source.x !== x && source.y !== y) {\n      return false\n    }\n\n    // 先检测目标位置有无棋子\n    if (game.situation.find((chess) => chess.position.x === x && chess.position.y === y)) {\n      // 目标位置非空，吃子的逻辑，检测中间时候有且仅有一个棋子\n      // 同一水平线\n      if (source.y === y) {\n        return (\n          game.situation.filter(\n            (chess) => chess.position.y === y && (chess.position.x - x) * (chess.position.x - source.x) < 0,\n          ).length === 1\n        )\n      }\n\n      // 同一竖直线\n      if (source.x === x) {\n        return (\n          game.situation.filter(\n            (chess) => chess.position.x === x && (chess.position.y - y) * (chess.position.y - source.y) < 0,\n          ).length === 1\n        )\n      }\n    }\n\n    return false\n  }\n\n// 将可以去哪里吗\nconst canGeneralMove =\n  () =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    return Math.abs(source.y - y) + Math.abs(source.x - x) === 1\n  }\n\n// 士可以去哪里吗\nconst canGuardMove =\n  () =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    const square = (a: number) => a * a\n\n    return square(source.x - x) + square(source.y - y) === 2\n  }\n\n// 象可以去哪里吗\nconst canElephantMove =\n  (game: Game) =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    if (Math.abs(source.x - x) !== 2 || Math.abs(source.y - y) !== 2) {\n      return false\n    } else {\n      // 象眼位置没有棋子\n      return !game.situation.find(\n        (chess) => chess.position.x === (source.x + x) / 2 && chess.position.y === (source.y + y) / 2,\n      )\n    }\n  }\n\n// 马可以去哪里吗\nconst canHorseMove =\n  (game: Game) =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    const dx = source.x - x\n    const dy = source.y - y\n\n    // 马走日，并且马腿的位置没有棋子\n    return (\n      dx * dx + dy * dy === 5 &&\n      !game.situation.find(\n        (chess) =>\n          chess.position.x === Math.round((2 * source.x + x) / 3) &&\n          chess.position.y === Math.round((2 * source.y + y) / 3),\n      )\n    )\n  }\n\n// 能走直线吗\nconst canMoveStraightly =\n  (game: Game) =>\n  ({ position: source }: Chess, { x, y }: Position) => {\n    // 不在一条直线上，不能走\n    if (source.x !== x && source.y !== y) {\n      return false\n    }\n\n    // 同一条水平线，中间无棋子\n    if (source.y === y) {\n      return !game.situation.find(\n        (chess) => chess.position.y === y && (chess.position.x - x) * (chess.position.x - source.x) < 0,\n      )\n    }\n\n    // 同一竖直线，中间无棋子\n    if (source.x === x) {\n      return !game.situation.find(\n        (chess) => chess.position.x === x && (chess.position.y - y) * (chess.position.y - source.y) < 0,\n      )\n    }\n\n    return false\n  }\n\n// 兵可以去哪里吗\nconst canSoldierMove =\n  () =>\n  ({ position: source, color }: Chess, { x, y }: Position) => {\n    switch (color) {\n      case ChessColor.Black:\n        return y >= source.y && Math.abs(x - source.x) + Math.abs(y - source.y) === 1\n      case ChessColor.Red:\n        return y <= source.y && Math.abs(x - source.x) + Math.abs(y - source.y) === 1\n    }\n  }\n\n/**\n * 判断在当前棋局下，某个棋子能否移动到目的位置，有些棋子的移动需要结合棋盘状态，此处不检测目标位置是否有棋子\n * @param game 棋盘状态\n */\nconst canMove = (game: Game) => (chess: Chess, position: Position) => {\n  const { color, value } = chess\n  switch (value) {\n    case ChessValue.General:\n      return isGeneralValid(color, position) && canGeneralMove()(chess, position)\n    case ChessValue.Guard:\n      return isGuardValid(color, position) && canGuardMove()(chess, position)\n    case ChessValue.Elephant:\n      return isElephantValid(color, position) && canElephantMove(game)(chess, position)\n    case ChessValue.Horse:\n      return canHorseMove(game)(chess, position)\n    case ChessValue.Chariot:\n      return canMoveStraightly(game)(chess, position)\n    case ChessValue.Cannon:\n      return canMoveStraightly(game)(chess, position)\n    case ChessValue.Soldier:\n      return isSoldierValid(color, position) && canSoldierMove()(chess, position)\n  }\n}\n\n/**\n * 判断在当前棋局下，某个棋子能否攻击目标位置\n * @param game 棋盘状态\n */\nconst canAttack = (game: Game) => (chess: Chess, dest: Chess) => {\n  if (chess.color === dest.color) {\n    // 不能吃自己的棋子\n    return false\n  }\n\n  if (chess.value === ChessValue.Cannon) {\n    return canCannonAttack(game)(chess, dest.position)\n  } else {\n    return (\n      game.situation.find((chess) => isSamePosition(chess.position, dest.position)) &&\n      canMove(game)(chess, dest.position)\n    )\n  }\n}\n\n// 标记某个棋子为选中\nconst select = (chess: Chess) => {\n  return {\n    ...chess,\n    selected: true,\n  }\n}\n\n// 取消某个棋子的选中状态\nconst unselect = (chess: Chess) => {\n  return {\n    ...chess,\n    selected: false,\n  }\n}\n\n// 标记为可被攻击\nconst mark = (chess: Chess) => {\n  return {\n    ...chess,\n    marked: true,\n  }\n}\n\n// 取消可攻击状态\nconst unmark = (chess: Chess) => {\n  return {\n    ...chess,\n    marked: false,\n  }\n}\n\n/**\n * 移动棋子到指定位置\n * @param chess 待移动的棋子状态\n * @param position 位置\n */\nconst move = (position: Position) => {\n  return (chess: Chess) => {\n    return {\n      ...chess,\n      position,\n    }\n  }\n}\n\n/**\n * 在当前棋局中选中指定位置的棋子\n * @param position 目标位置\n */\nconst selectChessInGame =\n  (position: Position) =>\n  (game: Game): Game => {\n    const { currentPlayer, situation } = game\n    const { x, y } = position\n\n    let newSelectedChess: Chess | undefined\n    const newSituation = situation\n      .map((chess) => unmark(unselect(chess)))\n      .map((chess) => {\n        if (chess.position.x === x && chess.position.y === y) {\n          newSelectedChess = select(chess)\n          return newSelectedChess\n        } else {\n          return chess\n        }\n      })\n      .map((chess) => {\n        if (canAttack(game)(newSelectedChess!, chess)) {\n          return mark(chess)\n        } else {\n          return chess\n        }\n      })\n\n    const markers: Marker[] = new Array(90)\n      .fill(null)\n      .map((v, index) => {\n        const x = index % 9\n        const y = (index - x) / 9\n        return { x, y }\n      })\n      .filter((v) => canMove(game)(newSelectedChess!, v))\n\n    return {\n      currentPlayer,\n      selectedChess: newSelectedChess,\n      situation: newSituation,\n      markers,\n    }\n  }\n\n/**\n * 在当前棋局中，把选中的棋子移动到指定位置\n * @param position 目标位置\n */\nconst moveChessInGame =\n  (position: Position) =>\n  (game: Game): Game => {\n    const { currentPlayer, situation, selectedChess } = game\n\n    if (selectedChess && canMove(game)(selectedChess, position)) {\n      const { x, y } = selectedChess.position\n      const newSituation = situation\n        .map((chess) => {\n          if (chess.position.x === x && chess.position.y === y) {\n            return move(position)(chess)\n          } else {\n            return chess\n          }\n        })\n        // 走完之后，去掉棋子的选中和标记状态\n        .map((chess) => unmark(unselect(chess)))\n\n      return {\n        currentPlayer: -currentPlayer,\n        selectedChess: undefined,\n        situation: newSituation,\n        markers: [],\n      }\n    }\n    return game\n  }\n\n/**\n * 在当前棋局中，用选中的棋子攻击指定位置\n * @param position 目标位置\n */\nconst attack =\n  (position: Position) =>\n  (game: Game): Game => {\n    const { currentPlayer, situation, selectedChess } = game\n\n    // 要攻击的棋子\n    const dest = situation.find((chess) => chess.position.x === position.x && chess.position.y === position.y)\n\n    if (selectedChess && dest && canAttack(game)(selectedChess, dest)) {\n      const { x, y } = selectedChess.position\n      const newSituation = situation\n        .map((chess) => {\n          // 吃别人的，自己移动到对方位置\n          if (chess.position.x === x && chess.position.y === y) {\n            return move(position)(chess)\n          }\n\n          // 被吃的，拿掉\n          if (chess.position.x === position.x && chess.position.y === position.y) {\n            return null\n          }\n\n          // 其他保持原样\n          return chess\n        })\n        .filter((chess) => !!chess)\n        // 走完之后，去掉棋子的选中和标记状态\n        .map((chess) => unmark(unselect(chess as Chess)))\n\n      return {\n        currentPlayer: -currentPlayer,\n        selectedChess: undefined,\n        situation: newSituation,\n        markers: [],\n      }\n    }\n    return game\n  }\n\nconst getGameStatus = (situation: Game['situation']): GameStatus => {\n  const blackWin = !situation.some((chess) => {\n    return chess.color === ChessColor.Red && chess.value === ChessValue.General\n  })\n\n  if (blackWin) {\n    return 'black-win'\n  }\n\n  const redWin = !situation.some((chess) => {\n    return chess.color === ChessColor.Black && chess.value === ChessValue.General\n  })\n\n  if (redWin) {\n    return 'red-win'\n  }\n\n  return 'playing'\n}\n\nconst defaultSituation: Chess[] = [\n  { color: ChessColor.Black, value: ChessValue.Chariot, position: { x: 0, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Horse, position: { x: 1, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Elephant, position: { x: 2, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Guard, position: { x: 3, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.General, position: { x: 4, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Guard, position: { x: 5, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Elephant, position: { x: 6, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Horse, position: { x: 7, y: 0 } },\n  { color: ChessColor.Black, value: ChessValue.Chariot, position: { x: 8, y: 0 } },\n\n  { color: ChessColor.Black, value: ChessValue.Cannon, position: { x: 1, y: 2 } },\n  { color: ChessColor.Black, value: ChessValue.Cannon, position: { x: 7, y: 2 } },\n\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 0, y: 3 } },\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 2, y: 3 } },\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 4, y: 3 } },\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 6, y: 3 } },\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 8, y: 3 } },\n\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 0, y: 6 } },\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 2, y: 6 } },\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 4, y: 6 } },\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 6, y: 6 } },\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 8, y: 6 } },\n\n  { color: ChessColor.Red, value: ChessValue.Cannon, position: { x: 1, y: 7 } },\n  { color: ChessColor.Red, value: ChessValue.Cannon, position: { x: 7, y: 7 } },\n\n  { color: ChessColor.Red, value: ChessValue.Chariot, position: { x: 0, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Horse, position: { x: 1, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Elephant, position: { x: 2, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Guard, position: { x: 3, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.General, position: { x: 4, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Guard, position: { x: 5, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Elephant, position: { x: 6, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Horse, position: { x: 7, y: 9 } },\n  { color: ChessColor.Red, value: ChessValue.Chariot, position: { x: 8, y: 9 } },\n]\n\nexport const GameDomain = Remesh.domain({\n  name: 'GameDomain',\n  impl: (domain) => {\n    const defaultGameState = {\n      currentPlayer: ChessColor.Red,\n      selectedChess: undefined,\n      situation: defaultSituation,\n      markers: [],\n    }\n\n    const GameState = domain.state<Game>({\n      name: 'Game',\n      default: defaultGameState,\n    })\n\n    // 不需要筛选过滤了，直接返回\n    const gameState = GameState.query\n\n    const gameStatusQuery = domain.query({\n      name: 'gameStatus',\n      impl: ({ get }): GameStatus => {\n        const { situation } = get(gameState())\n        return getGameStatus(situation)\n      },\n    })\n\n    const gameOverEvent = domain.event({\n      name: 'gameOverEvent',\n    })\n\n    // 不需要区分前因后果，知道他不能走就可以了，所以参数跟返回值都不用了\n    const notYourMoveEvent = domain.event({\n      name: 'notYourMoveEvent',\n    })\n\n    const resetGameState = domain.command({\n      name: 'resetGameState',\n      impl: () => {\n        return GameState().new(defaultGameState)\n      },\n    })\n\n    const selectChess = domain.command({\n      name: 'selectChess',\n      impl({ get }, chess: Chess) {\n        const gameStatus = get(gameStatusQuery())\n\n        if (gameStatus !== 'playing') {\n          return gameOverEvent()\n        }\n\n        const game = get(GameState())\n        const { currentPlayer, selectedChess } = game\n\n        if (chess.color === currentPlayer) {\n          return [GameState().new(selectChessInGame(chess.position)(game))]\n        } else {\n          if (selectedChess) {\n            return [GameState().new(attack(chess.position)(game))]\n          } else {\n            return [notYourMoveEvent()]\n          }\n        }\n      },\n    })\n\n    const moveChess = domain.command({\n      name: 'moveChess',\n      impl({ get }, position: Marker) {\n        const gameStatus = get(gameStatusQuery())\n\n        if (gameStatus !== 'playing') {\n          return gameOverEvent()\n        }\n\n        const game = get(GameState())\n\n        const { selectedChess } = game\n\n        if (selectedChess) {\n          return [GameState().new(moveChessInGame(position)(game))]\n        } else {\n          return [notYourMoveEvent()]\n        }\n      },\n    })\n\n    const checkGameStatus = domain.command$({\n      name: 'checkGameStatus',\n      impl: ({ fromQuery }) => {\n        return fromQuery(gameStatusQuery()).pipe(\n          filter((gameStatus) => gameStatus !== 'playing'),\n          delay(100),\n          map(() => gameOverEvent()),\n        )\n      },\n    })\n\n    domain.ignite(() => checkGameStatus())\n\n    return {\n      query: {\n        gameState: gameState,\n        gameStatus: gameStatusQuery,\n      },\n      command: {\n        selectChess,\n        moveChess,\n        resetGameState,\n      },\n      event: {\n        notYourMoveEvent,\n        gameOverEvent,\n      },\n    }\n  },\n})\n","import React, { useContext } from 'react'\nimport { Chess, ChessColor, ChessValue } from 'remesh-domains-for-demos/dist/chess'\nimport { GameConfigContext } from '../context/game'\n\nconst formatChessColor = (color: ChessColor) => {\n  return { [ChessColor.Red]: 'red', [ChessColor.Black]: 'black' }[color]\n}\n\nconst formatChessValue = (color: ChessColor, value: ChessValue) => {\n  return {\n    [ChessColor.Red]: {\n      [ChessValue.General]: '帅',\n      [ChessValue.Guard]: '仕',\n      [ChessValue.Elephant]: '相',\n      [ChessValue.Horse]: '馬',\n      [ChessValue.Chariot]: '車',\n      [ChessValue.Cannon]: '炮',\n      [ChessValue.Soldier]: '兵',\n    },\n    [ChessColor.Black]: {\n      [ChessValue.General]: '将',\n      [ChessValue.Guard]: '士',\n      [ChessValue.Elephant]: '象',\n      [ChessValue.Horse]: '马',\n      [ChessValue.Chariot]: '车',\n      [ChessValue.Cannon]: '砲',\n      [ChessValue.Soldier]: '卒',\n    },\n  }[color][value]\n}\n\ntype ChessProps = {\n  chess: Chess\n  onClick: (chess: Chess) => void\n}\n\nexport const ChessRender = (props: ChessProps) => {\n  const { chess, onClick } = props\n\n  const {\n    color,\n    value,\n    position: { x, y },\n    selected,\n    marked,\n  } = chess\n\n  const { chessSize, gridSize, left, top } = useContext(GameConfigContext)\n\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\n    position: 'absolute',\n    zIndex: 10,\n    backgroundColor: 'white',\n    fontSize: 26,\n    textAlign: 'center',\n    borderWidth: 2,\n    width: chessSize,\n    height: chessSize,\n    cursor: 'pointer',\n    left: left + x * gridSize + (gridSize - chessSize) / 2 - 2,\n    top: top + y * gridSize + (gridSize - chessSize) / 2 - 2,\n    borderStyle: selected ? 'dashed' : 'solid',\n    borderColor: marked ? 'aqua' : formatChessColor(color),\n    borderRadius: chessSize / 2 + 1,\n    color: formatChessColor(color),\n  }\n\n  return (\n    <div onClick={() => onClick(chess)} style={style}>\n      {formatChessValue(color, value)}\n    </div>\n  )\n}\n","import React, { useContext } from 'react'\nimport { Marker } from 'remesh-domains-for-demos/dist/chess'\nimport { GameConfigContext } from '../context/game'\n\ntype MarkerProps = {\n  marker: Marker\n  onClick: (marker: Marker) => void\n}\n\nexport const MarkerRender = (props: MarkerProps) => {\n  const { marker, onClick } = props\n  const { x, y } = marker\n\n  const { chessSize, gridSize, left, top } = useContext(GameConfigContext)\n\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\n    position: 'absolute',\n    borderWidth: 2,\n    borderStyle: 'dashed',\n    borderColor: 'green',\n    backgroundColor: 'white',\n    width: chessSize / 2,\n    height: chessSize / 2,\n    left: left + x * gridSize + chessSize / 4 + (gridSize - chessSize) / 2 - 2,\n    top: top + y * gridSize + chessSize / 4 + (gridSize - chessSize) / 2 - 2,\n  }\n\n  return <div onClick={() => onClick(marker)} style={style} />\n}\n","import React, { useContext } from 'react'\nimport { useRemeshDomain, useRemeshEvent, useRemeshQuery } from 'remesh-react'\nimport { BoardRender } from './components/Board'\nimport { ChessRender } from './components/Chess'\nimport { MarkerRender } from './components/Marker'\nimport { GameConfigContext } from './context/game'\n\nimport { GameDomain } from 'remesh-domains-for-demos/dist/chess'\n\nexport const ChessGame = () => {\n  const { left, top, gridSize } = useContext(GameConfigContext)\n\n  const domain = useRemeshDomain(GameDomain())\n  const gameState = useRemeshQuery(domain.query.gameState())\n\n  useRemeshEvent(domain.event.notYourMoveEvent, () => {\n    alert('不该你走')\n  })\n\n  useRemeshEvent(domain.event.gameOverEvent, () => {\n    const shouldRestart = window.confirm('游戏结束，是否重新开始？')\n    if (shouldRestart) {\n      domain.command.resetGameState()\n    }\n  })\n\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\n    width: left + 9 * gridSize,\n    height: top + 10 * gridSize,\n  }\n\n  const { situation, markers } = gameState\n\n  return (\n    <div style={style}>\n      <BoardRender />\n\n      {situation.map((chess, i) => (\n        <ChessRender key={i} chess={chess} onClick={() => domain.command.selectChess(chess)} />\n      ))}\n\n      {markers.map((marker, i) => (\n        <MarkerRender key={i} marker={marker} onClick={() => domain.command.moveChess(marker)} />\n      ))}\n    </div>\n  )\n}\n","import React, { StrictMode } from 'react'\nimport * as ReactDOMClient from 'react-dom/client'\n\nimport { Remesh } from 'remesh'\n\nimport { RemeshRoot } from 'remesh-react'\nimport { RemeshReduxDevtools } from 'remesh-redux-devtools'\nimport { RemeshLogger } from 'remesh-logger'\n\nimport { ChessGame } from './ChessGame'\nimport { GameConfigContext } from './context/game'\n\nconst container = document.getElementById('root')\n\nif (container) {\n  const root = ReactDOMClient.createRoot(container)\n  const store = Remesh.store({\n    inspectors: [\n      RemeshReduxDevtools(),\n      RemeshLogger({\n        include: ['command', 'query', 'event', 'domain', 'command$', 'state'],\n      }),\n    ],\n  })\n\n  root.render(\n    <StrictMode>\n      <RemeshRoot store={store}>\n        <GameConfigContext.Provider\n          value={{\n            left: 0,\n            top: 0,\n            gridSize: 60,\n            chessSize: 40,\n          }}\n        >\n          <ChessGame />\n        </GameConfigContext.Provider>\n      </RemeshRoot>\n    </StrictMode>,\n  )\n}\n"],"names":["asyncScheduler","createPathArr","config","left","baseLeft","top","baseTop","gridSize","line","x1","y1","x2","y2","star","x","y","arr","startX","startY","endX","endY","distance","length","push","map","reduce","acc","cur","concat","Array","fill","_","i","BoardRender","useContext","GameConfigContext","chessSize","width","height","pathArr","svgStyle","position","_jsx","path","formatChessColor","color","ChessColor","Red","Black","formatChessValue","value","ChessValue","General","Guard","Elephant","Horse","Chariot","Cannon","Soldier","ChessRender","props","chess","onClick","selected","marked","style","zIndex","backgroundColor","fontSize","textAlign","borderWidth","cursor","borderStyle","borderColor","borderRadius","MarkerRender","marker","ChessGame","domain","useRemeshDomain","GameDomain","gameState","useRemeshQuery","query","event","notYourMoveEvent","alert","gameOverEvent","shouldRestart","window","confirm","command","resetGameState","situation","markers","selectChess","moveChess","container","document","getElementById","root","ReactDOMClient","store","Remesh","inspectors","RemeshReduxDevtools","RemeshLogger","include","render","StrictMode"],"mappings":"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"}