var ln=Object.defineProperty,mn=Object.defineProperties;var dn=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var st=(e,n,t)=>n in e?ln(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,$=(e,n)=>{for(var t in n||(n={}))at.call(n,t)&&st(e,t,n[t]);if(oe)for(var t of oe(n))it.call(n,t)&&st(e,t,n[t]);return e},k=(e,n)=>mn(e,dn(n));var ct=(e,n)=>{var t={};for(var o in e)at.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&oe)for(var o of oe(e))n.indexOf(o)<0&&it.call(e,o)&&(t[o]=e[o]);return t};import{r as N,a as pn}from"./jsx-runtime.cbb87597.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var be=function(e,n){return be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},be(e,n)};function q(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");be(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}function hn(e,n,t,o){function s(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function d(u){try{l(o.next(u))}catch(f){c(f)}}function h(u){try{l(o.throw(u))}catch(f){c(f)}}function l(u){u.done?a(u.value):s(u.value).then(d,h)}l((o=o.apply(e,n||[])).next())})}function vt(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,s,a,c;return c={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(l){return function(u){return h([l,u])}}function h(l){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,s&&(a=l[0]&2?s.return:l[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,l[1])).done)return a;switch(s=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(u){l=[6,u],s=0}finally{o=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function z(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],o=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function ie(e,n){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),s,a=[],c;try{for(;(n===void 0||n-- >0)&&!(s=o.next()).done;)a.push(s.value)}catch(d){c={error:d}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(c)throw c.error}}return a}function ce(e,n,t){if(t||arguments.length===2)for(var o=0,s=n.length,a;o<s;o++)(a||!(o in n))&&(a||(a=Array.prototype.slice.call(n,0,o)),a[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))}function P(e){return this instanceof P?(this.v=e,this):new P(e)}function yn(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=t.apply(e,n||[]),s,a=[];return s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s;function c(p){o[p]&&(s[p]=function(w){return new Promise(function(E,C){a.push([p,w,E,C])>1||d(p,w)})})}function d(p,w){try{h(o[p](w))}catch(E){f(a[0][3],E)}}function h(p){p.value instanceof P?Promise.resolve(p.value.v).then(l,u):f(a[0][2],p)}function l(p){d("next",p)}function u(p){d("throw",p)}function f(p,w){p(w),a.shift(),a.length&&d(a[0][0],a[0][1])}}function vn(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof z=="function"?z(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(a){t[a]=e[a]&&function(c){return new Promise(function(d,h){c=e[a](c),s(d,h,c.done,c.value)})}}function s(a,c,d,h){Promise.resolve(h).then(function(l){a({value:l,done:d})},c)}}function x(e){return typeof e=="function"}function St(e){var n=function(o){Error.call(o),o.stack=new Error().stack},t=e(n);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ye=St(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(o,s){return s+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function we(e,n){if(e){var t=e.indexOf(n);0<=t&&e.splice(t,1)}}var B=function(){function e(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var n,t,o,s,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var d=z(c),h=d.next();!h.done;h=d.next()){var l=h.value;l.remove(this)}}catch(C){n={error:C}}finally{try{h&&!h.done&&(t=d.return)&&t.call(d)}finally{if(n)throw n.error}}else c.remove(this);var u=this.initialTeardown;if(x(u))try{u()}catch(C){a=C instanceof ye?C.errors:[C]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var p=z(f),w=p.next();!w.done;w=p.next()){var E=w.value;try{ut(E)}catch(C){a=a!=null?a:[],C instanceof ye?a=ce(ce([],ie(a)),ie(C.errors)):a.push(C)}}}catch(C){o={error:C}}finally{try{w&&!w.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}}if(a)throw new ye(a)}},e.prototype.add=function(n){var t;if(n&&n!==this)if(this.closed)ut(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(n)}},e.prototype._hasParent=function(n){var t=this._parentage;return t===n||Array.isArray(t)&&t.includes(n)},e.prototype._addParent=function(n){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n},e.prototype._removeParent=function(n){var t=this._parentage;t===n?this._parentage=null:Array.isArray(t)&&we(t,n)},e.prototype.remove=function(n){var t=this._finalizers;t&&we(t,n),n instanceof e&&n._removeParent(this)},e.EMPTY=function(){var n=new e;return n.closed=!0,n}(),e}(),gt=B.EMPTY;function bt(e){return e instanceof B||e&&"closed"in e&&x(e.remove)&&x(e.add)&&x(e.unsubscribe)}function ut(e){x(e)?e():e.unsubscribe()}var le={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ue={setTimeout:function(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var s=ue.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,ce([e,n],ie(t))):setTimeout.apply(void 0,ce([e,n],ie(t)))},clearTimeout:function(e){var n=ue.delegate;return((n==null?void 0:n.clearTimeout)||clearTimeout)(e)},delegate:void 0};function wt(e){ue.setTimeout(function(){var n=le.onUnhandledError;if(n)n(e);else throw e})}function ft(){}var Sn=function(){return Re("C",void 0,void 0)}();function gn(e){return Re("E",void 0,e)}function bn(e){return Re("N",e,void 0)}function Re(e,n,t){return{kind:e,value:n,error:t}}function ae(e){e()}var Ce=function(e){q(n,e);function n(t){var o=e.call(this)||this;return o.isStopped=!1,t?(o.destination=t,bt(t)&&t.add(o)):o.destination=Cn,o}return n.create=function(t,o,s){return new Ee(t,o,s)},n.prototype.next=function(t){this.isStopped?Se(bn(t),this):this._next(t)},n.prototype.error=function(t){this.isStopped?Se(gn(t),this):(this.isStopped=!0,this._error(t))},n.prototype.complete=function(){this.isStopped?Se(Sn,this):(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},n.prototype._next=function(t){this.destination.next(t)},n.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},n.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},n}(B),wn=Function.prototype.bind;function ve(e,n){return wn.call(e,n)}var En=function(){function e(n){this.partialObserver=n}return e.prototype.next=function(n){var t=this.partialObserver;if(t.next)try{t.next(n)}catch(o){se(o)}},e.prototype.error=function(n){var t=this.partialObserver;if(t.error)try{t.error(n)}catch(o){se(o)}else se(n)},e.prototype.complete=function(){var n=this.partialObserver;if(n.complete)try{n.complete()}catch(t){se(t)}},e}(),Ee=function(e){q(n,e);function n(t,o,s){var a=e.call(this)||this,c;if(x(t)||!t)c={next:t!=null?t:void 0,error:o!=null?o:void 0,complete:s!=null?s:void 0};else{var d;a&&le.useDeprecatedNextContext?(d=Object.create(t),d.unsubscribe=function(){return a.unsubscribe()},c={next:t.next&&ve(t.next,d),error:t.error&&ve(t.error,d),complete:t.complete&&ve(t.complete,d)}):c=t}return a.destination=new En(c),a}return n}(Ce);function se(e){wt(e)}function Rn(e){throw e}function Se(e,n){var t=le.onStoppedNotification;t&&ue.setTimeout(function(){return t(e,n)})}var Cn={closed:!0,next:ft,error:Rn,complete:ft},De=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Dn(e){return e}function $n(e){return e.length===0?Dn:e.length===1?e[0]:function(t){return e.reduce(function(o,s){return s(o)},t)}}var A=function(){function e(n){n&&(this._subscribe=n)}return e.prototype.lift=function(n){var t=new e;return t.source=this,t.operator=n,t},e.prototype.subscribe=function(n,t,o){var s=this,a=In(n)?n:new Ee(n,t,o);return ae(function(){var c=s,d=c.operator,h=c.source;a.add(d?d.call(a,h):h?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(n){try{return this._subscribe(n)}catch(t){n.error(t)}},e.prototype.forEach=function(n,t){var o=this;return t=lt(t),new t(function(s,a){var c=new Ee({next:function(d){try{n(d)}catch(h){a(h),c.unsubscribe()}},error:a,complete:s});o.subscribe(c)})},e.prototype._subscribe=function(n){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(n)},e.prototype[De]=function(){return this},e.prototype.pipe=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return $n(n)(this)},e.prototype.toPromise=function(n){var t=this;return n=lt(n),new n(function(o,s){var a;t.subscribe(function(c){return a=c},function(c){return s(c)},function(){return o(a)})})},e.create=function(n){return new e(n)},e}();function lt(e){var n;return(n=e!=null?e:le.Promise)!==null&&n!==void 0?n:Promise}function xn(e){return e&&x(e.next)&&x(e.error)&&x(e.complete)}function In(e){return e&&e instanceof Ce||xn(e)&&bt(e)}function kn(e){return x(e==null?void 0:e.lift)}function H(e){return function(n){if(kn(n))return n.lift(function(t){try{return e(t,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function j(e,n,t,o,s){return new Nn(e,n,t,o,s)}var Nn=function(e){q(n,e);function n(t,o,s,a,c,d){var h=e.call(this,t)||this;return h.onFinalize=c,h.shouldUnsubscribe=d,h._next=o?function(l){try{o(l)}catch(u){t.error(u)}}:e.prototype._next,h._error=a?function(l){try{a(l)}catch(u){t.error(u)}finally{this.unsubscribe()}}:e.prototype._error,h._complete=s?function(){try{s()}catch(l){t.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,h}return n.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var o=this.closed;e.prototype.unsubscribe.call(this),!o&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},n}(Ce),Qn=St(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Z=function(e){q(n,e);function n(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n.prototype.lift=function(t){var o=new mt(this,this);return o.operator=t,o},n.prototype._throwIfClosed=function(){if(this.closed)throw new Qn},n.prototype.next=function(t){var o=this;ae(function(){var s,a;if(o._throwIfClosed(),!o.isStopped){o.currentObservers||(o.currentObservers=Array.from(o.observers));try{for(var c=z(o.currentObservers),d=c.next();!d.done;d=c.next()){var h=d.value;h.next(t)}}catch(l){s={error:l}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}}})},n.prototype.error=function(t){var o=this;ae(function(){if(o._throwIfClosed(),!o.isStopped){o.hasError=o.isStopped=!0,o.thrownError=t;for(var s=o.observers;s.length;)s.shift().error(t)}})},n.prototype.complete=function(){var t=this;ae(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var o=t.observers;o.length;)o.shift().complete()}})},n.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(n.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),n.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},n.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},n.prototype._innerSubscribe=function(t){var o=this,s=this,a=s.hasError,c=s.isStopped,d=s.observers;return a||c?gt:(this.currentObservers=null,d.push(t),new B(function(){o.currentObservers=null,we(d,t)}))},n.prototype._checkFinalizedStatuses=function(t){var o=this,s=o.hasError,a=o.thrownError,c=o.isStopped;s?t.error(a):c&&t.complete()},n.prototype.asObservable=function(){var t=new A;return t.source=this,t},n.create=function(t,o){return new mt(t,o)},n}(A),mt=function(e){q(n,e);function n(t,o){var s=e.call(this)||this;return s.destination=t,s.source=o,s}return n.prototype.next=function(t){var o,s;(s=(o=this.destination)===null||o===void 0?void 0:o.next)===null||s===void 0||s.call(o,t)},n.prototype.error=function(t){var o,s;(s=(o=this.destination)===null||o===void 0?void 0:o.error)===null||s===void 0||s.call(o,t)},n.prototype.complete=function(){var t,o;(o=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||o===void 0||o.call(t)},n.prototype._subscribe=function(t){var o,s;return(s=(o=this.source)===null||o===void 0?void 0:o.subscribe(t))!==null&&s!==void 0?s:gt},n}(Z);function An(e){return e&&x(e.schedule)}function Et(e){return e[e.length-1]}function Mn(e){return An(Et(e))?e.pop():void 0}function xr(e,n){return typeof Et(e)=="number"?e.pop():n}var Rt=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Ct(e){return x(e==null?void 0:e.then)}function Dt(e){return x(e[De])}function $t(e){return Symbol.asyncIterator&&x(e==null?void 0:e[Symbol.asyncIterator])}function xt(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function _n(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var It=_n();function kt(e){return x(e==null?void 0:e[It])}function Nt(e){return yn(this,arguments,function(){var t,o,s,a;return vt(this,function(c){switch(c.label){case 0:t=e.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,P(t.read())];case 3:return o=c.sent(),s=o.value,a=o.done,a?[4,P(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,P(s)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Qt(e){return x(e==null?void 0:e.getReader)}function T(e){if(e instanceof A)return e;if(e!=null){if(Dt(e))return Un(e);if(Rt(e))return On(e);if(Ct(e))return Vn(e);if($t(e))return At(e);if(kt(e))return jn(e);if(Qt(e))return Tn(e)}throw xt(e)}function Un(e){return new A(function(n){var t=e[De]();if(x(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function On(e){return new A(function(n){for(var t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}function Vn(e){return new A(function(n){e.then(function(t){n.closed||(n.next(t),n.complete())},function(t){return n.error(t)}).then(null,wt)})}function jn(e){return new A(function(n){var t,o;try{for(var s=z(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(n.next(c),n.closed)return}}catch(d){t={error:d}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}n.complete()})}function At(e){return new A(function(n){Ln(e,n).catch(function(t){return n.error(t)})})}function Tn(e){return At(Nt(e))}function Ln(e,n){var t,o,s,a;return hn(this,void 0,void 0,function(){var c,d;return vt(this,function(h){switch(h.label){case 0:h.trys.push([0,5,6,11]),t=vn(e),h.label=1;case 1:return[4,t.next()];case 2:if(o=h.sent(),!!o.done)return[3,4];if(c=o.value,n.next(c),n.closed)return[2];h.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return d=h.sent(),s={error:d},[3,11];case 6:return h.trys.push([6,,9,10]),o&&!o.done&&(a=t.return)?[4,a.call(t)]:[3,8];case 7:h.sent(),h.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return n.complete(),[2]}})})}function V(e,n,t,o,s){o===void 0&&(o=0),s===void 0&&(s=!1);var a=n.schedule(function(){t(),s?e.add(this.schedule(null,o)):this.unsubscribe()},o);if(e.add(a),!s)return a}function Mt(e,n){return n===void 0&&(n=0),H(function(t,o){t.subscribe(j(o,function(s){return V(o,e,function(){return o.next(s)},n)},function(){return V(o,e,function(){return o.complete()},n)},function(s){return V(o,e,function(){return o.error(s)},n)}))})}function _t(e,n){return n===void 0&&(n=0),H(function(t,o){o.add(e.schedule(function(){return t.subscribe(o)},n))})}function Wn(e,n){return T(e).pipe(_t(n),Mt(n))}function Fn(e,n){return T(e).pipe(_t(n),Mt(n))}function Kn(e,n){return new A(function(t){var o=0;return n.schedule(function(){o===e.length?t.complete():(t.next(e[o++]),t.closed||this.schedule())})})}function Pn(e,n){return new A(function(t){var o;return V(t,n,function(){o=e[It](),V(t,n,function(){var s,a,c;try{s=o.next(),a=s.value,c=s.done}catch(d){t.error(d);return}c?t.complete():t.next(a)},0,!0)}),function(){return x(o==null?void 0:o.return)&&o.return()}})}function Ut(e,n){if(!e)throw new Error("Iterable cannot be null");return new A(function(t){V(t,n,function(){var o=e[Symbol.asyncIterator]();V(t,n,function(){o.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function zn(e,n){return Ut(Nt(e),n)}function Yn(e,n){if(e!=null){if(Dt(e))return Wn(e,n);if(Rt(e))return Kn(e,n);if(Ct(e))return Fn(e,n);if($t(e))return Ut(e,n);if(kt(e))return Pn(e,n);if(Qt(e))return zn(e,n)}throw xt(e)}function Hn(e,n){return n?Yn(e,n):T(e)}function Gn(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=Mn(e);return Hn(e,t)}function Ot(e,n){return H(function(t,o){var s=0;t.subscribe(j(o,function(a){o.next(e.call(n,a,s++))}))})}function Jn(e,n,t,o,s,a,c,d){var h=[],l=0,u=0,f=!1,p=function(){f&&!h.length&&!l&&n.complete()},w=function(C){return l<o?E(C):h.push(C)},E=function(C){a&&n.next(C),l++;var te=!1;T(t(C,u++)).subscribe(j(n,function(_){s==null||s(_),a?w(_):n.next(_)},function(){te=!0},void 0,function(){if(te)try{l--;for(var _=function(){var L=h.shift();c?V(n,c,function(){return E(L)}):E(L)};h.length&&l<o;)_();p()}catch(L){n.error(L)}}))};return e.subscribe(j(n,w,function(){f=!0,p()})),function(){d==null||d()}}function fe(e,n,t){return t===void 0&&(t=1/0),x(n)?fe(function(o,s){return Ot(function(a,c){return n(o,a,s,c)})(T(e(o,s)))},t):(typeof n=="number"&&(t=n),H(function(o,s){return Jn(o,s,e,t)}))}function Xn(e,n){return x(n)?fe(e,n,1):fe(e,1)}function Vt(e,n){return n?function(t){return t.pipe(Vt(function(o,s){return T(e(o,s)).pipe(Ot(function(a,c){return n(o,a,s,c)}))}))}:H(function(t,o){var s=0,a=null,c=!1;t.subscribe(j(o,function(d){a||(a=j(o,void 0,function(){a=null,c&&o.complete()}),T(e(d,s++)).subscribe(a))},function(){c=!0,!a&&o.complete()}))})}function Zn(e,n){return H(function(t,o){var s=null,a=0,c=!1,d=function(){return c&&!s&&o.complete()};t.subscribe(j(o,function(h){s==null||s.unsubscribe();var l=0,u=a++;T(e(h,u)).subscribe(s=j(o,function(f){return o.next(n?n(h,f,u,l++):f)},function(){s=null,d()}))},function(){c=!0,d()}))})}var dt=function(n,t,o,s){var a=o?o.call(s,n,t):void 0;if(a!==void 0)return!!a;if(n===t)return!0;if(typeof n!="object"||!n||typeof t!="object"||!t)return!1;var c=Object.keys(n),d=Object.keys(t);if(c.length!==d.length)return!1;for(var h=Object.prototype.hasOwnProperty.bind(t),l=0;l<c.length;l++){var u=c[l];if(!h(u))return!1;var f=n[u],p=t[u];if(a=o?o.call(s,f,p,u):void 0,a===!1||a===void 0&&f!==p)return!1}return!0};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function pt(e){return Object.prototype.toString.call(e)==="[object Object]"}function ht(e){var n,t;return pt(e)===!1?!1:(n=e.constructor,n===void 0?!0:(t=n.prototype,!(pt(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}const Ir=e=>e,W=Symbol("RemeshValuePlaceholder");let qn=0;function Bn(e){var o;const n=qn++,t=s=>({type:"RemeshEventPayload",arg:s,Event:t});return t.type="RemeshEvent",t.eventId=n,t.eventName=e.name,t.owner=ee(),t.inspectable="inspectable"in e&&(o=e.inspectable)!=null?o:!0,"impl"in e&&(t.impl=e.impl),t}const er=e=>me({name:e.name,impl:()=>e.default,inspectable:e.inspectable,compare:e.compare}),tr=e=>me({name:e.name,defer:!0,impl:n=>{throw new Error(`RemeshDeferState: use ${e.name} before setting state`)},inspectable:e.inspectable,compare:e.compare});let nr=0;const jt=(e,n)=>ht(e)&&ht(n)||Array.isArray(e)&&Array.isArray(n)?dt(e,n):e===n,me=e=>{var s,a,c;const n=nr++;let t=null;const o=d=>{if(d===void 0&&t)return t;const h={type:"RemeshStateItem",arg:d,State:o,new:l=>({type:"RemeshStateSetterPayload",stateItem:h,newState:l})};return d===void 0&&(t=h),h};return o.type="RemeshState",o.stateId=n,o.stateName=e.name,o.impl=e.impl,o.compare=(s=e.compare)!=null?s:jt,o.owner=ee(),o.inspectable=(a=e.inspectable)!=null?a:!0,o.defer=(c=e.defer)!=null?c:!1,o.query=$e({name:`${e.name}.Query`,inspectable:!1,impl:({get:d},h)=>d(o(h))}),o};let rr=0;const $e=e=>{var s,a;const n=rr++;let t=null;const o=c=>{if(c===void 0&&t)return t;const d={type:"RemeshQueryPayload",Query:o,arg:c};return c===void 0&&(t=d),d};return o.type="RemeshQuery",o.queryId=n,o.queryName=e.name,o.prepare=e.prepare,o.impl=e.impl,o.compare=(s=e.compare)!=null?s:jt,o.owner=ee(),o.inspectable=(a=e.inspectable)!=null?a:!0,o};let or=0;const Tt=e=>{var o;const n=or++,t=s=>({type:"RemeshCommandPayload",arg:s,Command:t});return t.type="RemeshCommand",t.commandId=n,t.commandName=e.name,t.impl=e.impl,t.owner=ee(),t.inspectable=(o=e.inspectable)!=null?o:!0,t};let sr=0;const xe=e=>{var o;const n=sr++,t=s=>({type:"RemeshCommand$Payload",arg:s,Command$:t});return t.type="RemeshCommand$",t.command$Id=n,t.command$Name=e.name,t.impl=e.impl,t.owner=ee(),t.inspectable=(o=e.inspectable)!=null?o:!0,t},Lt=e=>xe({name:e.name,inspectable:e.inspectable,impl:(t,o)=>{if(!e.mode||e.mode==="switch")return o.pipe(Zn(s=>e.impl(t,s)));if(e.mode==="merge")return o.pipe(fe(s=>e.impl(t,s)));if(e.mode==="concat")return o.pipe(Xn(s=>e.impl(t,s)));if(e.mode==="exhaust")return o.pipe(Vt(s=>e.impl(t,s)));throw new Error(`RemeshCommandAsync: invalid mode: ${e.mode}`)}});let ar=0;const ir=e=>{const n=t=>({type:"RemeshExternPayload",Extern:n,value:t});return n.externId=ar++,n.externName=e.name,n.default=e.default,n};let cr=0;const Ie=e=>{var o;let n=null;const t=s=>{if(s===void 0&&n)return n;const a={type:"RemeshDomainPayload",Domain:t,arg:s};return s===void 0&&(n=a),a};return t.type="RemeshDomain",t.domainId=cr++,t.domainName=e.name,t.impl=e.impl,t.inspectable=(o=e.inspectable)!=null?o:!0,t},ee=Ie({name:"DefaultDomain",impl:()=>({})}),Q={DomainCreated:"Domain::Created",DomainDestroyed:"Domain::Destroyed",DomainRestored:"Domain::Restored",StateCreated:"State::Created",StateUpdated:"State::Updated",StateDestroyed:"State::Destroyed",StateRestored:"State::Restored",QueryCreated:"Query::Created",QueryUpdated:"Query::Updated",QueryDestroyed:"Query::Destroyed",QueryRestored:"Query::Restored",EventEmitted:"Event::Emitted",CommandReceived:"Command::Received",Command$Received:"Command$::Received"},O=Ie({name:"RemeshInspector",impl:e=>{const n=e.event({name:"RemeshDomainStorageEvent"}),t=e.event({name:"RemeshStateStorageEvent"}),o=e.event({name:"RemeshQueryStorageEvent"}),s=e.event({name:"RemeshEventEmitted"}),a=e.event({name:"RemeshCommandReceived"}),c=e.event({name:"RemeshCommand$Received"});return{event:{RemeshDomainStorageEvent:n,RemeshStateStorageEvent:t,RemeshQueryStorageEvent:o,RemeshEventEmittedEvent:s,RemeshCommandReceivedEvent:a,RemeshCommand$ReceivedEvent:c}}}}),K=e=>e.owner?e.owner.Domain.inspectable&&e.inspectable:e.inspectable,ur=e=>{var n;return((n=e.inspectors)!=null?n:[]).filter(t=>!!t).map(t=>{const a=e,{inspectors:o}=a,s=ct(a,["inspectors"]);return t(s)})},fr=e=>{let n=null;const t=()=>(n||(n=ur(e)),n);return{destroyInspectors:()=>{if(n){for(const u of n)u.destroy();n=null}},inspectDomainStorage:(u,f)=>{if(K(f.Domain))for(const p of t()){const E=p.getDomain(O()).event.RemeshDomainStorageEvent({type:u,storage:f});p.emitEvent(E)}},inspectStateStorage:(u,f)=>{if(K(f.State))for(const p of t()){const E=p.getDomain(O()).event.RemeshStateStorageEvent({type:u,storage:f});p.emitEvent(E)}},inspectQueryStorage:(u,f)=>{if(K(f.Query))for(const p of t()){const E=p.getDomain(O()).event.RemeshQueryStorageEvent({type:u,storage:f});p.emitEvent(E)}},inspectEventEmitted:(u,f)=>{if(K(f.Event))for(const p of t()){const E=p.getDomain(O()).event.RemeshEventEmittedEvent({type:u,payload:f});p.emitEvent(E)}},inspectCommandReceived:(u,f)=>{if(K(f.Command))for(const p of t()){const E=p.getDomain(O()).event.RemeshCommandReceivedEvent({type:u,payload:f});p.emitEvent(E)}},inspectCommand$Received:(u,f)=>{if(K(f.Command$))for(const p of t()){const E=p.getDomain(O()).event.RemeshCommand$ReceivedEvent({type:u,payload:f});p.emitEvent(E)}}}};let X=0;const Wt=e=>{const n=$({},e),t=fr(n),o=new Set,s=new Set,a=new Set,c=new Map,d=new WeakMap,h=r=>{var i;for(const m of(i=n.externs)!=null?i:[])if(m.Extern===r)return m.value;return r.default},l=r=>{const i=d.get(r);if(i)return i;const m=h(r),y={id:X++,type:"RemeshExternStorage",Extern:r,currentValue:m};return d.set(r,y),y},u=r=>l(r).currentValue,f=new WeakMap,p=r=>{var S;const i=f.get(r);if(i)return i;const m=r.State.stateName,y=(S=JSON.stringify(r.arg))!=null?S:"",v=`State/${r.State.stateId}/${m}:${y}`;return f.set(r,v),v},w=r=>{var S;const i=f.get(r);if(i)return i;const m=r.Query.queryName,y=(S=JSON.stringify(r.arg))!=null?S:"",v=`Query/${r.Query.queryId}/${m}:${y}`;return f.set(r,v),v},E=r=>{var S;const i=f.get(r);if(i)return i;const m=r.Domain.domainName,y=(S=JSON.stringify(r.arg))!=null?S:"",v=`Domain/${r.Domain.domainId}/${m}:${y}`;return f.set(r,v),v},C=r=>r.type==="RemeshStateItem"?p(r):r.type==="RemeshQueryPayload"?w(r):E(r),te=r=>{if(r.currentState===W)throw new Error(`${r.key} is not found`);return r.currentState},_=new WeakMap,L=(r,i)=>r.defer?W:r.impl(i),Ht=r=>{const i=I(r.State.owner),m=p(r),y=L(r.State,r.arg),v={id:X++,type:"RemeshStateStorage",State:r.State,arg:r.arg,key:m,currentState:y,downstreamSet:new Set};return i.stateMap.set(m,v),_.set(r,v),t.inspectStateStorage(Q.StateCreated,v),v},Ne=r=>{const i=I(r.State.owner);i.stateMap.has(r.key)||(r.currentState=L(r.State,r.arg),i.stateMap.set(r.key,r),t.inspectStateStorage(Q.StateRestored,r))},G=r=>{const i=I(r.State.owner),m=p(r),y=i.stateMap.get(m);if(y)return y;const v=_.get(r);return v?(Ne(v),v):Ht(r)},Qe=new WeakMap,Gt=r=>{const i=I(r.owner),m=new Z,y=new A(D=>{const b=m.subscribe(D);return S.refCount+=1,()=>{b.unsubscribe(),S.refCount-=1,a.add(S),ne()}}),v=Qe.get(r),S=Object.assign(v!=null?v:{},{type:"RemeshEventStorage",Event:r,subject:m,observable:y,refCount:0});return i.eventMap.set(r,S),Qe.set(r,S),S},de=r=>{const m=I(r.owner).eventMap.get(r);return m||Gt(r)},Ae=new WeakMap,Me=r=>{const i=new Z,m=new A(y=>{const v=i.subscribe(y),S=r();return S.refCount+=1,()=>{v.unsubscribe(),S.refCount-=1,a.add(S),ne()}});return{subject:i,observable:m}},_e=(r,i,m)=>{if(!r.prepare)return;const y=r.prepare(i,m);if(!!y){if(Array.isArray(y)){for(const v of y)pe(v);return}pe(y)}},Jt=r=>{const i=I(r.Query.owner),m=w(r),{subject:y,observable:v}=Me(()=>D),S=new Set,D={id:X++,type:"RemeshQueryStorage",Query:r.Query,arg:r.arg,currentValue:W,key:m,upstreamSet:S,downstreamSet:new Set,subject:y,observable:v,refCount:0,status:"default",wipUpstreamSet:new Set},{Query:b}=r,g={get:U=>{if(D.upstreamSet!==S)return R.get(U);if(U.type==="RemeshStateItem"){const J=G(U);return D.upstreamSet.add(J),J.downstreamSet.add(D),R.get(U)}if(U.type==="RemeshQueryPayload"){const J=F(U);return D.upstreamSet.add(J),J.downstreamSet.add(D),R.get(U)}return R.get(U)},peek:R.peek,hasNoValue:R.hasNoValue};_e(b,g,r.arg);const M=b.impl(g,r.arg);return D.currentValue=M,i.queryMap.set(m,D),Ae.set(r,D),t.inspectQueryStorage(Q.QueryCreated,D),D},Ue=r=>{const i=I(r.Query.owner);if(i.queryMap.has(r.key))return;const{subject:m,observable:y}=Me(()=>r);r.status="default",r.subject=m,r.observable=y,i.queryMap.set(r.key,r);for(const v of r.upstreamSet)if(v.downstreamSet.add(r),v.type==="RemeshQueryStorage")Ue(v);else if(v.type==="RemeshStateStorage")Ne(v);else throw new Error(`Unknown upstream: ${v}`);Ge(r),t.inspectQueryStorage(Q.QueryRestored,r)},F=r=>{const i=I(r.Query.owner),m=w(r),y=i.queryMap.get(m);if(y)return y;const v=Ae.get(r);return v?(Ue(v),v):Jt(r)},Oe=new WeakMap,Xt=r=>{const i=I(r.owner),m=new Z,y=m.asObservable(),v={id:X++,type:"RemeshCommand$Storage",Command$:r,subject:m,observable:y};return i.command$Map.set(r,v),Oe.set(r,v),v},Ve=r=>{const i=I(r.owner),m=i.command$Map.get(r);if(m)return m;const y=Oe.get(r);if(y){const v=new Z,S=v.asObservable();return y.subject=v,y.observable=S,y.subscription=void 0,i.command$Map.set(r,y),y}return Xt(r)},je=new WeakMap,Zt=r=>{const i=E(r),m=new Set,y=new Set,v={state:b=>{if("default"in b){const M=er(b);return M.owner=r,M.query.owner=r,M}if(!("impl"in b)){const M=tr(b);return M.owner=r,M.query.owner=r,M}const g=me(b);return g.owner=r,g.query.owner=r,g},query:b=>{const g=$e(b);return g.owner=r,g},event:b=>{const g=Bn(b);return g.owner=r,g},command:b=>{const g=Tt(b);return g.owner=r,g},command$:b=>{const g=xe(b);return g.owner=r,y.add(g),S.running&&re(g),g},ignite:b=>{v.command$({name:"ignite",inspectable:!1,impl:g=>Gn(b(g))})},commandAsync:b=>{const g=Lt(b);return g.owner=r,y.add(g),S.running&&re(g),g},getDomain:b=>{const g=I(b);return m.add(g),g.downstreamSet.add(S),g.domain},getExtern:b=>u(b)},S={id:X++,type:"RemeshDomainStorage",Domain:r.Domain,arg:r.arg,get domain(){return D},domainContext:v,domainPayload:r,key:i,command$Set:y,upstreamSet:m,downstreamSet:new Set,upstreamSubscriptionSet:new Set,domainSubscriptionSet:new Set,stateMap:new Map,queryMap:new Map,eventMap:new Map,command$Map:new Map,refCount:0,running:!1},D=r.Domain.impl(v,r.arg);return c.set(i,S),je.set(r,S),t.inspectDomainStorage(Q.DomainCreated,S),S},I=r=>{const i=E(r),m=c.get(i);if(m)return m;const y=je.get(r);if(y){y.running=!1,c.set(y.key,y);for(const v of y.upstreamSet)v.downstreamSet.add(y);return t.inspectDomainStorage(Q.DomainRestored,y),y}return Zt(r)},Te=r=>{const i=I(r.Query.owner);if(!!i.queryMap.has(r.key)){i.queryMap.delete(r.key),t.inspectQueryStorage(Q.QueryDestroyed,r);for(const m of r.upstreamSet)if(m.downstreamSet.delete(r),m.type==="RemeshQueryStorage")Le(m);else if(m.type==="RemeshStateStorage")Fe(m);else throw new Error(`Unknown upstream in clearQueryStorageIfNeeded(..): ${m}`);r.subject.complete()}},Le=r=>{r.refCount===0&&r.downstreamSet.size===0&&Te(r)},We=r=>{const i=I(r.State.owner);!i.stateMap.has(r.key)||(t.inspectStateStorage(Q.StateDestroyed,r),i.stateMap.delete(r.key),r.downstreamSet.clear())},Fe=r=>{r.downstreamSet.size===0&&We(r)},Ke=r=>{const i=I(r.Event.owner);r.subject.complete(),i.eventMap.delete(r.Event)},qt=r=>{r.refCount===0&&Ke(r)},Bt=r=>{var m;const i=I(r.Command$.owner);r.subject.complete(),(m=r.subscription)==null||m.unsubscribe(),r.subscription=void 0,i.command$Map.delete(r.Command$)},Pe=r=>{t.inspectDomainStorage(Q.DomainDestroyed,r),yt(r.domainSubscriptionSet),yt(r.upstreamSubscriptionSet);for(const i of r.eventMap.values())Ke(i);for(const i of r.queryMap.values())Te(i);for(const i of r.stateMap.values())We(i);for(const i of r.command$Map.values())Bt(i);r.upstreamSubscriptionSet.clear(),r.domainSubscriptionSet.clear(),r.downstreamSet.clear(),r.stateMap.clear(),r.queryMap.clear(),r.eventMap.clear(),r.running=!1,c.delete(r.key);for(const i of r.upstreamSet)i.downstreamSet.delete(r),ze(i)},ze=r=>{r.refCount===0&&r.downstreamSet.size===0&&r.domainSubscriptionSet.size===0&&Pe(r)},en=r=>{const i=G(r);return te(i)},Ye=r=>{const i=F(r),m=i.currentValue;if(m===W)throw new Error(`Query ${i.key} is not ready yet.`);return m},R={get:r=>{if(r.type==="RemeshStateItem")return en(r);if(r.type==="RemeshQueryPayload")return Ye(r);throw new Error(`Unexpected input in ctx.get(..): ${r}`)},peek:r=>{if(r.type==="RemeshStateItem")return G(r).currentState;if(r.type==="RemeshQueryPayload")return F(r).currentValue;throw new Error(`Unexpected input in peek(..): ${r}`)},hasNoValue:r=>R.peek(r)===W,fromEvent:r=>de(r).observable,fromQuery:r=>F(r).observable},He=r=>{if(r.wipUpstreamSet.size!==0){let m=!1;for(const y of r.wipUpstreamSet)y.type==="RemeshStateStorage"?m=!0:y.type==="RemeshQueryStorage"&&(y.status==="wip"&&He(y),y.status==="updated"&&(m=!0));if(r.wipUpstreamSet.clear(),!m){r.status="default";return}}Ge(r)?r.status="updated":r.status="default"},Ge=r=>{const{Query:i}=r;for(const S of r.upstreamSet)S.downstreamSet.delete(r),S.downstreamSet.size===0&&a.add(S);const m=new Set;r.upstreamSet=m;const y={get:S=>{if(r.upstreamSet!==m)return R.get(S);if(S.type==="RemeshStateItem"){const D=G(S);return r.upstreamSet.add(D),D.downstreamSet.add(r),R.get(S)}if(S.type==="RemeshQueryPayload"){const D=F(S);return r.upstreamSet.add(D),D.downstreamSet.add(r),R.get(S)}return R.get(S)},peek:R.peek,hasNoValue:R.hasNoValue};_e(i,y,r.arg);const v=i.impl(y,r.arg);return r.currentValue!==W&&i.compare(r.currentValue,v)?!1:(r.currentValue=v,o.add(r),t.inspectQueryStorage(Q.QueryUpdated,r),!0)},ne=()=>{if(a.size===0)return;const r=[...a];a.clear();for(const i of r)i.type==="RemeshDomainStorage"?ze(i):i.type==="RemeshEventStorage"?qt(i):i.type==="RemeshQueryStorage"?Le(i):i.type==="RemeshStateStorage"&&Fe(i);ne()},Je=()=>{if(o.size===0)return;const r=[...o];o.clear();for(const i of r)i.type==="RemeshEventPayload"?Be(i):i.type==="RemeshQueryStorage"&&(o.has(i)||i.subject.next(i.currentValue));Je()},Xe=r=>{if(r.status="wip",r.downstreamSet.size>0)for(const i of r.downstreamSet)i.wipUpstreamSet.has(r)||(i.wipUpstreamSet.add(r),Xe(i));else s.add(r)},Ze=()=>{if(s.size===0)return;const r=[...s];s.clear();for(const i of r)He(i);Ze()},qe=()=>{Ze(),Je()},pe=r=>{const i=G(r.stateItem);if(!(i.currentState!==W&&r.stateItem.State.compare(i.currentState,r.newState))){i.currentState=r.newState,t.inspectStateStorage(Q.StateUpdated,i);for(const m of i.downstreamSet)m.wipUpstreamSet.add(i),Xe(m)}},tn=r=>{o.add(r)},Be=r=>{const{Event:i,arg:m}=r,y=de(i);if(t.inspectEventEmitted(Q.EventEmitted,r),i.impl){const v={get:R.get,peek:R.peek,hasNoValue:R.hasNoValue},S=i.impl(v,m);y.subject.next(S)}else y.subject.next(m)},et=r=>{t.inspectCommandReceived(Q.CommandReceived,r);const{Command:i,arg:m}=r,y={get:R.get,peek:R.peek,hasNoValue:R.hasNoValue},v=i.impl(y,m);he(v)},tt=(r,i)=>{r.add(i),i.add(()=>{r.delete(i)})},re=r=>{const i=Ve(r);if(i.subscription)return;const m={get:R.get,peek:R.peek,hasNoValue:R.hasNoValue,fromEvent:R.fromEvent,fromQuery:R.fromQuery},v=r.impl(m,i.observable).subscribe(S=>{he(S),qe()});i.subscription=v},he=r=>{if(!!r){if(Array.isArray(r)){for(const i of r)he(i);return}if(r.type==="RemeshCommandPayload"){et(r);return}else if(r.type==="RemeshEventPayload"){tn(r);return}else if(r.type==="RemeshStateSetterPayload"){pe(r);return}else if(r.type==="RemeshCommand$Payload"){nt(r);return}throw new Error(`Unknown command output of ${r}`)}},nt=r=>{t.inspectCommand$Received(Q.Command$Received,r);const{Command$:i,arg:m}=r,y=Ve(i);re(i),y.subject.next(m)},nn=(r,i)=>{tt(r.domainSubscriptionSet,i),i.add(()=>{a.add(r),ne()})},rn=(r,i)=>{const m=F(r);return m.observable.subscribe(i)},on=(r,i)=>de(r).observable.subscribe(i),sn=r=>{const i={};for(const m in r.command){const y=r.command[m];i[m]=v=>ot(y(v))}return i},an=r=>{const i=I(r);if(i.domainOutput)return i.domainOutput;const m=i.domain,y=sn(m),v=k($({},m),{command:y});return i.domainOutput=v,v},cn=r=>{for(const i of r)re(i)},un=r=>{if(!r.running){r.running=!0;for(const i of r.upstreamSet){const m=rt(i.domainPayload);tt(r.upstreamSubscriptionSet,m)}cn(r.command$Set)}},rt=r=>{const i=I(r),m=new B;return nn(i,m),un(i),m},fn=()=>{t.destroyInspectors();for(const r of c.values())Pe(r);c.clear(),o.clear()},ot=r=>{r.type==="RemeshCommandPayload"?(et(r),qe()):r.type==="RemeshCommand$Payload"&&nt(r)};return{name:n.name,getDomain:an,query:Ye,emitEvent:Be,sendCommand:ot,destroy:fn,subscribeQuery:rn,subscribeEvent:on,subscribeDomain:rt,getKey:C}},yt=e=>{for(const n of e)n.unsubscribe()},Ft={domain:Ie,extern:ir,store:Wt,state:me,query:$e,command:Tt,command$:xe,commandAsync:Lt};var Kt={exports:{}},Pt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y=N.exports;function lr(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var mr=typeof Object.is=="function"?Object.is:lr,dr=Y.useState,pr=Y.useEffect,hr=Y.useLayoutEffect,yr=Y.useDebugValue;function vr(e,n){var t=n(),o=dr({inst:{value:t,getSnapshot:n}}),s=o[0].inst,a=o[1];return hr(function(){s.value=t,s.getSnapshot=n,ge(s)&&a({inst:s})},[e,t,n]),pr(function(){return ge(s)&&a({inst:s}),e(function(){ge(s)&&a({inst:s})})},[e]),yr(t),t}function ge(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!mr(e,t)}catch{return!0}}function Sr(e,n){return n()}var gr=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?Sr:vr;Pt.useSyncExternalStore=Y.useSyncExternalStore!==void 0?Y.useSyncExternalStore:gr;Kt.exports=Pt;const zt=N.exports.createContext(null),br=()=>{const e=N.exports.useContext(zt);if(e===null)throw new Error("You may forget to add <RemeshRoot />");return e},ke=()=>br().remeshStore,kr=e=>{const n=N.exports.useRef(e.store);n.current||(n.current=Wt("options"in e?e.options:{}));const t=n.current,o=N.exports.useMemo(()=>({remeshStore:t}),[t]);return pn(zt.Provider,{value:o,children:e.children})},Nr=function(e){wr(e.Query.owner);const n=ke(),t=N.exports.useRef(null),o=N.exports.useCallback(h=>(t.current=h,()=>{t.current=null}),[]),s=N.exports.useCallback(()=>n.query(e),[n,e]),a=Kt.exports.useSyncExternalStore(o,s),c=N.exports.useRef(null),d=n.getKey(e);return N.exports.useEffect(()=>()=>{var h;(h=c.current)==null||h.unsubscribe(),c.current=null},[n,d]),N.exports.useEffect(()=>{c.current===null&&(c.current=n.subscribeQuery(e,()=>{var h;(h=t.current)==null||h.call(t)}))},[n,e]),a},Qr=function(e,n){const t=ke(),o=N.exports.useRef(n);N.exports.useEffect(()=>{o.current=n}),N.exports.useEffect(()=>{const s=t.subscribeEvent(e,a=>{o.current(a)});return()=>{s.unsubscribe()}},[e,t])},wr=function(e){const n=ke(),t=N.exports.useRef(null),o=n.getDomain(e),s=n.getKey(e);return N.exports.useEffect(()=>()=>{var a;(a=t.current)==null||a.unsubscribe(),t.current=null},[n,s]),N.exports.useEffect(()=>{t.current===null&&(t.current=n.subscribeDomain(e))},[n,e]),o},Er=e=>{const n=e.getHours().toString().padStart(2,"0"),t=e.getMinutes().toString().padStart(2,"0"),o=e.getSeconds().toString().padStart(2,"0"),s=e.getMilliseconds().toString().padStart(3,"0");return`${n}:${t}:${o}.${s}`},Rr=()=>{const e=new Date;return Er(e)},Yt=e=>{const n=$({include:["state","domain","event","command","command$"]},e);return{onActive:(o,s)=>{var a;(a=n.exclude)!=null&&a.includes(o)||(n.include?n.include.includes(o)&&s():s())}}},Cr=()=>{if(typeof window!="undefined")return window.__REDUX_DEVTOOLS_EXTENSION__},Ar=e=>{const n=Cr();if(!!n)return t=>{var l;const o=Yt(e),s=n.connect({name:t==null?void 0:t.name,features:{pause:!1,lock:!1,persist:!1,export:!1,import:!1,jump:!1,skip:!1,reorder:!1,dispatch:!1,test:!1}}),a=(u,f)=>{s.send(f,null)},c=Ft.store({name:`RemeshReduxDevtools(${(l=t==null?void 0:t.name)!=null?l:""})`}),d=c.getDomain(O()),h=u=>{const f={domainId:u.Domain.domainId,domainName:u.Domain.domainName};return u.arg!==void 0?k($({},f),{domainArg:u.arg}):f};return o.onActive("domain",()=>{c.subscribeEvent(d.event.RemeshDomainStorageEvent,u=>{const f=u.storage.Domain,p={type:`${u.type}::${f.domainName}`,domainId:f.domainId,domainName:f.domainName};u.storage.arg!==void 0?a(p.type,k($({},p),{domainArg:u.storage.arg})):a(p.type,p)})}),o.onActive("state",()=>{c.subscribeEvent(d.event.RemeshStateStorageEvent,u=>{const f=u.storage.State,p={type:`${u.type}::${f.stateName}`,owner:h(f.owner),stateId:f.stateId,stateName:f.stateName,stateValue:u.storage.currentState};u.storage.arg!==void 0?a(p.type,k($({},p),{stateArg:u.storage.arg})):a(p.type,p)})}),o.onActive("query",()=>{c.subscribeEvent(d.event.RemeshQueryStorageEvent,u=>{const f=u.storage.Query,p={type:`${u.type}::${f.queryName}`,owner:h(f.owner),queryId:f.queryId,queryName:f.queryName};u.storage.arg!==void 0?a(p.type,k($({},p),{queryArg:u.storage.arg})):a(p.type,p)})}),o.onActive("command",()=>{c.subscribeEvent(d.event.RemeshCommandReceivedEvent,u=>{const f=u.payload.Command,p={type:`${u.type}::${f.commandName}`,owner:h(f.owner),commandId:f.commandId,commandName:f.commandName};u.payload.arg!==void 0?a(p.type,k($({},p),{commandArg:u.payload.arg})):a(p.type,p)})}),o.onActive("command$",()=>{c.subscribeEvent(d.event.RemeshCommand$ReceivedEvent,u=>{const f=u.payload.Command$,p={type:`${u.type}::${f.command$Name}`,owner:h(f.owner),command$Id:f.command$Id,command$Name:f.command$Name};u.payload.arg!==void 0?a(p.type,k($({},p),{command$Arg:u.payload.arg})):a(p.type,p)})}),o.onActive("event",()=>{c.subscribeEvent(d.event.RemeshEventEmittedEvent,u=>{const f=u.payload.Event,p={type:`${u.type}::${f.eventName}`,owner:h(f.owner),eventId:f.eventId,eventName:f.eventName};u.payload.arg!==void 0?a(p.type,k($({},p),{eventArg:u.payload.arg})):a(p.type,p)})}),c}},Mr=e=>n=>{var h;const t=$({collapsed:!0},e),o=Yt(t),s=(l,u)=>{if(t.collapsed){const f=l.split("::");console.groupCollapsed(`%c${f[0]}%c::%c${f[1]}%c::%c${f[2]}%c @ ${Rr()}`,"color:#03A9F4; font-weight: bold","color:#9E9E9E; font-weight: bold","color:#4CAF50; font-weight: bold","color:#9E9E9E; font-weight: bold","color:#AA07DE; font-weight: bold","color:#9E9E9E; font-weight: lighter")}console.log(u),t.collapsed&&console.groupEnd()},a=Ft.store(k($({},n),{name:`RemeshLogger(${(h=n==null?void 0:n.name)!=null?h:""})`})),c=a.getDomain(O()),d=l=>{const u={domainId:l.Domain.domainId,domainName:l.Domain.domainName};return l.arg!==void 0?k($({},u),{domainArg:l.arg}):u};return o.onActive("domain",()=>{a.subscribeEvent(c.event.RemeshDomainStorageEvent,l=>{const u=l.storage.Domain,f={type:`${l.type}::${u.domainName}`,domainId:u.domainId,domainName:u.domainName};l.storage.arg!==void 0?s(f.type,k($({},f),{domainArg:l.storage.arg})):s(f.type,f)})}),o.onActive("state",()=>{a.subscribeEvent(c.event.RemeshStateStorageEvent,l=>{const u=l.storage.State,f={type:`${l.type}::${u.stateName}`,owner:d(u.owner),stateId:u.stateId,stateName:u.stateName,stateValue:l.storage.currentState};l.storage.arg!==void 0?s(f.type,k($({},f),{stateArg:l.storage.arg})):s(f.type,f)})}),o.onActive("query",()=>{a.subscribeEvent(c.event.RemeshQueryStorageEvent,l=>{const u=l.storage.Query,f={type:`${l.type}::${u.queryName}`,owner:d(u.owner),queryId:u.queryId,queryName:u.queryName,queryValue:l.storage.currentValue};l.storage.arg!==void 0?s(f.type,k($({},f),{queryArg:l.storage.arg})):s(f.type,f)})}),o.onActive("command",()=>{a.subscribeEvent(c.event.RemeshCommandReceivedEvent,l=>{const u=l.payload.Command,f={type:`${l.type}::${u.commandName}`,owner:d(u.owner),commandId:u.commandId,commandName:u.commandName};l.payload.arg!==void 0?s(f.type,k($({},f),{commandArg:l.payload.arg})):s(f.type,f)})}),o.onActive("command$",()=>{a.subscribeEvent(c.event.RemeshCommand$ReceivedEvent,l=>{const u=l.payload.Command$,f={type:`${l.type}::${u.command$Name}`,owner:d(u.owner),command$Id:u.command$Id,command$Name:u.command$Name};l.payload.arg!==void 0?s(f.type,k($({},f),{command$Arg:l.payload.arg})):s(f.type,f)})}),o.onActive("event",()=>{a.subscribeEvent(c.event.RemeshEventEmittedEvent,l=>{const u=l.payload.Event,f={type:`${l.type}::${u.eventName}`,owner:d(u.owner),eventId:u.eventId,eventName:u.eventName};l.payload.arg!==void 0?s(f.type,k($({},f),{eventArg:l.payload.arg})):s(f.type,f)})}),a};export{A as O,Ft as R,B as S,ce as _,ie as a,T as b,j as c,Nr as d,Gn as e,Ar as f,Mr as g,kr as h,Dn as i,Hn as j,xr as k,Ir as l,Ot as m,ft as n,H as o,Mn as p,fe as q,q as r,Zn as s,we as t,wr as u,An as v,Qr as w,x};
//# sourceMappingURL=remesh-logger.3b445c02.js.map
