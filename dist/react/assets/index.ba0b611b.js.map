{"version":3,"file":"index.ba0b611b.js","sources":["../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/dateTimestampProvider.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/Action.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/intervalProvider.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncAction.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/Scheduler.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncScheduler.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/scheduler/async.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/util/isDate.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/observable/timer.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/take.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/ignoreElements.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/mapTo.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/delayWhen.js","../../../node_modules/.pnpm/rxjs@7.5.6/node_modules/rxjs/dist/esm5/internal/operators/delay.js","../../../projects/react-demos/src/chess/context/game.ts","../../../projects/react-demos/src/chess/components/Board.tsx","../../../projects/domains/src/chess/index.ts","../../../projects/react-demos/src/chess/components/Chess.tsx","../../../projects/react-demos/src/chess/components/Marker.tsx","../../../projects/react-demos/src/chess/ChessGame.tsx","../../../projects/react-demos/src/chess/index.tsx"],"sourcesContent":["export var dateTimestampProvider = {\n    now: function () {\n        return (dateTimestampProvider.delegate || Date).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=dateTimestampProvider.js.map","import { __extends } from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = (function (_super) {\n    __extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var intervalProvider = {\n    setInterval: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = intervalProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setInterval) {\n            return delegate.setInterval.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setInterval.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearInterval: function (handle) {\n        var delegate = intervalProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearInterval) || clearInterval)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=intervalProvider.js.map","import { __extends } from \"tslib\";\nimport { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nvar AsyncAction = (function (_super) {\n    __extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, _id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (_scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        intervalProvider.clearInterval(id);\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, _delay) {\n        var errored = false;\n        var errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            var _a = this, id = _a.id, scheduler = _a.scheduler;\n            var actions = scheduler.actions;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            _super.prototype.unsubscribe.call(this);\n        }\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map","import { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar Scheduler = (function () {\n    function Scheduler(schedulerActionCtor, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        this.schedulerActionCtor = schedulerActionCtor;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) { delay = 0; }\n        return new this.schedulerActionCtor(this, work).schedule(state, delay);\n    };\n    Scheduler.now = dateTimestampProvider.now;\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map","import { __extends } from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = (function (_super) {\n    __extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        var _this = _super.call(this, SchedulerAction, now) || this;\n        _this.actions = [];\n        _this._active = false;\n        _this._scheduled = undefined;\n        return _this;\n    }\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this._active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this._active = true;\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions.shift()));\n        this._active = false;\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var asyncScheduler = new AsyncScheduler(AsyncAction);\nexport var async = asyncScheduler;\n//# sourceMappingURL=async.js.map","export function isValidDate(value) {\n    return value instanceof Date && !isNaN(value);\n}\n//# sourceMappingURL=isDate.js.map","import { Observable } from '../Observable';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\nexport function timer(dueTime, intervalOrScheduler, scheduler) {\n    if (dueTime === void 0) { dueTime = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var intervalDuration = -1;\n    if (intervalOrScheduler != null) {\n        if (isScheduler(intervalOrScheduler)) {\n            scheduler = intervalOrScheduler;\n        }\n        else {\n            intervalDuration = intervalOrScheduler;\n        }\n    }\n    return new Observable(function (subscriber) {\n        var due = isValidDate(dueTime) ? +dueTime - scheduler.now() : dueTime;\n        if (due < 0) {\n            due = 0;\n        }\n        var n = 0;\n        return scheduler.schedule(function () {\n            if (!subscriber.closed) {\n                subscriber.next(n++);\n                if (0 <= intervalDuration) {\n                    this.schedule(undefined, intervalDuration);\n                }\n                else {\n                    subscriber.complete();\n                }\n            }\n        }, due);\n    });\n}\n//# sourceMappingURL=timer.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nexport function ignoreElements() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, noop));\n    });\n}\n//# sourceMappingURL=ignoreElements.js.map","import { map } from './map';\nexport function mapTo(value) {\n    return map(function () { return value; });\n}\n//# sourceMappingURL=mapTo.js.map","import { concat } from '../observable/concat';\nimport { take } from './take';\nimport { ignoreElements } from './ignoreElements';\nimport { mapTo } from './mapTo';\nimport { mergeMap } from './mergeMap';\nexport function delayWhen(delayDurationSelector, subscriptionDelay) {\n    if (subscriptionDelay) {\n        return function (source) {\n            return concat(subscriptionDelay.pipe(take(1), ignoreElements()), source.pipe(delayWhen(delayDurationSelector)));\n        };\n    }\n    return mergeMap(function (value, index) { return delayDurationSelector(value, index).pipe(take(1), mapTo(value)); });\n}\n//# sourceMappingURL=delayWhen.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { delayWhen } from './delayWhen';\nimport { timer } from '../observable/timer';\nexport function delay(due, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration = timer(due, scheduler);\n    return delayWhen(function () { return duration; });\n}\n//# sourceMappingURL=delay.js.map","import React from 'react'\r\n\r\ntype GameConfigContextValue = {\r\n  left: number\r\n  top: number\r\n  gridSize: number\r\n  chessSize: number\r\n}\r\n\r\nexport const GameConfigContext = React.createContext<GameConfigContextValue>({\r\n  left: 0,\r\n  top: 0,\r\n  gridSize: 60,\r\n  chessSize: 40,\r\n})\r\n","import React, { useContext } from 'react'\r\nimport { GameConfigContext } from '../context/game'\r\n\r\n// 棋盘画线辅助计算\r\nconst createPathArr = (config: { left: number; top: number; gridSize: number }) => {\r\n  const { left: baseLeft, top: baseTop, gridSize } = config\r\n\r\n  const left = baseLeft + gridSize / 2\r\n  const top = baseTop + gridSize / 2\r\n\r\n  // 生成线的路径\r\n  const line = (x1: number, y1: number, x2: number, y2: number) => {\r\n    return `M${left + x1 * gridSize},${top + y1 * gridSize} L${left + x2 * gridSize},${top + y2 * gridSize}`\r\n  }\r\n\r\n  // 生成十字花\r\n  const star = (x: number, y: number) => {\r\n    const arr = []\r\n    const distance = 1 / 10\r\n    const length = 1 / 4\r\n\r\n    let startX, startY, endX, endY\r\n\r\n    // 左边画一半\r\n    if (x != 0) {\r\n      startX = x - distance\r\n      startY = y - distance - length\r\n      endX = x - distance - length\r\n      endY = y - distance\r\n\r\n      arr.push(line(startX, startY, startX, endY))\r\n      arr.push(line(startX, endY, endX, endY))\r\n\r\n      startY = y + distance + length\r\n      endY = y + distance\r\n\r\n      arr.push(line(startX, startY, startX, endY))\r\n      arr.push(line(startX, endY, endX, endY))\r\n    }\r\n\r\n    // 右边画一半\r\n    if (x != 8) {\r\n      startX = x + distance\r\n      startY = y - distance - length\r\n      endX = x + distance + length\r\n      endY = y - distance\r\n\r\n      arr.push(line(startX, startY, startX, endY))\r\n      arr.push(line(startX, endY, endX, endY))\r\n\r\n      startY = y + distance + length\r\n      endY = y + distance\r\n\r\n      arr.push(line(startX, startY, startX, endY))\r\n      arr.push(line(startX, endY, endX, endY))\r\n    }\r\n\r\n    return arr\r\n  }\r\n\r\n  const arr: string[] = [\r\n    // 炮位\r\n    [1, 2],\r\n    [7, 2],\r\n    [1, 7],\r\n    [7, 7],\r\n    // 兵位\r\n    [0, 3],\r\n    [2, 3],\r\n    [4, 3],\r\n    [6, 3],\r\n    [8, 3],\r\n    [0, 6],\r\n    [2, 6],\r\n    [4, 6],\r\n    [6, 6],\r\n    [8, 6],\r\n  ]\r\n    .map(([x, y]) => star(x, y))\r\n    .reduce((acc, cur) => acc.concat(cur), [])\r\n    // 横线\r\n    .concat(new Array(8).fill(0).map((_, i) => line(0, i + 1, 8, i + 1)))\r\n    // 竖线，被楚河汉界分成两段\r\n    .concat(new Array(7).fill(0).map((_, i) => line(i + 1, 0, i + 1, 4)))\r\n    .concat(new Array(7).fill(0).map((_, i) => line(i + 1, 5, i + 1, 9)))\r\n    // 九宫格的线\r\n    .concat([line(3, 0, 5, 2), line(5, 0, 3, 2), line(3, 7, 5, 9), line(3, 9, 5, 7)])\r\n\r\n  return arr\r\n}\r\n\r\nexport const BoardRender = () => {\r\n  const config = useContext(GameConfigContext)\r\n\r\n  const { left: baseLeft, top: baseTop, gridSize, chessSize } = config\r\n\r\n  const left = baseLeft + gridSize / 2\r\n  const top = baseTop + gridSize / 2\r\n  const width = gridSize * 8\r\n  const height = gridSize * 9\r\n\r\n  const pathArr = createPathArr(config)\r\n\r\n  const svgStyle: React.SVGAttributes<SVGSVGElement>['style'] = {\r\n    position: 'absolute',\r\n    left: 0,\r\n    top: 0,\r\n    width: width + chessSize,\r\n    height: height + chessSize,\r\n  }\r\n\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" style={svgStyle}>\r\n      <g>\r\n        <rect x={left} y={top} width={width} height={height} fill=\"none\" stroke=\"#000000\" strokeWidth=\"3\"></rect>\r\n        {pathArr.map((path, i) => (\r\n          <path key={i} fill=\"none\" stroke=\"#000000\" d={path}></path>\r\n        ))}\r\n      </g>\r\n    </svg>\r\n  )\r\n}\r\n","import { Remesh } from 'remesh'\r\nimport { delay, filter, map } from 'rxjs/operators'\r\n\r\nexport enum ChessValue {\r\n  General = 100,\r\n  Chariot = 50,\r\n  Cannon = 30,\r\n  Horse = 29,\r\n  Elephant = 16,\r\n  Guard = 10,\r\n  Soldier = 1,\r\n}\r\n\r\nexport enum ChessColor {\r\n  Red = 1,\r\n  Black = -1,\r\n}\r\n\r\nexport type Position = {\r\n  x: number\r\n  y: number\r\n}\r\n\r\nexport type Chess = {\r\n  color: ChessColor // 棋子什么颜色\r\n  value: ChessValue // 是哪种棋子\r\n  selected?: boolean // 是否被选中\r\n  marked?: boolean // 是否被标记为可攻击\r\n  position: Position // 当前位置\r\n}\r\n\r\nexport type Marker = Position\r\n\r\nexport type Game = {\r\n  currentPlayer: ChessColor\r\n  selectedChess?: Chess\r\n  situation: Chess[]\r\n  markers: Marker[]\r\n}\r\n\r\nexport type GameStatus = 'red-win' | 'black-win' | 'playing'\r\n\r\n/**\r\n * 帮助函数\r\n */\r\n/**\r\n * 判断两个位置是否相同\r\n * @param pos1 第一个位置\r\n * @param pos2 第二个位置\r\n * @returns boolean，是否相同\r\n */\r\nconst isSamePosition = (pos1: Position, pos2: Position) => {\r\n  return pos1.x === pos2.x && pos1.y === pos2.y\r\n}\r\n\r\n/**\r\n * 将的位置是否合法\r\n * @param color 颜色\r\n * @param position 位置\r\n */\r\nconst isGeneralValid = (color: ChessColor, { x, y }: Position) => {\r\n  switch (color) {\r\n    case ChessColor.Black:\r\n      return !(x < 3 || x > 5 || (y > 2 && y < 7))\r\n    case ChessColor.Red:\r\n      return !(x < 3 || x > 5 || (y > 2 && y < 7))\r\n  }\r\n}\r\n\r\n/**\r\n * 士的位置是否合法\r\n * @param color 颜色\r\n * @param position 位置\r\n */\r\nconst isGuardValid = (color: ChessColor, { x, y }: Position) => {\r\n  switch (color) {\r\n    case ChessColor.Black:\r\n      return [\r\n        [3, 0],\r\n        [3, 2],\r\n        [5, 0],\r\n        [5, 2],\r\n        [4, 1],\r\n      ].find(([x1, y1]) => x1 === x && y1 === y)\r\n    case ChessColor.Red:\r\n      return [\r\n        [3, 7],\r\n        [3, 9],\r\n        [5, 7],\r\n        [5, 9],\r\n        [4, 8],\r\n      ].find(([x1, y1]) => x1 === x && y1 === y)\r\n  }\r\n}\r\n\r\n/**\r\n * 象的位置是否合法\r\n * @param color 颜色\r\n * @param position 位置\r\n */\r\nconst isElephantValid = (color: ChessColor, { x, y }: Position) => {\r\n  switch (color) {\r\n    case ChessColor.Black:\r\n      return [\r\n        [0, 2],\r\n        [2, 0],\r\n        [2, 4],\r\n        [4, 2],\r\n        [6, 0],\r\n        [6, 4],\r\n        [8, 2],\r\n      ].find(([x1, y1]) => x1 === x && y1 === y)\r\n    case ChessColor.Red:\r\n      return [\r\n        [0, 7],\r\n        [2, 5],\r\n        [2, 9],\r\n        [4, 7],\r\n        [6, 5],\r\n        [6, 9],\r\n        [8, 7],\r\n      ].find(([x1, y1]) => x1 === x && y1 === y)\r\n  }\r\n}\r\n\r\n/**\r\n * 兵的位置是否合法\r\n * @param color 颜色\r\n * @param position 位置\r\n */\r\nconst isSoldierValid = (color: ChessColor, { x, y }: Position) => {\r\n  switch (color) {\r\n    case ChessColor.Black:\r\n      return !(y < 3 || (y < 5 && x % 2 === 1))\r\n    case ChessColor.Red:\r\n      return !(y > 6 || (y > 4 && x % 2 === 1))\r\n  }\r\n}\r\n\r\nconst canCannonAttack =\r\n  (game: Game) =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    // 不在一条直线上，不能走\r\n    if (source.x !== x && source.y !== y) {\r\n      return false\r\n    }\r\n\r\n    // 先检测目标位置有无棋子\r\n    if (game.situation.find((chess) => chess.position.x === x && chess.position.y === y)) {\r\n      // 目标位置非空，吃子的逻辑，检测中间时候有且仅有一个棋子\r\n      // 同一水平线\r\n      if (source.y === y) {\r\n        return (\r\n          game.situation.filter(\r\n            (chess) => chess.position.y === y && (chess.position.x - x) * (chess.position.x - source.x) < 0,\r\n          ).length === 1\r\n        )\r\n      }\r\n\r\n      // 同一竖直线\r\n      if (source.x === x) {\r\n        return (\r\n          game.situation.filter(\r\n            (chess) => chess.position.x === x && (chess.position.y - y) * (chess.position.y - source.y) < 0,\r\n          ).length === 1\r\n        )\r\n      }\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n// 将可以去哪里吗\r\nconst canGeneralMove =\r\n  () =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    return Math.abs(source.y - y) + Math.abs(source.x - x) === 1\r\n  }\r\n\r\n// 士可以去哪里吗\r\nconst canGuardMove =\r\n  () =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    const square = (a: number) => a * a\r\n\r\n    return square(source.x - x) + square(source.y - y) === 2\r\n  }\r\n\r\n// 象可以去哪里吗\r\nconst canElephantMove =\r\n  (game: Game) =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    if (Math.abs(source.x - x) !== 2 || Math.abs(source.y - y) !== 2) {\r\n      return false\r\n    } else {\r\n      // 象眼位置没有棋子\r\n      return !game.situation.find(\r\n        (chess) => chess.position.x === (source.x + x) / 2 && chess.position.y === (source.y + y) / 2,\r\n      )\r\n    }\r\n  }\r\n\r\n// 马可以去哪里吗\r\nconst canHorseMove =\r\n  (game: Game) =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    const dx = source.x - x\r\n    const dy = source.y - y\r\n\r\n    // 马走日，并且马腿的位置没有棋子\r\n    return (\r\n      dx * dx + dy * dy === 5 &&\r\n      !game.situation.find(\r\n        (chess) =>\r\n          chess.position.x === Math.round((2 * source.x + x) / 3) &&\r\n          chess.position.y === Math.round((2 * source.y + y) / 3),\r\n      )\r\n    )\r\n  }\r\n\r\n// 能走直线吗\r\nconst canMoveStraightly =\r\n  (game: Game) =>\r\n  ({ position: source }: Chess, { x, y }: Position) => {\r\n    // 不在一条直线上，不能走\r\n    if (source.x !== x && source.y !== y) {\r\n      return false\r\n    }\r\n\r\n    // 同一条水平线，中间无棋子\r\n    if (source.y === y) {\r\n      return !game.situation.find(\r\n        (chess) => chess.position.y === y && (chess.position.x - x) * (chess.position.x - source.x) < 0,\r\n      )\r\n    }\r\n\r\n    // 同一竖直线，中间无棋子\r\n    if (source.x === x) {\r\n      return !game.situation.find(\r\n        (chess) => chess.position.x === x && (chess.position.y - y) * (chess.position.y - source.y) < 0,\r\n      )\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n// 兵可以去哪里吗\r\nconst canSoldierMove =\r\n  () =>\r\n  ({ position: source, color }: Chess, { x, y }: Position) => {\r\n    switch (color) {\r\n      case ChessColor.Black:\r\n        return y >= source.y && Math.abs(x - source.x) + Math.abs(y - source.y) === 1\r\n      case ChessColor.Red:\r\n        return y <= source.y && Math.abs(x - source.x) + Math.abs(y - source.y) === 1\r\n    }\r\n  }\r\n\r\n/**\r\n * 判断在当前棋局下，某个棋子能否移动到目的位置，有些棋子的移动需要结合棋盘状态，此处不检测目标位置是否有棋子\r\n * @param game 棋盘状态\r\n */\r\nconst canMove = (game: Game) => (chess: Chess, position: Position) => {\r\n  const { color, value } = chess\r\n  switch (value) {\r\n    case ChessValue.General:\r\n      return isGeneralValid(color, position) && canGeneralMove()(chess, position)\r\n    case ChessValue.Guard:\r\n      return isGuardValid(color, position) && canGuardMove()(chess, position)\r\n    case ChessValue.Elephant:\r\n      return isElephantValid(color, position) && canElephantMove(game)(chess, position)\r\n    case ChessValue.Horse:\r\n      return canHorseMove(game)(chess, position)\r\n    case ChessValue.Chariot:\r\n      return canMoveStraightly(game)(chess, position)\r\n    case ChessValue.Cannon:\r\n      return canMoveStraightly(game)(chess, position)\r\n    case ChessValue.Soldier:\r\n      return isSoldierValid(color, position) && canSoldierMove()(chess, position)\r\n  }\r\n}\r\n\r\n/**\r\n * 判断在当前棋局下，某个棋子能否攻击目标位置\r\n * @param game 棋盘状态\r\n */\r\nconst canAttack = (game: Game) => (chess: Chess, dest: Chess) => {\r\n  if (chess.color === dest.color) {\r\n    // 不能吃自己的棋子\r\n    return false\r\n  }\r\n\r\n  if (chess.value === ChessValue.Cannon) {\r\n    return canCannonAttack(game)(chess, dest.position)\r\n  } else {\r\n    return (\r\n      game.situation.find((chess) => isSamePosition(chess.position, dest.position)) &&\r\n      canMove(game)(chess, dest.position)\r\n    )\r\n  }\r\n}\r\n\r\n// 标记某个棋子为选中\r\nconst select = (chess: Chess) => {\r\n  return {\r\n    ...chess,\r\n    selected: true,\r\n  }\r\n}\r\n\r\n// 取消某个棋子的选中状态\r\nconst unselect = (chess: Chess) => {\r\n  return {\r\n    ...chess,\r\n    selected: false,\r\n  }\r\n}\r\n\r\n// 标记为可被攻击\r\nconst mark = (chess: Chess) => {\r\n  return {\r\n    ...chess,\r\n    marked: true,\r\n  }\r\n}\r\n\r\n// 取消可攻击状态\r\nconst unmark = (chess: Chess) => {\r\n  return {\r\n    ...chess,\r\n    marked: false,\r\n  }\r\n}\r\n\r\n/**\r\n * 移动棋子到指定位置\r\n * @param chess 待移动的棋子状态\r\n * @param position 位置\r\n */\r\nconst move = (position: Position) => {\r\n  return (chess: Chess) => {\r\n    return {\r\n      ...chess,\r\n      position,\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 在当前棋局中选中指定位置的棋子\r\n * @param position 目标位置\r\n */\r\nconst selectChessInGame =\r\n  (position: Position) =>\r\n  (game: Game): Game => {\r\n    const { currentPlayer, situation } = game\r\n    const { x, y } = position\r\n\r\n    let newSelectedChess: Chess | undefined\r\n    const newSituation = situation\r\n      .map((chess) => unmark(unselect(chess)))\r\n      .map((chess) => {\r\n        if (chess.position.x === x && chess.position.y === y) {\r\n          newSelectedChess = select(chess)\r\n          return newSelectedChess\r\n        } else {\r\n          return chess\r\n        }\r\n      })\r\n      .map((chess) => {\r\n        if (canAttack(game)(newSelectedChess!, chess)) {\r\n          return mark(chess)\r\n        } else {\r\n          return chess\r\n        }\r\n      })\r\n\r\n    const markers: Marker[] = new Array(90)\r\n      .fill(null)\r\n      .map((v, index) => {\r\n        const x = index % 9\r\n        const y = (index - x) / 9\r\n        return { x, y }\r\n      })\r\n      .filter((v) => canMove(game)(newSelectedChess!, v))\r\n\r\n    return {\r\n      currentPlayer,\r\n      selectedChess: newSelectedChess,\r\n      situation: newSituation,\r\n      markers,\r\n    }\r\n  }\r\n\r\n/**\r\n * 在当前棋局中，把选中的棋子移动到指定位置\r\n * @param position 目标位置\r\n */\r\nconst moveChessInGame =\r\n  (position: Position) =>\r\n  (game: Game): Game => {\r\n    const { currentPlayer, situation, selectedChess } = game\r\n\r\n    if (selectedChess && canMove(game)(selectedChess, position)) {\r\n      const { x, y } = selectedChess.position\r\n      const newSituation = situation\r\n        .map((chess) => {\r\n          if (chess.position.x === x && chess.position.y === y) {\r\n            return move(position)(chess)\r\n          } else {\r\n            return chess\r\n          }\r\n        })\r\n        // 走完之后，去掉棋子的选中和标记状态\r\n        .map((chess) => unmark(unselect(chess)))\r\n\r\n      return {\r\n        currentPlayer: -currentPlayer,\r\n        selectedChess: undefined,\r\n        situation: newSituation,\r\n        markers: [],\r\n      }\r\n    }\r\n    return game\r\n  }\r\n\r\n/**\r\n * 在当前棋局中，用选中的棋子攻击指定位置\r\n * @param position 目标位置\r\n */\r\nconst attack =\r\n  (position: Position) =>\r\n  (game: Game): Game => {\r\n    const { currentPlayer, situation, selectedChess } = game\r\n\r\n    // 要攻击的棋子\r\n    const dest = situation.find((chess) => chess.position.x === position.x && chess.position.y === position.y)\r\n\r\n    if (selectedChess && dest && canAttack(game)(selectedChess, dest)) {\r\n      const { x, y } = selectedChess.position\r\n      const newSituation = situation\r\n        .map((chess) => {\r\n          // 吃别人的，自己移动到对方位置\r\n          if (chess.position.x === x && chess.position.y === y) {\r\n            return move(position)(chess)\r\n          }\r\n\r\n          // 被吃的，拿掉\r\n          if (chess.position.x === position.x && chess.position.y === position.y) {\r\n            return null\r\n          }\r\n\r\n          // 其他保持原样\r\n          return chess\r\n        })\r\n        .filter((chess) => !!chess)\r\n        // 走完之后，去掉棋子的选中和标记状态\r\n        .map((chess) => unmark(unselect(chess as Chess)))\r\n\r\n      return {\r\n        currentPlayer: -currentPlayer,\r\n        selectedChess: undefined,\r\n        situation: newSituation,\r\n        markers: [],\r\n      }\r\n    }\r\n    return game\r\n  }\r\n\r\nconst getGameStatus = (situation: Game['situation']): GameStatus => {\r\n  const blackWin = !situation.some((chess) => {\r\n    return chess.color === ChessColor.Red && chess.value === ChessValue.General\r\n  })\r\n\r\n  if (blackWin) {\r\n    return 'black-win'\r\n  }\r\n\r\n  const redWin = !situation.some((chess) => {\r\n    return chess.color === ChessColor.Black && chess.value === ChessValue.General\r\n  })\r\n\r\n  if (redWin) {\r\n    return 'red-win'\r\n  }\r\n\r\n  return 'playing'\r\n}\r\n\r\nconst defaultSituation: Chess[] = [\r\n  { color: ChessColor.Black, value: ChessValue.Chariot, position: { x: 0, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Horse, position: { x: 1, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Elephant, position: { x: 2, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Guard, position: { x: 3, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.General, position: { x: 4, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Guard, position: { x: 5, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Elephant, position: { x: 6, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Horse, position: { x: 7, y: 0 } },\r\n  { color: ChessColor.Black, value: ChessValue.Chariot, position: { x: 8, y: 0 } },\r\n\r\n  { color: ChessColor.Black, value: ChessValue.Cannon, position: { x: 1, y: 2 } },\r\n  { color: ChessColor.Black, value: ChessValue.Cannon, position: { x: 7, y: 2 } },\r\n\r\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 0, y: 3 } },\r\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 2, y: 3 } },\r\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 4, y: 3 } },\r\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 6, y: 3 } },\r\n  { color: ChessColor.Black, value: ChessValue.Soldier, position: { x: 8, y: 3 } },\r\n\r\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 0, y: 6 } },\r\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 2, y: 6 } },\r\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 4, y: 6 } },\r\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 6, y: 6 } },\r\n  { color: ChessColor.Red, value: ChessValue.Soldier, position: { x: 8, y: 6 } },\r\n\r\n  { color: ChessColor.Red, value: ChessValue.Cannon, position: { x: 1, y: 7 } },\r\n  { color: ChessColor.Red, value: ChessValue.Cannon, position: { x: 7, y: 7 } },\r\n\r\n  { color: ChessColor.Red, value: ChessValue.Chariot, position: { x: 0, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Horse, position: { x: 1, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Elephant, position: { x: 2, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Guard, position: { x: 3, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.General, position: { x: 4, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Guard, position: { x: 5, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Elephant, position: { x: 6, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Horse, position: { x: 7, y: 9 } },\r\n  { color: ChessColor.Red, value: ChessValue.Chariot, position: { x: 8, y: 9 } },\r\n]\r\n\r\nexport const GameDomain = Remesh.domain({\r\n  name: 'GameDomain',\r\n  impl: (domain) => {\r\n    const defaultGameState = {\r\n      currentPlayer: ChessColor.Red,\r\n      selectedChess: undefined,\r\n      situation: defaultSituation,\r\n      markers: [],\r\n    }\r\n\r\n    const GameState = domain.state<Game>({\r\n      name: 'GameState',\r\n      default: defaultGameState,\r\n    })\r\n\r\n    const GameQuery = domain.query({\r\n      name: 'GameQuery',\r\n      impl: ({ get }) => {\r\n        return get(GameState())\r\n      },\r\n    })\r\n\r\n    const GameStatusQuery = domain.query({\r\n      name: 'GameStatusQuery',\r\n      impl: ({ get }): GameStatus => {\r\n        const { situation } = get(GameQuery())\r\n        return getGameStatus(situation)\r\n      },\r\n    })\r\n\r\n    const GameOverEvent = domain.event({\r\n      name: 'GameOverEvent',\r\n    })\r\n\r\n    const NotYourMoveEvent = domain.event({\r\n      name: 'NotYourMoveEvent',\r\n    })\r\n\r\n    const ResetGameStateCommand = domain.command({\r\n      name: 'ResetGameStateCommand',\r\n      impl: () => {\r\n        return GameState().new(defaultGameState)\r\n      },\r\n    })\r\n\r\n    const SelectChessCommand = domain.command({\r\n      name: 'SelectChessCommand',\r\n      impl({ get }, chess: Chess) {\r\n        const gameStatus = get(GameStatusQuery())\r\n\r\n        if (gameStatus !== 'playing') {\r\n          return GameOverEvent()\r\n        }\r\n\r\n        const game = get(GameState())\r\n        const { currentPlayer, selectedChess } = game\r\n\r\n        if (chess.color === currentPlayer) {\r\n          return [GameState().new(selectChessInGame(chess.position)(game))]\r\n        } else {\r\n          if (selectedChess) {\r\n            return [GameState().new(attack(chess.position)(game))]\r\n          } else {\r\n            return [NotYourMoveEvent()]\r\n          }\r\n        }\r\n      },\r\n    })\r\n\r\n    const MoveChessCommand = domain.command({\r\n      name: 'MoveChessCommand',\r\n      impl({ get }, position: Marker) {\r\n        const gameStatus = get(GameStatusQuery())\r\n\r\n        if (gameStatus !== 'playing') {\r\n          return GameOverEvent()\r\n        }\r\n\r\n        const game = get(GameState())\r\n\r\n        const { selectedChess } = game\r\n\r\n        if (selectedChess) {\r\n          return [GameState().new(moveChessInGame(position)(game))]\r\n        } else {\r\n          return [NotYourMoveEvent()]\r\n        }\r\n      },\r\n    })\r\n\r\n    domain.effect({\r\n      name: 'CheckGameStatusEffect',\r\n      impl: ({ fromQuery }) => {\r\n        return fromQuery(GameStatusQuery()).pipe(\r\n          filter((gameStatus) => gameStatus !== 'playing'),\r\n          delay(100),\r\n          map(() => GameOverEvent()),\r\n        )\r\n      },\r\n    })\r\n\r\n    return {\r\n      query: {\r\n        GameQuery,\r\n        GameStatusQuery,\r\n      },\r\n      command: {\r\n        SelectChessCommand,\r\n        MoveChessCommand,\r\n        ResetGameStateCommand,\r\n      },\r\n      event: {\r\n        NotYourMoveEvent,\r\n        GameOverEvent,\r\n      },\r\n    }\r\n  },\r\n})\r\n","import React, { useContext } from 'react'\r\nimport { Chess, ChessColor, ChessValue } from 'remesh-domains-for-demos/dist/chess'\r\nimport { GameConfigContext } from '../context/game'\r\n\r\nconst formatChessColor = (color: ChessColor) => {\r\n  return { [ChessColor.Red]: 'red', [ChessColor.Black]: 'black' }[color]\r\n}\r\n\r\nconst formatChessValue = (color: ChessColor, value: ChessValue) => {\r\n  return {\r\n    [ChessColor.Red]: {\r\n      [ChessValue.General]: '帅',\r\n      [ChessValue.Guard]: '仕',\r\n      [ChessValue.Elephant]: '相',\r\n      [ChessValue.Horse]: '馬',\r\n      [ChessValue.Chariot]: '車',\r\n      [ChessValue.Cannon]: '炮',\r\n      [ChessValue.Soldier]: '兵',\r\n    },\r\n    [ChessColor.Black]: {\r\n      [ChessValue.General]: '将',\r\n      [ChessValue.Guard]: '士',\r\n      [ChessValue.Elephant]: '象',\r\n      [ChessValue.Horse]: '马',\r\n      [ChessValue.Chariot]: '车',\r\n      [ChessValue.Cannon]: '砲',\r\n      [ChessValue.Soldier]: '卒',\r\n    },\r\n  }[color][value]\r\n}\r\n\r\ntype ChessProps = {\r\n  chess: Chess\r\n  onClick: (chess: Chess) => void\r\n}\r\n\r\nexport const ChessRender = (props: ChessProps) => {\r\n  const { chess, onClick } = props\r\n\r\n  const {\r\n    color,\r\n    value,\r\n    position: { x, y },\r\n    selected,\r\n    marked,\r\n  } = chess\r\n\r\n  const { chessSize, gridSize, left, top } = useContext(GameConfigContext)\r\n\r\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\r\n    position: 'absolute',\r\n    zIndex: 10,\r\n    backgroundColor: 'white',\r\n    fontSize: 26,\r\n    textAlign: 'center',\r\n    borderWidth: 2,\r\n    width: chessSize,\r\n    height: chessSize,\r\n    cursor: 'pointer',\r\n    left: left + x * gridSize + (gridSize - chessSize) / 2 - 2,\r\n    top: top + y * gridSize + (gridSize - chessSize) / 2 - 2,\r\n    borderStyle: selected ? 'dashed' : 'solid',\r\n    borderColor: marked ? 'aqua' : formatChessColor(color),\r\n    borderRadius: chessSize / 2 + 1,\r\n    color: formatChessColor(color),\r\n  }\r\n\r\n  return (\r\n    <div onClick={() => onClick(chess)} style={style}>\r\n      {formatChessValue(color, value)}\r\n    </div>\r\n  )\r\n}\r\n","import React, { useContext } from 'react'\r\nimport { Marker } from 'remesh-domains-for-demos/dist/chess'\r\nimport { GameConfigContext } from '../context/game'\r\n\r\ntype MarkerProps = {\r\n  marker: Marker\r\n  onClick: (marker: Marker) => void\r\n}\r\n\r\nexport const MarkerRender = (props: MarkerProps) => {\r\n  const { marker, onClick } = props\r\n  const { x, y } = marker\r\n\r\n  const { chessSize, gridSize, left, top } = useContext(GameConfigContext)\r\n\r\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\r\n    position: 'absolute',\r\n    borderWidth: 2,\r\n    borderStyle: 'dashed',\r\n    borderColor: 'green',\r\n    backgroundColor: 'white',\r\n    width: chessSize / 2,\r\n    height: chessSize / 2,\r\n    left: left + x * gridSize + chessSize / 4 + (gridSize - chessSize) / 2 - 2,\r\n    top: top + y * gridSize + chessSize / 4 + (gridSize - chessSize) / 2 - 2,\r\n  }\r\n\r\n  return <div onClick={() => onClick(marker)} style={style} />\r\n}\r\n","import React, { useContext } from 'react'\r\nimport { useRemeshDomain, useRemeshEvent, useRemeshQuery, useRemeshSend } from 'remesh-react'\r\nimport { BoardRender } from './components/Board'\r\nimport { ChessRender } from './components/Chess'\r\nimport { MarkerRender } from './components/Marker'\r\nimport { GameConfigContext } from './context/game'\r\n\r\nimport { GameDomain } from 'remesh-domains-for-demos/dist/chess'\r\n\r\nexport const ChessGame = () => {\r\n  const send = useRemeshSend()\r\n  const { left, top, gridSize } = useContext(GameConfigContext)\r\n\r\n  const domain = useRemeshDomain(GameDomain())\r\n  const gameState = useRemeshQuery(domain.query.GameQuery())\r\n\r\n  useRemeshEvent(domain.event.NotYourMoveEvent, () => {\r\n    alert('不该你走')\r\n  })\r\n\r\n  useRemeshEvent(domain.event.GameOverEvent, () => {\r\n    const shouldRestart = window.confirm('游戏结束，是否重新开始？')\r\n    if (shouldRestart) {\r\n      send(domain.command.ResetGameStateCommand())\r\n    }\r\n  })\r\n\r\n  const style: React.HTMLAttributes<HTMLDivElement>['style'] = {\r\n    width: left + 9 * gridSize,\r\n    height: top + 10 * gridSize,\r\n  }\r\n\r\n  const { situation, markers } = gameState\r\n\r\n  return (\r\n    <div style={style}>\r\n      <BoardRender />\r\n\r\n      {situation.map((chess, i) => (\r\n        <ChessRender key={i} chess={chess} onClick={() => send(domain.command.SelectChessCommand(chess))} />\r\n      ))}\r\n\r\n      {markers.map((marker, i) => (\r\n        <MarkerRender key={i} marker={marker} onClick={() => send(domain.command.MoveChessCommand(marker))} />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n","import React, { StrictMode } from 'react'\r\nimport * as ReactDOMClient from 'react-dom/client'\r\n\r\nimport { Remesh } from 'remesh'\r\n\r\nimport { RemeshRoot } from 'remesh-react'\r\nimport { RemeshReduxDevtools } from 'remesh-redux-devtools'\r\nimport { RemeshLogger } from 'remesh-logger'\r\n\r\nimport { ChessGame } from './ChessGame'\r\nimport { GameConfigContext } from './context/game'\r\n\r\nconst container = document.getElementById('root')\r\n\r\nif (container) {\r\n  const root = ReactDOMClient.createRoot(container)\r\n  const store = Remesh.store({\r\n    inspectors: [\r\n      RemeshReduxDevtools(),\r\n      RemeshLogger({\r\n        include: ['command', 'query', 'event', 'domain', 'command$', 'state'],\r\n      }),\r\n    ],\r\n  })\r\n\r\n  root.render(\r\n    <StrictMode>\r\n      <RemeshRoot store={store}>\r\n        <GameConfigContext.Provider\r\n          value={{\r\n            left: 0,\r\n            top: 0,\r\n            gridSize: 60,\r\n            chessSize: 40,\r\n          }}\r\n        >\r\n          <ChessGame />\r\n        </GameConfigContext.Provider>\r\n      </RemeshRoot>\r\n    </StrictMode>,\r\n  )\r\n}\r\n"],"names":["dateTimestampProvider","Action","_super","__extends","scheduler","work","state","delay","Subscription","intervalProvider","handler","timeout","args","_i","delegate","__spreadArray","__read","handle","AsyncAction","_this","id","_id","_scheduler","error","_delay","errored","errorValue","e","_a","actions","arrRemove","Scheduler","schedulerActionCtor","now","AsyncScheduler","SchedulerAction","action","asyncScheduler","async","isValidDate","value","timer","dueTime","intervalOrScheduler","intervalDuration","isScheduler","Observable","subscriber","due","n","take","count","EMPTY","operate","source","seen","createOperatorSubscriber","ignoreElements","noop","mapTo","map","delayWhen","delayDurationSelector","subscriptionDelay","concat","mergeMap","index","duration","GameConfigContext","React","createPathArr","config","left","baseLeft","top","baseTop","gridSize","line","x1","y1","x2","y2","star","x","y","arr","startX","startY","endX","endY","distance","length","push","reduce","acc","cur","Array","fill","_","i","BoardRender","useContext","chessSize","width","height","pathArr","svgStyle","position","_jsx","path","ChessValue","ChessColor","isSamePosition","pos1","pos2","isGeneralValid","color","isGuardValid","isElephantValid","isSoldierValid","canCannonAttack","game","chess","canGeneralMove","canGuardMove","square","a","canElephantMove","canHorseMove","dx","dy","canMoveStraightly","canSoldierMove","canMove","canAttack","dest","select","unselect","mark","unmark","move","selectChessInGame","currentPlayer","situation","newSelectedChess","newSituation","markers","v","moveChessInGame","selectedChess","attack","getGameStatus","defaultSituation","GameDomain","Remesh","domain","defaultGameState","GameState","GameQuery","get","GameStatusQuery","GameOverEvent","NotYourMoveEvent","ResetGameStateCommand","SelectChessCommand","MoveChessCommand","fromQuery","filter","gameStatus","formatChessColor","Red","Black","formatChessValue","General","Guard","Elephant","Horse","Chariot","Cannon","Soldier","ChessRender","props","onClick","selected","marked","style","zIndex","backgroundColor","fontSize","textAlign","borderWidth","cursor","borderStyle","borderColor","borderRadius","MarkerRender","marker","ChessGame","send","useRemeshSend","useRemeshDomain","gameState","useRemeshQuery","query","event","alert","window","confirm","command","container","document","getElementById","root","ReactDOMClient","store","inspectors","RemeshReduxDevtools","RemeshLogger","include","render","StrictMode","RemeshRoot"],"mappings":"idAAO,IAAIA,EAAwB,CAC/B,IAAK,UAAY,CACb,OAAQA,EAAsB,UAAY,MAAM,IAAG,CACtD,EACD,SAAU,MACd,ECHIC,GAAU,SAAUC,EAAQ,CAC5BC,EAAUF,EAAQC,CAAM,EACxB,SAASD,EAAOG,EAAWC,EAAM,CAC7B,OAAOH,EAAO,KAAK,IAAI,GAAK,IAC/B,CACD,OAAAD,EAAO,UAAU,SAAW,SAAUK,EAAOC,EAAO,CAEhD,OAAO,IACf,EACWN,CACX,EAAEO,CAAY,ECXHC,EAAmB,CAC1B,YAAa,SAAUC,EAASC,EAAS,CAErC,QADIC,EAAO,CAAA,EACFC,EAAK,EAAGA,EAAK,UAAU,OAAQA,IACpCD,EAAKC,EAAK,GAAK,UAAUA,GAE7B,IAAIC,EAAWL,EAAiB,SAChC,OAAIK,GAAa,MAAuCA,EAAS,YACtDA,EAAS,YAAY,MAAMA,EAAUC,EAAc,CAACL,EAASC,CAAO,EAAGK,EAAOJ,CAAI,CAAC,CAAC,EAExF,YAAY,MAAM,OAAQG,EAAc,CAACL,EAASC,CAAO,EAAGK,EAAOJ,CAAI,CAAC,CAAC,CACnF,EACD,cAAe,SAAUK,EAAQ,CAC7B,IAAIH,EAAWL,EAAiB,SAChC,QAASK,GAAa,KAA8B,OAASA,EAAS,gBAAkB,eAAeG,CAAM,CAChH,EACD,SAAU,MACd,ECdIC,GAAe,SAAUhB,EAAQ,CACjCC,EAAUe,EAAahB,CAAM,EAC7B,SAASgB,EAAYd,EAAWC,EAAM,CAClC,IAAIc,EAAQjB,EAAO,KAAK,KAAME,EAAWC,CAAI,GAAK,KAClD,OAAAc,EAAM,UAAYf,EAClBe,EAAM,KAAOd,EACbc,EAAM,QAAU,GACTA,CACV,CACD,OAAAD,EAAY,UAAU,SAAW,SAAUZ,EAAOC,EAAO,CAErD,GADIA,IAAU,SAAUA,EAAQ,GAC5B,KAAK,OACL,OAAO,KAEX,KAAK,MAAQD,EACb,IAAIc,EAAK,KAAK,GACVhB,EAAY,KAAK,UACrB,OAAIgB,GAAM,OACN,KAAK,GAAK,KAAK,eAAehB,EAAWgB,EAAIb,CAAK,GAEtD,KAAK,QAAU,GACf,KAAK,MAAQA,EACb,KAAK,GAAK,KAAK,IAAM,KAAK,eAAeH,EAAW,KAAK,GAAIG,CAAK,EAC3D,IACf,EACIW,EAAY,UAAU,eAAiB,SAAUd,EAAWiB,EAAKd,EAAO,CACpE,OAAIA,IAAU,SAAUA,EAAQ,GACzBE,EAAiB,YAAYL,EAAU,MAAM,KAAKA,EAAW,IAAI,EAAGG,CAAK,CACxF,EACIW,EAAY,UAAU,eAAiB,SAAUI,EAAYF,EAAIb,EAAO,CAEpE,GADIA,IAAU,SAAUA,EAAQ,GAC5BA,GAAS,MAAQ,KAAK,QAAUA,GAAS,KAAK,UAAY,GAC1D,OAAOa,EAEXX,EAAiB,cAAcW,CAAE,CAEzC,EACIF,EAAY,UAAU,QAAU,SAAUZ,EAAOC,EAAO,CACpD,GAAI,KAAK,OACL,OAAO,IAAI,MAAM,8BAA8B,EAEnD,KAAK,QAAU,GACf,IAAIgB,EAAQ,KAAK,SAASjB,EAAOC,CAAK,EACtC,GAAIgB,EACA,OAAOA,EAEF,KAAK,UAAY,IAAS,KAAK,IAAM,OAC1C,KAAK,GAAK,KAAK,eAAe,KAAK,UAAW,KAAK,GAAI,IAAI,EAEvE,EACIL,EAAY,UAAU,SAAW,SAAUZ,EAAOkB,EAAQ,CACtD,IAAIC,EAAU,GACVC,EACJ,GAAI,CACA,KAAK,KAAKpB,CAAK,CAClB,OACMqB,EAAP,CACIF,EAAU,GACVC,EAAaC,GAAQ,IAAI,MAAM,oCAAoC,CACtE,CACD,GAAIF,EACA,YAAK,YAAW,EACTC,CAEnB,EACIR,EAAY,UAAU,YAAc,UAAY,CAC5C,GAAI,CAAC,KAAK,OAAQ,CACd,IAAIU,EAAK,KAAMR,EAAKQ,EAAG,GAAIxB,EAAYwB,EAAG,UACtCC,EAAUzB,EAAU,QACxB,KAAK,KAAO,KAAK,MAAQ,KAAK,UAAY,KAC1C,KAAK,QAAU,GACf0B,EAAUD,EAAS,IAAI,EACnBT,GAAM,OACN,KAAK,GAAK,KAAK,eAAehB,EAAWgB,EAAI,IAAI,GAErD,KAAK,MAAQ,KACblB,EAAO,UAAU,YAAY,KAAK,IAAI,CACzC,CACT,EACWgB,CACX,EAAEjB,EAAM,ECnFJ8B,EAAa,UAAY,CACzB,SAASA,EAAUC,EAAqBC,EAAK,CACrCA,IAAQ,SAAUA,EAAMF,EAAU,KACtC,KAAK,oBAAsBC,EAC3B,KAAK,IAAMC,CACd,CACD,OAAAF,EAAU,UAAU,SAAW,SAAU1B,EAAME,EAAOD,EAAO,CACzD,OAAIC,IAAU,SAAUA,EAAQ,GACzB,IAAI,KAAK,oBAAoB,KAAMF,CAAI,EAAE,SAASC,EAAOC,CAAK,CAC7E,EACIwB,EAAU,IAAM/B,EAAsB,IAC/B+B,CACX,ICXIG,GAAkB,SAAUhC,EAAQ,CACpCC,EAAU+B,EAAgBhC,CAAM,EAChC,SAASgC,EAAeC,EAAiBF,EAAK,CACtCA,IAAQ,SAAUA,EAAMF,EAAU,KACtC,IAAIZ,EAAQjB,EAAO,KAAK,KAAMiC,EAAiBF,CAAG,GAAK,KACvD,OAAAd,EAAM,QAAU,GAChBA,EAAM,QAAU,GAChBA,EAAM,WAAa,OACZA,CACV,CACD,OAAAe,EAAe,UAAU,MAAQ,SAAUE,EAAQ,CAC/C,IAAIP,EAAU,KAAK,QACnB,GAAI,KAAK,QAAS,CACdA,EAAQ,KAAKO,CAAM,EACnB,MACH,CACD,IAAIb,EACJ,KAAK,QAAU,GACf,EACI,IAAKA,EAAQa,EAAO,QAAQA,EAAO,MAAOA,EAAO,KAAK,EAClD,YAEEA,EAASP,EAAQ,SAE3B,GADA,KAAK,QAAU,GACXN,EAAO,CACP,KAAQa,EAASP,EAAQ,SACrBO,EAAO,YAAW,EAEtB,MAAMb,CACT,CACT,EACWW,CACX,EAAEH,CAAS,EChCAM,EAAiB,IAAIH,GAAehB,EAAW,EAC/CoB,GAAQD,ECHZ,SAASE,GAAYC,EAAO,CAC/B,OAAOA,aAAiB,MAAQ,CAAC,MAAMA,CAAK,CAChD,CCEO,SAASC,GAAMC,EAASC,EAAqBvC,EAAW,CACvDsC,IAAY,SAAUA,EAAU,GAChCtC,IAAc,SAAUA,EAAYiC,IACxC,IAAIO,EAAmB,GACvB,OAAID,GAAuB,OACnBE,GAAYF,CAAmB,EAC/BvC,EAAYuC,EAGZC,EAAmBD,GAGpB,IAAIG,EAAW,SAAUC,EAAY,CACxC,IAAIC,EAAMT,GAAYG,CAAO,EAAI,CAACA,EAAUtC,EAAU,IAAK,EAAGsC,EAC1DM,EAAM,IACNA,EAAM,GAEV,IAAIC,EAAI,EACR,OAAO7C,EAAU,SAAS,UAAY,CAC7B2C,EAAW,SACZA,EAAW,KAAKE,GAAG,EACf,GAAKL,EACL,KAAK,SAAS,OAAWA,CAAgB,EAGzCG,EAAW,SAAQ,EAG9B,EAAEC,CAAG,CACd,CAAK,CACL,CC/BO,SAASE,EAAKC,EAAO,CACxB,OAAOA,GAAS,EAER,UAAY,CAAE,OAAOC,EAAQ,EAC/BC,EAAQ,SAAUC,EAAQP,EAAY,CACpC,IAAIQ,EAAO,EACXD,EAAO,UAAUE,EAAyBT,EAAY,SAAUP,EAAO,CAC/D,EAAEe,GAAQJ,IACVJ,EAAW,KAAKP,CAAK,EACjBW,GAASI,GACTR,EAAW,SAAQ,EAG9B,CAAA,CAAC,CACd,CAAS,CACT,CCfO,SAASU,IAAiB,CAC7B,OAAOJ,EAAQ,SAAUC,EAAQP,EAAY,CACzCO,EAAO,UAAUE,EAAyBT,EAAYW,CAAI,CAAC,CACnE,CAAK,CACL,CCNO,SAASC,GAAMnB,EAAO,CACzB,OAAOoB,EAAI,UAAY,CAAE,OAAOpB,CAAQ,CAAA,CAC5C,CCEO,SAASqB,EAAUC,EAAuBC,EAAmB,CAChE,OAAIA,EACO,SAAUT,EAAQ,CACrB,OAAOU,GAAOD,EAAkB,KAAKb,EAAK,CAAC,EAAGO,IAAgB,EAAGH,EAAO,KAAKO,EAAUC,CAAqB,CAAC,CAAC,CAC1H,EAEWG,GAAS,SAAUzB,EAAO0B,EAAO,CAAE,OAAOJ,EAAsBtB,EAAO0B,CAAK,EAAE,KAAKhB,EAAK,CAAC,EAAGS,GAAMnB,CAAK,CAAC,CAAE,CAAE,CACvH,CCTO,SAASjC,GAAMyC,EAAK5C,EAAW,CAC9BA,IAAc,SAAUA,EAAYiC,GACxC,IAAI8B,EAAW1B,GAAMO,EAAK5C,CAAS,EACnC,OAAOyD,EAAU,UAAY,CAAE,OAAOM,CAAW,CAAA,CACrD,CCEa,MAAAC,EAAoBC,EAAM,cAAsC,CAC3E,KAAM,EACN,IAAK,EACL,SAAU,GACV,UAAW,EACb,CAAC,ECVKC,GAAiBC,GAA4D,CAC3E,KAAA,CAAEC,KAAMC,EAAUC,IAAKC,EAASC,SAAAA,CAAaL,EAAAA,EAE7CC,EAAOC,EAAWG,EAAW,EAC7BF,EAAMC,EAAUC,EAAW,EAG3BC,EAAO,CAACC,EAAYC,EAAYC,EAAYC,IACxC,IAAGT,EAAOM,EAAKF,KAAYF,EAAMK,EAAKH,MAAaJ,EAAOQ,EAAKJ,KAAYF,EAAMO,EAAKL,IAI1FM,EAAO,CAACC,EAAWC,IAAc,CACrC,MAAMC,EAAM,CAAA,EAIRC,IAAAA,EAAQC,EAAQC,EAAMC,EAG1B,OAAIN,GAAK,IACPG,EAASH,EAAIO,GACbH,EAASH,EAAIM,GAAWC,IACxBH,EAAOL,EAAIO,GAAWC,IACtBF,EAAOL,EAAIM,GAEXL,EAAIO,KAAKf,EAAKS,EAAQC,EAAQD,EAAQG,CAAzB,CAAb,EACAJ,EAAIO,KAAKf,EAAKS,EAAQG,EAAMD,EAAMC,CAArB,CAAb,EAEAF,EAASH,EAAIM,GAAWC,IACxBF,EAAOL,EAAIM,GAEXL,EAAIO,KAAKf,EAAKS,EAAQC,EAAQD,EAAQG,CAAzB,CAAb,EACAJ,EAAIO,KAAKf,EAAKS,EAAQG,EAAMD,EAAMC,CAArB,CAAb,GAIEN,GAAK,IACPG,EAASH,EAAIO,GACbH,EAASH,EAAIM,GAAWC,IACxBH,EAAOL,EAAIO,GAAWC,IACtBF,EAAOL,EAAIM,GAEXL,EAAIO,KAAKf,EAAKS,EAAQC,EAAQD,EAAQG,CAAzB,CAAb,EACAJ,EAAIO,KAAKf,EAAKS,EAAQG,EAAMD,EAAMC,CAArB,CAAb,EAEAF,EAASH,EAAIM,GAAWC,IACxBF,EAAOL,EAAIM,GAEXL,EAAIO,KAAKf,EAAKS,EAAQC,EAAQD,EAAQG,CAAzB,CAAb,EACAJ,EAAIO,KAAKf,EAAKS,EAAQG,EAAMD,EAAMC,CAArB,CAAb,GAGKJ,CAAAA,EA+BFA,MA5Be,CAEpB,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EAEA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,EACA,CAAC,EAAG,CAAJ,CAhBoB,EAkBnBzB,IAAI,CAAC,CAACuB,EAAGC,CAAJ,IAAWF,EAAKC,EAAGC,CAAJ,CAlBD,EAmBnBS,OAAO,CAACC,EAAKC,IAAQD,EAAI9B,OAAO+B,CAAX,EAAiB,CAnBnB,CAAA,EAqBnB/B,OAAO,IAAIgC,MAAM,CAAV,EAAaC,KAAK,CAAlB,EAAqBrC,IAAI,CAACsC,EAAGC,IAAMtB,EAAK,EAAGsB,EAAI,EAAG,EAAGA,EAAI,CAAlB,CAAvC,CArBY,EAuBnBnC,OAAO,IAAIgC,MAAM,CAAV,EAAaC,KAAK,CAAlB,EAAqBrC,IAAI,CAACsC,EAAGC,IAAMtB,EAAKsB,EAAI,EAAG,EAAGA,EAAI,EAAG,CAAlB,CAAvC,CAvBY,EAwBnBnC,OAAO,IAAIgC,MAAM,CAAV,EAAaC,KAAK,CAAlB,EAAqBrC,IAAI,CAACsC,EAAGC,IAAMtB,EAAKsB,EAAI,EAAG,EAAGA,EAAI,EAAG,CAAlB,CAAvC,CAxBY,EA0BnBnC,OAAO,CAACa,EAAK,EAAG,EAAG,EAAG,CAAV,EAAcA,EAAK,EAAG,EAAG,EAAG,CAAV,EAAcA,EAAK,EAAG,EAAG,EAAG,CAAV,EAAcA,EAAK,EAAG,EAAG,EAAG,CAAV,CAA3D,CA1BY,CA6BvB,EAEYuB,GAAc,IAAM,CACzB7B,MAAAA,EAAS8B,qBAAWjC,CAAD,EAEnB,CAAEI,KAAMC,EAAUC,IAAKC,EAASC,SAAAA,EAAU0B,UAAAA,CAAc/B,EAAAA,EAExDC,EAAOC,EAAWG,EAAW,EAC7BF,EAAMC,EAAUC,EAAW,EAC3B2B,EAAQ3B,EAAW,EACnB4B,EAAS5B,EAAW,EAEpB6B,EAAUnC,GAAcC,CAAD,EAEvBmC,EAAwD,CAC5DC,SAAU,WACVnC,KAAM,EACNE,IAAK,EACL6B,MAAOA,EAAQD,EACfE,OAAQA,EAASF,CAAAA,EAGnB,SACE,MAAA,CAAK,MAAM,6BAA6B,MAAOI,EAA/C,WACE,IAAA,CAAA,SACE,CAAAE,EAAA,OAAA,CAAM,EAAGpC,EAAM,EAAGE,EAAK,MAAA6B,EAAc,OAAAC,EAAgB,KAAK,OAAO,OAAO,UAAU,YAAY,GAAA,CADhG,EAEGC,EAAQ7C,IAAI,CAACiD,EAAMV,MAClB,OAAA,CAAc,KAAK,OAAO,OAAO,UAAU,EAAGU,CAAAA,EAAnCV,CAAX,CADD,CAFH,CAAA,CAAA,CAAA,CAFJ,CAUD,ECtHW,IAAAW,GAAAA,IACVA,EAAAA,EAAA,QAAU,KAAV,UACAA,EAAAA,EAAA,QAAU,IAAV,UACAA,EAAAA,EAAA,OAAS,IAAT,SACAA,EAAAA,EAAA,MAAQ,IAAR,QACAA,EAAAA,EAAA,SAAW,IAAX,WACAA,EAAAA,EAAA,MAAQ,IAAR,QACAA,EAAAA,EAAA,QAAU,GAAV,UAPUA,IAAAA,GAAA,CAAA,CAAA,EAUAC,GAAAA,IACVA,EAAAA,EAAA,IAAM,GAAN,MACAA,EAAAA,EAAA,MAAQ,IAAR,QAFUA,IAAAA,GAAA,CAAA,CAAA,EAsCZ,MAAMC,GAAiB,CAACC,EAAgBC,IAC/BD,EAAK,IAAMC,EAAK,GAAKD,EAAK,IAAMC,EAAK,EAQxCC,GAAiB,CAACC,EAAmB,CAAE,EAAAjC,EAAG,EAAAC,KAAkB,CACxD,OAAAgC,OACD,GACH,MAAO,EAAEjC,EAAI,GAAKA,EAAI,GAAMC,EAAI,GAAKA,EAAI,OACtC,GACH,MAAO,EAAED,EAAI,GAAKA,EAAI,GAAMC,EAAI,GAAKA,EAAI,GAE/C,EAOMiC,GAAe,CAACD,EAAmB,CAAE,EAAAjC,EAAG,EAAAC,KAAkB,CACtD,OAAAgC,OACD,GACI,MAAA,CACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,CAAA,EACL,KAAK,CAAC,CAACtC,EAAIC,CAAE,IAAMD,IAAOK,GAAKJ,IAAOK,CAAC,MACtC,GACI,MAAA,CACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,CAAA,EACL,KAAK,CAAC,CAACN,EAAIC,CAAE,IAAMD,IAAOK,GAAKJ,IAAOK,CAAC,EAE/C,EAOMkC,GAAkB,CAACF,EAAmB,CAAE,EAAAjC,EAAG,EAAAC,KAAkB,CACzD,OAAAgC,OACD,GACI,MAAA,CACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,CAAA,EACL,KAAK,CAAC,CAACtC,EAAIC,CAAE,IAAMD,IAAOK,GAAKJ,IAAOK,CAAC,MACtC,GACI,MAAA,CACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,CAAA,EACL,KAAK,CAAC,CAACN,EAAIC,CAAE,IAAMD,IAAOK,GAAKJ,IAAOK,CAAC,EAE/C,EAOMmC,GAAiB,CAACH,EAAmB,CAAE,EAAAjC,EAAG,EAAAC,KAAkB,CACxD,OAAAgC,OACD,GACH,MAAO,EAAEhC,EAAI,GAAMA,EAAI,GAAKD,EAAI,IAAM,OACnC,GACH,MAAO,EAAEC,EAAI,GAAMA,EAAI,GAAKD,EAAI,IAAM,GAE5C,EAEMqC,GACHC,GACD,CAAC,CAAE,SAAUnE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAAkB,CAEnD,GAAI9B,EAAO,IAAM6B,GAAK7B,EAAO,IAAM8B,EAC1B,MAAA,GAIT,GAAIqC,EAAK,UAAU,KAAMC,GAAUA,EAAM,SAAS,IAAMvC,GAAKuC,EAAM,SAAS,IAAMtC,CAAC,EAAG,CAGhF,GAAA9B,EAAO,IAAM8B,EACf,OACEqC,EAAK,UAAU,OACZC,GAAUA,EAAM,SAAS,IAAMtC,IAAMsC,EAAM,SAAS,EAAIvC,IAAMuC,EAAM,SAAS,EAAIpE,EAAO,GAAK,CAAA,EAC9F,SAAW,EAKb,GAAAA,EAAO,IAAM6B,EACf,OACEsC,EAAK,UAAU,OACZC,GAAUA,EAAM,SAAS,IAAMvC,IAAMuC,EAAM,SAAS,EAAItC,IAAMsC,EAAM,SAAS,EAAIpE,EAAO,GAAK,CAAA,EAC9F,SAAW,CAGnB,CAEO,MAAA,EACT,EAGIqE,GACJ,IACA,CAAC,CAAE,SAAUrE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAC1B,KAAK,IAAI9B,EAAO,EAAI8B,CAAC,EAAI,KAAK,IAAI9B,EAAO,EAAI6B,CAAC,IAAM,EAIzDyC,GACJ,IACA,CAAC,CAAE,SAAUtE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAAkB,CAC7C,MAAAyC,EAAUC,GAAcA,EAAIA,EAE3B,OAAAD,EAAOvE,EAAO,EAAI6B,CAAC,EAAI0C,EAAOvE,EAAO,EAAI8B,CAAC,IAAM,CACzD,EAGI2C,GACHN,GACD,CAAC,CAAE,SAAUnE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAC7B,KAAK,IAAI9B,EAAO,EAAI6B,CAAC,IAAM,GAAK,KAAK,IAAI7B,EAAO,EAAI8B,CAAC,IAAM,EACtD,GAGA,CAACqC,EAAK,UAAU,KACpBC,GAAUA,EAAM,SAAS,KAAOpE,EAAO,EAAI6B,GAAK,GAAKuC,EAAM,SAAS,KAAOpE,EAAO,EAAI8B,GAAK,CAAA,EAM9F4C,GACHP,GACD,CAAC,CAAE,SAAUnE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAAkB,CAC7C,MAAA6C,EAAK3E,EAAO,EAAI6B,EAChB+C,EAAK5E,EAAO,EAAI8B,EAGtB,OACE6C,EAAKA,EAAKC,EAAKA,IAAO,GACtB,CAACT,EAAK,UAAU,KACbC,GACCA,EAAM,SAAS,IAAM,KAAK,OAAO,EAAIpE,EAAO,EAAI6B,GAAK,CAAC,GACtDuC,EAAM,SAAS,IAAM,KAAK,OAAO,EAAIpE,EAAO,EAAI8B,GAAK,CAAC,CAAA,CAG9D,EAGI+C,EACHV,GACD,CAAC,CAAE,SAAUnE,GAAiB,CAAE,EAAA6B,EAAG,EAAAC,KAE7B9B,EAAO,IAAM6B,GAAK7B,EAAO,IAAM8B,EAC1B,GAIL9B,EAAO,IAAM8B,EACR,CAACqC,EAAK,UAAU,KACpBC,GAAUA,EAAM,SAAS,IAAMtC,IAAMsC,EAAM,SAAS,EAAIvC,IAAMuC,EAAM,SAAS,EAAIpE,EAAO,GAAK,CAAA,EAK9FA,EAAO,IAAM6B,EACR,CAACsC,EAAK,UAAU,KACpBC,GAAUA,EAAM,SAAS,IAAMvC,IAAMuC,EAAM,SAAS,EAAItC,IAAMsC,EAAM,SAAS,EAAIpE,EAAO,GAAK,CAAA,EAI3F,GAIL8E,GACJ,IACA,CAAC,CAAE,SAAU9E,EAAQ,MAAA8D,GAAgB,CAAE,EAAAjC,EAAG,EAAAC,KAAkB,CAClD,OAAAgC,OACD,GACH,OAAOhC,GAAK9B,EAAO,GAAK,KAAK,IAAI6B,EAAI7B,EAAO,CAAC,EAAI,KAAK,IAAI8B,EAAI9B,EAAO,CAAC,IAAM,MACzE,GACH,OAAO8B,GAAK9B,EAAO,GAAK,KAAK,IAAI6B,EAAI7B,EAAO,CAAC,EAAI,KAAK,IAAI8B,EAAI9B,EAAO,CAAC,IAAM,EAElF,EAMI+E,EAAWZ,GAAe,CAACC,EAAcf,IAAuB,CAC9D,KAAA,CAAE,MAAAS,EAAO,MAAA5E,CAAU,EAAAkF,EACjB,OAAAlF,OACD,KACH,OAAO2E,GAAeC,EAAOT,CAAQ,GAAKgB,KAAiBD,EAAOf,CAAQ,MACvE,IACH,OAAOU,GAAaD,EAAOT,CAAQ,GAAKiB,KAAeF,EAAOf,CAAQ,MACnE,IACI,OAAAW,GAAgBF,EAAOT,CAAQ,GAAKoB,GAAgBN,CAAI,EAAEC,EAAOf,CAAQ,MAC7E,IACH,OAAOqB,GAAaP,CAAI,EAAEC,EAAOf,CAAQ,MACtC,IACH,OAAOwB,EAAkBV,CAAI,EAAEC,EAAOf,CAAQ,MAC3C,IACH,OAAOwB,EAAkBV,CAAI,EAAEC,EAAOf,CAAQ,MAC3C,GACH,OAAOY,GAAeH,EAAOT,CAAQ,GAAKyB,KAAiBV,EAAOf,CAAQ,EAEhF,EAMM2B,EAAab,GAAe,CAACC,EAAca,IAC3Cb,EAAM,QAAUa,EAAK,MAEhB,GAGLb,EAAM,QAAU,GACXF,GAAgBC,CAAI,EAAEC,EAAOa,EAAK,QAAQ,EAG/Cd,EAAK,UAAU,KAAMC,GAAUV,GAAeU,EAAM,SAAUa,EAAK,QAAQ,CAAC,GAC5EF,EAAQZ,CAAI,EAAEC,EAAOa,EAAK,QAAQ,EAMlCC,GAAUd,IACP,CACL,GAAGA,EACH,SAAU,EAAA,GAKRe,EAAYf,IACT,CACL,GAAGA,EACH,SAAU,EAAA,GAKRgB,GAAQhB,IACL,CACL,GAAGA,EACH,OAAQ,EAAA,GAKNiB,EAAUjB,IACP,CACL,GAAGA,EACH,OAAQ,EAAA,GASNkB,EAAQjC,GACJe,IACC,CACL,GAAGA,EACH,SAAAf,CAAA,GASAkC,GACHlC,GACAc,GAAqB,CACd,KAAA,CAAE,cAAAqB,EAAe,UAAAC,CAAc,EAAAtB,EAC/B,CAAE,EAAAtC,EAAG,EAAAC,CAAM,EAAAuB,EAEb,IAAAqC,EACJ,MAAMC,EAAeF,EAClB,IAAKrB,GAAUiB,EAAOF,EAASf,CAAK,CAAC,CAAC,EACtC,IAAKA,GACAA,EAAM,SAAS,IAAMvC,GAAKuC,EAAM,SAAS,IAAMtC,GACjD4D,EAAmBR,GAAOd,CAAK,EACxBsB,GAEAtB,CAEV,EACA,IAAKA,GACAY,EAAUb,CAAI,EAAEuB,EAAmBtB,CAAK,EACnCgB,GAAKhB,CAAK,EAEVA,CAEV,EAEGwB,EAAoB,IAAI,MAAM,EAAE,EACnC,KAAK,IAAI,EACT,IAAI,CAACC,EAAGjF,IAAU,CACjB,MAAMiB,EAAIjB,EAAQ,EACZkB,GAAKlB,EAAQiB,GAAK,EACxB,MAAO,CAAE,EAAAA,EAAG,EAAAC,CAAE,CAAA,CACf,EACA,OAAQ+D,GAAMd,EAAQZ,CAAI,EAAEuB,EAAmBG,CAAC,CAAC,EAE7C,MAAA,CACL,cAAAL,EACA,cAAeE,EACf,UAAWC,EACX,QAAAC,CAAA,CAEJ,EAMIE,GACHzC,GACAc,GAAqB,CACpB,KAAM,CAAE,cAAAqB,EAAe,UAAAC,EAAW,cAAAM,CAAA,EAAkB5B,EAEpD,GAAI4B,GAAiBhB,EAAQZ,CAAI,EAAE4B,EAAe1C,CAAQ,EAAG,CAC3D,KAAM,CAAE,EAAAxB,EAAG,EAAAC,GAAMiE,EAAc,SACzBJ,EAAeF,EAClB,IAAKrB,GACAA,EAAM,SAAS,IAAMvC,GAAKuC,EAAM,SAAS,IAAMtC,EAC1CwD,EAAKjC,CAAQ,EAAEe,CAAK,EAEpBA,CAEV,EAEA,IAAKA,GAAUiB,EAAOF,EAASf,CAAK,CAAC,CAAC,EAElC,MAAA,CACL,cAAe,CAACoB,EAChB,cAAe,OACf,UAAWG,EACX,QAAS,CAAC,CAAA,CAEd,CACO,OAAAxB,CACT,EAMI6B,GACH3C,GACAc,GAAqB,CACpB,KAAM,CAAE,cAAAqB,EAAe,UAAAC,EAAW,cAAAM,CAAA,EAAkB5B,EAG9Cc,EAAOQ,EAAU,KAAMrB,GAAUA,EAAM,SAAS,IAAMf,EAAS,GAAKe,EAAM,SAAS,IAAMf,EAAS,CAAC,EAEzG,GAAI0C,GAAiBd,GAAQD,EAAUb,CAAI,EAAE4B,EAAed,CAAI,EAAG,CACjE,KAAM,CAAE,EAAApD,EAAG,EAAAC,GAAMiE,EAAc,SACzBJ,EAAeF,EAClB,IAAKrB,GAEAA,EAAM,SAAS,IAAMvC,GAAKuC,EAAM,SAAS,IAAMtC,EAC1CwD,EAAKjC,CAAQ,EAAEe,CAAK,EAIzBA,EAAM,SAAS,IAAMf,EAAS,GAAKe,EAAM,SAAS,IAAMf,EAAS,EAC5D,KAIFe,CACR,EACA,OAAQA,GAAU,CAAC,CAACA,CAAK,EAEzB,IAAKA,GAAUiB,EAAOF,EAASf,CAAc,CAAC,CAAC,EAE3C,MAAA,CACL,cAAe,CAACoB,EAChB,cAAe,OACf,UAAWG,EACX,QAAS,CAAC,CAAA,CAEd,CACO,OAAAxB,CACT,EAEI8B,GAAiBR,GACHA,EAAU,KAAMrB,GACzBA,EAAM,QAAU,GAAkBA,EAAM,QAAU,GAC1D,EAMeqB,EAAU,KAAMrB,GACvBA,EAAM,QAAU,IAAoBA,EAAM,QAAU,GAC5D,EAMM,UAHE,UARA,YAcL8B,GAA4B,CAChC,CAAE,MAAO,GAAkB,MAAO,GAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC7E,CAAE,MAAO,GAAkB,MAAO,GAAqB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAChF,CAAE,MAAO,GAAkB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC7E,CAAE,MAAO,GAAkB,MAAO,IAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC7E,CAAE,MAAO,GAAkB,MAAO,GAAqB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAChF,CAAE,MAAO,GAAkB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC7E,CAAE,MAAO,GAAkB,MAAO,GAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAE/E,CAAE,MAAO,GAAkB,MAAO,GAAmB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC9E,CAAE,MAAO,GAAkB,MAAO,GAAmB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAE9E,CAAE,MAAO,GAAkB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAC/E,CAAE,MAAO,GAAkB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,CAAA,CAAI,EAE/E,CAAE,MAAO,EAAgB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,EAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAE7E,CAAE,MAAO,EAAgB,MAAO,GAAmB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC5E,CAAE,MAAO,EAAgB,MAAO,GAAmB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAE5E,CAAE,MAAO,EAAgB,MAAO,GAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC3E,CAAE,MAAO,EAAgB,MAAO,GAAqB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC9E,CAAE,MAAO,EAAgB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC3E,CAAE,MAAO,EAAgB,MAAO,IAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC7E,CAAE,MAAO,EAAgB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC3E,CAAE,MAAO,EAAgB,MAAO,GAAqB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC9E,CAAE,MAAO,EAAgB,MAAO,GAAkB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,EAC3E,CAAE,MAAO,EAAgB,MAAO,GAAoB,SAAU,CAAE,EAAG,EAAG,EAAG,EAAI,CAC/E,EAEaC,GAAaC,EAAO,OAAO,CACtC,KAAM,aACN,KAAOC,GAAW,CAChB,MAAMC,EAAmB,CACvB,cAAe,EACf,cAAe,OACf,UAAWJ,GACX,QAAS,CAAC,CAAA,EAGNK,EAAYF,EAAO,MAAY,CACnC,KAAM,YACN,QAASC,CAAA,CACV,EAEKE,EAAYH,EAAO,MAAM,CAC7B,KAAM,YACN,KAAM,CAAC,CAAE,IAAAI,KACAA,EAAIF,GAAW,CACxB,CACD,EAEKG,EAAkBL,EAAO,MAAM,CACnC,KAAM,kBACN,KAAM,CAAC,CAAE,IAAAI,KAAsB,CAC7B,KAAM,CAAE,UAAAhB,CAAc,EAAAgB,EAAID,EAAW,CAAA,EACrC,OAAOP,GAAcR,CAAS,CAChC,CAAA,CACD,EAEKkB,EAAgBN,EAAO,MAAM,CACjC,KAAM,eAAA,CACP,EAEKO,EAAmBP,EAAO,MAAM,CACpC,KAAM,kBAAA,CACP,EAEKQ,EAAwBR,EAAO,QAAQ,CAC3C,KAAM,wBACN,KAAM,IACGE,EAAY,EAAA,IAAID,CAAgB,CACzC,CACD,EAEKQ,EAAqBT,EAAO,QAAQ,CACxC,KAAM,qBACN,KAAK,CAAE,IAAAI,CAAI,EAAGrC,EAAc,CAG1B,GAFmBqC,EAAIC,EAAA,CAAiB,IAErB,UACjB,OAAOC,EAAc,EAGjB,MAAAxC,EAAOsC,EAAIF,EAAA,CAAW,EACtB,CAAE,cAAAf,EAAe,cAAAO,CAAkB,EAAA5B,EAErC,OAAAC,EAAM,QAAUoB,EACX,CAACe,IAAY,IAAIhB,GAAkBnB,EAAM,QAAQ,EAAED,CAAI,CAAC,CAAC,EAE5D4B,EACK,CAACQ,IAAY,IAAIP,GAAO5B,EAAM,QAAQ,EAAED,CAAI,CAAC,CAAC,EAE9C,CAACyC,GAAkB,CAGhC,CAAA,CACD,EAEKG,EAAmBV,EAAO,QAAQ,CACtC,KAAM,mBACN,KAAK,CAAE,IAAAI,CAAI,EAAGpD,EAAkB,CAG9B,GAFmBoD,EAAIC,EAAA,CAAiB,IAErB,UACjB,OAAOC,EAAc,EAGjB,MAAAxC,EAAOsC,EAAIF,EAAA,CAAW,EAEtB,CAAE,cAAAR,CAAkB,EAAA5B,EAE1B,OAAI4B,EACK,CAACQ,EAAY,EAAA,IAAIT,GAAgBzC,CAAQ,EAAEc,CAAI,CAAC,CAAC,EAEjD,CAACyC,GAAkB,CAE9B,CAAA,CACD,EAED,OAAAP,EAAO,OAAO,CACZ,KAAM,wBACN,KAAM,CAAC,CAAE,UAAAW,KACAA,EAAUN,EAAiB,CAAA,EAAE,KAClCO,GAAQC,GAAeA,IAAe,SAAS,EAC/CjK,GAAM,GAAG,EACTqD,EAAI,IAAMqG,GAAe,CAAA,CAE7B,CACD,EAEM,CACL,MAAO,CACL,UAAAH,EACA,gBAAAE,CACF,EACA,QAAS,CACP,mBAAAI,EACA,iBAAAC,EACA,sBAAAF,CACF,EACA,MAAO,CACL,iBAAAD,EACA,cAAAD,CACF,CAAA,CAEJ,CACF,CAAC,ECloBKQ,EAAoBrD,IACjB,CAAE,CAACL,EAAW2D,KAAM,MAAO,CAAC3D,EAAW4D,OAAQ,OAAUvD,GAAAA,GAG5DwD,GAAmB,CAACxD,EAAmB5E,KACpC,CACL,CAACuE,EAAW2D,KAAM,CAChB,CAAC5D,EAAW+D,SAAU,SACtB,CAAC/D,EAAWgE,OAAQ,SACpB,CAAChE,EAAWiE,UAAW,SACvB,CAACjE,EAAWkE,OAAQ,SACpB,CAAClE,EAAWmE,SAAU,SACtB,CAACnE,EAAWoE,QAAS,SACrB,CAACpE,EAAWqE,SAAU,QAPN,EASlB,CAACpE,EAAW4D,OAAQ,CAClB,CAAC7D,EAAW+D,SAAU,SACtB,CAAC/D,EAAWgE,OAAQ,SACpB,CAAChE,EAAWiE,UAAW,SACvB,CAACjE,EAAWkE,OAAQ,SACpB,CAAClE,EAAWmE,SAAU,SACtB,CAACnE,EAAWoE,QAAS,SACrB,CAACpE,EAAWqE,SAAU,QAPJ,CAAA,GASpB/D,GAAO5E,GAQE4I,GAAeC,GAAsB,CAC1C,KAAA,CAAE3D,MAAAA,EAAO4D,QAAAA,CAAYD,EAAAA,EAErB,CACJjE,MAAAA,EACA5E,MAAAA,EACAmE,SAAU,CAAExB,EAAAA,EAAGC,EAAAA,CAAL,EACVmG,SAAAA,EACAC,OAAAA,CACE9D,EAAAA,EAEE,CAAEpB,UAAAA,EAAW1B,SAAAA,EAAUJ,KAAAA,EAAME,IAAAA,CAAAA,EAAQ2B,EAAAA,QAAAA,WAAWjC,CAAD,EAE/CqH,EAAuD,CAC3D9E,SAAU,WACV+E,OAAQ,GACRC,gBAAiB,QACjBC,SAAU,GACVC,UAAW,SACXC,YAAa,EACbvF,MAAOD,EACPE,OAAQF,EACRyF,OAAQ,UACRvH,KAAMA,EAAOW,EAAIP,GAAYA,EAAW0B,GAAa,EAAI,EACzD5B,IAAKA,EAAMU,EAAIR,GAAYA,EAAW0B,GAAa,EAAI,EACvD0F,YAAaT,EAAW,SAAW,QACnCU,YAAaT,EAAS,OAASf,EAAiBrD,CAAD,EAC/C8E,aAAc5F,EAAY,EAAI,EAC9Bc,MAAOqD,EAAiBrD,CAAD,CAAA,EAGzB,SACE,MAAA,CAAK,QAAS,IAAMkE,EAAQ5D,CAAD,EAAS,MAAA+D,EAApC,SACGb,GAAiBxD,EAAO5E,CAAR,CAAA,CAFrB,CAKD,EC/DY2J,GAAgBd,GAAuB,CAC5C,KAAA,CAAEe,OAAAA,EAAQd,QAAAA,CAAYD,EAAAA,EACtB,CAAElG,EAAAA,EAAGC,EAAAA,CAAMgH,EAAAA,EAEX,CAAE9F,UAAAA,EAAW1B,SAAAA,EAAUJ,KAAAA,EAAME,IAAAA,CAAAA,EAAQ2B,EAAAA,QAAAA,WAAWjC,CAAD,EAE/CqH,EAAuD,CAC3D9E,SAAU,WACVmF,YAAa,EACbE,YAAa,SACbC,YAAa,QACbN,gBAAiB,QACjBpF,MAAOD,EAAY,EACnBE,OAAQF,EAAY,EACpB9B,KAAMA,EAAOW,EAAIP,EAAW0B,EAAY,GAAK1B,EAAW0B,GAAa,EAAI,EACzE5B,IAAKA,EAAMU,EAAIR,EAAW0B,EAAY,GAAK1B,EAAW0B,GAAa,EAAI,CAAA,EAGzE,SAAO,MAAA,CAAK,QAAS,IAAMgF,EAAQc,CAAD,EAAU,MAAAX,CAAA,CAA5C,CACD,ECnBYY,GAAY,IAAM,CAC7B,MAAMC,EAAOC,IACP,CAAE/H,KAAAA,EAAME,IAAAA,EAAKE,SAAAA,CAAAA,EAAayB,EAAAA,QAAAA,WAAWjC,CAAD,EAEpCuF,EAAS6C,EAAgB/C,GAAAA,CAAD,EACxBgD,EAAYC,GAAe/C,EAAOgD,MAAM7C,UAAd,CAAA,EAEjBH,EAAAA,EAAOiD,MAAM1C,iBAAkB,IAAM,CAClD2C,MAAM,0BAAD,CAAA,CADO,EAIClD,EAAAA,EAAOiD,MAAM3C,cAAe,IAAM,CACzB6C,OAAOC,QAAQ,0EAAf,GAEfpD,EAAAA,EAAOqD,QAAQ7C,sBAAhB,CAAA,CACL,CAJW,EAOd,MAAMsB,EAAuD,CAC3DlF,MAAO/B,EAAO,EAAII,EAClB4B,OAAQ9B,EAAM,GAAKE,CAAAA,EAGf,CAAEmE,UAAAA,EAAWG,QAAAA,CAAYuD,EAAAA,EAE/B,SACE,MAAA,CAAK,MAAAhB,EAAL,SAAA,CACG7E,EAAAR,GADH,CAAA,CAAA,EAGG2C,EAAUnF,IAAI,CAAC8D,EAAOvB,MACpBiF,GAAD,CAAqB,MAAA1D,EAAc,QAAS,IAAM4E,EAAK3C,EAAOqD,QAAQ5C,mBAAmB1C,CAAlC,CAAD,CAAA,EAApCvB,CAAlB,CADD,EAIA+C,EAAQtF,IAAI,CAACwI,EAAQjG,IACpBS,EAACuF,GAAD,CAAsB,OAAAC,EAAgB,QAAS,IAAME,EAAK3C,EAAOqD,QAAQ3C,iBAAiB+B,CAAhC,CAAD,CAAA,EAAtCjG,CAAnB,CADD,CAPH,CAAA,CADF,CAaD,ECnCK8G,EAAYC,SAASC,eAAe,MAAxB,EAElB,GAAIF,EAAW,CACPG,MAAAA,EAAOC,EAA0BJ,CAA1B,EACPK,EAAQ5D,EAAO4D,MAAM,CACzBC,WAAY,CACVC,GADU,EAEVC,GAAa,CACXC,QAAS,CAAC,UAAW,QAAS,QAAS,SAAU,WAAY,OAApD,CAAA,CADC,CAFF,CAAA,CADA,EASTC,EAAAA,SACFC,qBAAD,CAAA,WACGC,GAAD,CAAY,MAAAP,EAAZ,SACG1G,EAAAxC,EAAkB,SAAnB,CACE,MAAO,CACLI,KAAM,EACNE,IAAK,EACLE,SAAU,GACV0B,UAAW,EAJN,EADT,SAQEM,EAACyF,GAAD,EAAA,CAAA,CARF,CAAA,CADF,CAFJ,CAAA,CAAA,CAgBD"}